<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>deep networks with keras</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.6 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: thin dotted;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: thin dotted;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: thin dotted;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.2.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.2.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.2.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.2.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.2.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
@media (max-width: 991px) {
  #ipython_notebook {
    margin-left: 10px;
  }
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#login_widget {
  float: right;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  text-align: center;
  vertical-align: middle;
  display: inline;
  opacity: 0;
  z-index: 2;
  width: 12ex;
  margin-right: -12ex;
}
.alternate_upload .btn-upload {
  height: 22px;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: baseline;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul {
  list-style: disc;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ul ul {
  list-style: square;
  margin: 0em 2em;
}
.rendered_html ul ul ul {
  list-style: circle;
  margin: 0em 2em;
}
.rendered_html ol {
  list-style: decimal;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
  margin: 0em 2em;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  background-color: #fff;
  color: #000;
  font-size: 100%;
  padding: 0px;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: 1px solid black;
  border-collapse: collapse;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  border: 1px solid black;
  border-collapse: collapse;
  margin: 1em 2em;
}
.rendered_html td,
.rendered_html th {
  text-align: left;
  vertical-align: middle;
  padding: 4px;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget {
  float: right !important;
  float: right;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 20ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  margin-top: 6px;
}
span.save_widget span.filename {
  height: 1em;
  line-height: 1em;
  padding: 3px;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  display: none;
}
.command-shortcut:before {
  content: "(command)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}

@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Deep-Learning-with-keras">Deep Learning with keras<a class="anchor-link" href="#Deep-Learning-with-keras">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://keras.io/">Keras Documentation</a></li>
<li><a href="http://course.fast.ai/">Practical Deep Learning For Coders, Part 1</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Keras-deep-learning-library-installation-on-Windows">Keras deep learning library installation on Windows<a class="anchor-link" href="#Keras-deep-learning-library-installation-on-Windows">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See: <a href="https://charmie11.wordpress.com/2016/05/09/keras-deep-learning-library-installation-on-windows/">https://charmie11.wordpress.com/2016/05/09/keras-deep-learning-library-installation-on-windows/</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Working-on-the-cloud-with-Amazon-Web-Services-(AWS)">Working on the cloud with Amazon Web Services (AWS)<a class="anchor-link" href="#Working-on-the-cloud-with-Amazon-Web-Services-(AWS)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can skip the hassle of setting up deep learning frameworks from scratch by choosing an Amazon Machine Image (AMI) that comes pre-installed with the libraries and their dependencies. It has in costs, but sometimes it worth it (you can use the spot request options for lower costs).</p>
<p>For example, the Stanford class, CS231n: Convolutional Neural Networksfor Visual Recognition, has provided a public AMI with these specs:</p>
<ul>
<li>cs231n_caffe_torch7_keras_lasagne_v2</li>
<li>AMI ID: ami-125b2c72 in the us-west-1 region</li>
<li>Use a g2.2xlarge instance.</li>
<li>Caffe, Torch7, Theano, Keras and Lasagne are pre-installed. Python bindings of caffe are available. It has CUDA 7.5 and CuDNN v3.</li>
</ul>
<p>If youre new to AWS, CS231n provides a nice step-by-step <a href="http://cs231n.github.io/aws-tutorial/">AWS tutorial</a>.</p>
<p><a href="http://efavdb.com/deep-learning-with-jupyter-on-aws/">This tutorial</a> shows how to set up a public Jupyter notebook server in EC2 and then access it remotely through your web browser, just as you would if you were using a notebook launched from your own laptop.</p>
<p>In order to start the notebook server on an AWS instance, you should ssh into your instance. Since I didn't have a SSH client on my computer, I installed <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a> to connect to the Linux instance, but you can check the <a href="http://www.openssh.com">OpenSSH project</a> for other SSH tools.</p>
<p>Another useful thing when working on your AWS instance is the <a href="http://wiki.fast.ai/index.php/Kaggle_CLI">Kaggle-CLI</a> command line tool that will let you download Kaggle data and submit entries from the command line.</p>
<p>The two last things that I had to do to work on the given AMI were:</p>
<ol>
<li>unzipping data:<ul>
<li>sudo apt install unzip</li>
<li>unzip train.zip</li>
</ul>
</li>
<li>upgrading keras:<ul>
<li>pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps</li>
</ul>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setups">Setups<a class="anchor-link" href="#Setups">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import numpy, theano and keras:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[687]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">theano</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[688]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">keras</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>2.1.2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can update a version by running :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#!pip install --upgrade keras</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting keras
  Using cached Keras-2.1.2-py2.py3-none-any.whl
Requirement already up-to-date: numpy&gt;=1.9.1 in c:\anaconda3\lib\site-packages (from keras)
Requirement already up-to-date: pyyaml in c:\anaconda3\lib\site-packages (from keras)
Requirement already up-to-date: six&gt;=1.9.0 in c:\anaconda3\lib\site-packages (from keras)
Requirement already up-to-date: scipy&gt;=0.14 in c:\anaconda3\lib\site-packages (from keras)
Installing collected packages: keras
  Found existing installation: Keras 1.2.0
    Uninstalling Keras-1.2.0:
      Successfully uninstalled Keras-1.2.0
Successfully installed keras-2.1.2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I'll set an older version, in order to avoide updating other packages:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[690]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#!pip install keras==1.2</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting keras==1.2
Requirement already satisfied: theano in c:\anaconda3\lib\site-packages (from keras==1.2)
Requirement already satisfied: pyyaml in c:\anaconda3\lib\site-packages (from keras==1.2)
Requirement already satisfied: six in c:\anaconda3\lib\site-packages (from keras==1.2)
Requirement already satisfied: numpy&gt;=1.9.1 in c:\anaconda3\lib\site-packages (from theano-&gt;keras==1.2)
Requirement already satisfied: scipy&gt;=0.14 in c:\anaconda3\lib\site-packages (from theano-&gt;keras==1.2)
Installing collected packages: keras
  Found existing installation: Keras 2.1.2
    Uninstalling Keras-2.1.2:
      Successfully uninstalled Keras-2.1.2
Successfully installed keras-1.2.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>note:</strong> TensorFlow is also supported (as an alternative to Theano), but we stick with Theano to keep it simple. The main difference is that you'll need to reshape the data slightly differently before feeding it to your network.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[691]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">K</span>
<span class="n">K</span><span class="o">.</span><span class="n">set_image_dim_ordering</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Text-Generation-with-Keras">Text Generation with Keras<a class="anchor-link" href="#Text-Generation-with-Keras">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Deep learning can be used for learning the sequences of a problem and then generating entirely new plausible sequences for the problem domain.
In order to demonstrate some new layers and models, let's try to train a model based on a given text and create a new text with similar sequential patterns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-Data">Loading Data<a class="anchor-link" href="#Loading-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to download the collected works of Nietzsche to use as our data for this class.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.utils.data_utils</span> <span class="k">import</span> <span class="n">get_file</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span><span class="s1">&#39;nietzsche.txt&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;https://s3.amazonaws.com/text-datasets/nietzsche.txt&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;corpus length:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>corpus length: 600901
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's first examine this data, and recognize some issues to handle:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2000</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;PREFACE\n\n\nSUPPOSING that Truth is a woman--what then? Is there not ground\nfor suspecting that all philosophers, in so far as they have been\ndogmatists, have failed to understand women--that the terrible\nseriousness and clumsy importunity with which they have usually paid\ntheir addresses to Truth, have been unskilled and unseemly methods for\nwinning a woman? Certainly she has never allowed herself to be won; and\nat present every kind of dogma stands with sad and discouraged mien--IF,\nindeed, it stands at all! For there are scoffers who maintain that it\nhas fallen, that all dogma lies on the ground--nay more, that it is at\nits last gasp. But to speak seriously, there are good grounds for hoping\nthat all dogmatizing in philosophy, whatever solemn, whatever conclusive\nand decided airs it has assumed, may have been only a noble puerilism\nand tyronism; and probably the time is at hand when it will be once\nand again understood WHAT has actually sufficed for the basis of such\nimposing and absolute philosophical edifices as the dogmatists have\nhitherto reared: perhaps some popular superstition of immemorial time\n(such as the soul-superstition, which, in the form of subject- and\nego-superstition, has not yet ceased doing mischief): perhaps some\nplay upon words, a deception on the part of grammar, or an\naudacious generalization of very restricted, very personal, very\nhuman--all-too-human facts. The philosophy of the dogmatists, it is to\nbe hoped, was only a promise for thousands of years afterwards, as was\nastrology in still earlier times, in the service of which probably more\nlabour, gold, acuteness, and patience have been spent than on any\nactual science hitherto: we owe to it, and to its &#34;super-terrestrial&#34;\npretensions in Asia and Egypt, the grand style of architecture. It seems\nthat in order to inscribe themselves upon the heart of humanity with\neverlasting claims, all great things have first to wander about the\nearth as enormous and awe-inspiring caricatures: dogmatic phi&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing-the-text-to-fit-into-a-network">Preprocessing the text to fit into a network<a class="anchor-link" href="#Preprocessing-the-text-to-fit-into-a-network">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Most words in our text will only appear one or two times. 
Its a good idea to remove these infrequent words. Having a huge vocabulary will make our model slow to train, and because we dont have a lot of contextual examples for such words we wouldnt be able to learn how to use them correctly anyway. 
Thats quite similar to how humans learn. To really understand how to appropriately use a word you need to have seen it in different contexts.
In our code we limit our vocabulary to the vocabulary_size most common words (which was set to 600, mainly for memory limitations).</p>
<p>We replace all words not included in our vocabulary by UNKNOWN_TOKEN. 
For example, if we dont include the word nonlinearities in our vocabulary:</p>

<pre><code>- nonlineraties are important in neural networks 
- UNKNOWN_TOKEN are important in Neural Networks. </code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocabulary_size</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">unknown_token</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWNTOKEN&quot;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also want to learn which words tend start and end a sentence. 
To do this we prepend a special SENTENCE_START token, and append a special SENTENCE_END token to each sentence. 
This allows us to ask: 
Given that the first token is SENTENCE_START, what is the likely next word (the actual first word of the sentence)?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentence_start_token</span> <span class="o">=</span> <span class="s2">&quot;SENTENCESTART&quot;</span>
<span class="n">sentence_end_token</span> <span class="o">=</span> <span class="s2">&quot;SENTENCEEND&quot;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that in Nietzsche's text, there seems to be some meaning to things like line breaks and seperators. In order for these patterns to be preserved, let's convert it to speciel tokens, otherwise it will be removed from the text with the rest of the punctuations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">line_break</span><span class="o">=</span> <span class="s2">&quot;NEWLINE&quot;</span>
<span class="n">separator</span><span class="o">=</span> <span class="s2">&quot;SEPARATOR&quot;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's convert these special characters into the mentioned tokens:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text1</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">line_break</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">text1</span> <span class="o">=</span> <span class="n">text1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">text1</span> <span class="o">=</span> <span class="n">text1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">sentence_end_token</span> <span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">sentence_start_token</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="p">)</span>
<span class="n">text1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2000</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;PREFACE NEWLINE  NEWLINE  NEWLINE SUPPOSING that Truth is a woman SEPARATOR what then? Is there not ground NEWLINE for suspecting that all philosophers, in so far as they have been NEWLINE dogmatists, have failed to understand women SEPARATOR that the terrible NEWLINE seriousness and clumsy importunity with which they have usually paid NEWLINE their addresses to Truth, have been unskilled and unseemly methods for NEWLINE winning a woman? Certainly she has never allowed herself to be won; and NEWLINE at present every kind of dogma stands with sad and discouraged mien SEPARATOR IF, NEWLINE indeed, it stands at all! For there are scoffers who maintain that it NEWLINE has fallen, that all dogma lies on the ground SEPARATOR nay more, that it is at NEWLINE its last gasp SENTENCEEND SENTENCESTART  But to speak seriously, there are good grounds for hoping NEWLINE that all dogmatizing in philosophy, whatever solemn, whatever conclusive NEWLINE and decided airs it has assumed, may have been only a noble puerilism NEWLINE and tyronism; and probably the time is at hand when it will be once NEWLINE and again understood WHAT has actually sufficed for the basis of such NEWLINE imposing and absolute philosophical edifices as the dogmatists have NEWLINE hitherto reared: perhaps some popular superstition of immemorial time NEWLINE (such as the soul-superstition, which, in the form of subject- and NEWLINE ego-superstition, has not yet ceased doing mischief): perhaps some NEWLINE play upon words, a deception on the part of grammar, or an NEWLINE audacious generalization of very restricted, very personal, very NEWLINE human SEPARATOR all-too-human facts SENTENCEEND SENTENCESTART  The philosophy of the dogmatists, it is to NEWLINE be hoped, was only a promise for thousands of years afterwards, as was NEWLINE astrology in still earlier times, in the service of which probably more NEWLINE labour, gold, acuteness, and patience have been spent than on any NEWLINE actual science hitherto: we &#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have some text preprocessing functions in keras preprocessing.text module.
<strong>text_to_word_sequence</strong> splits a sentence into a list of words.
In this task we model the language as a sequence of words, so we use this function to split the entire text to a list of words, in its original order.
There are some parameters that allows to filter some unrelevant stuff and control the splitting:</p>
<ul>
<li><em>filters:</em> list (or concatenation) of characters to filter out, such as punctuation. Default: base_filter(), includes basic punctuation, tabs, and newlines.</li>
<li><em>lower:</em> boolean. Whether to set the text to lowercase.</li>
<li><em>split:</em> str. Separator for word splitting.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.preprocessing.text</span> <span class="k">import</span> <span class="n">text_to_word_sequence</span>
<span class="n">text2</span> <span class="o">=</span> <span class="n">text_to_word_sequence</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="c1">#using only 10000 first words</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[18]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[&#39;PREFACE&#39;,
 &#39;NEWLINE&#39;,
 &#39;NEWLINE&#39;,
 &#39;NEWLINE&#39;,
 &#39;SUPPOSING&#39;,
 &#39;that&#39;,
 &#39;Truth&#39;,
 &#39;is&#39;,
 &#39;a&#39;,
 &#39;woman&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The input to our Recurrent Neural Networks are vectors, not strings. So we create a mapping between words and indices.</p>
<p><strong>Tokenizer</strong> is a class for vectorizing texts, or/and turning texts into sequences (=list of word indexes, where the word of rank i in the dataset (starting at 1) has index i).
It considers the vocabulary size (nb_words) for indexing most frequent words, otherwise using the unknown-token index.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.preprocessing.text</span> <span class="k">import</span> <span class="n">Tokenizer</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">nb_words</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">char_level</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">token</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\preprocessing\text.py:145: UserWarning: The `nb_words` argument in `Tokenizer` has been renamed `num_words`.
  warnings.warn(&#39;The `nb_words` argument in `Tokenizer` &#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We represent each word as a one-hot vector of size vocabulary_size. 
For example, the word with index 36 would be the vector of all 0s and a 1 at position 36. 
So, each word will become a vector, and the input will be a matrix, with each row representing a word.</p>
<p><strong>texts_to_matrix</strong> performs this conversion for us when setting the mode parameter to 'binary'.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_mtx</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">texts_to_matrix</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our input is now a matrix. Each word has the size of the vocabulary:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_mtx</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(118372, 600)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>118372</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;word&#39;</span><span class="p">:</span><span class="n">text2</span><span class="p">,</span><span class="s1">&#39;code&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">text_mtx</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)})</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>
<span class="n">vocab</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\ipykernel\__main__.py:1: FutureWarning: sort(columns=....) is deprecated, use sort_values(by=.....)
  if __name__ == &#39;__main__&#39;:
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>word</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>PREFACE</td>
    </tr>
    <tr>
      <th>55824</th>
      <td>0</td>
      <td>THIRD</td>
    </tr>
    <tr>
      <th>55827</th>
      <td>0</td>
      <td>indignantly</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-&amp;-Output">Input &amp; Output<a class="anchor-link" href="#Input-&amp;-Output">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember that our goal is to predict the next word, so output<em> is just the input</em> matrix shifted by one row 
It is that simple to do it:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_</span> <span class="o">=</span> <span class="n">text_mtx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">output_</span> <span class="o">=</span> <span class="n">text_mtx</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Making sure that they both have the same number of rows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">output_</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[26]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((118371, 600), (118371, 600))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-and-train-model">Create and train model<a class="anchor-link" href="#Create-and-train-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Importing the relevant modules:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers.core</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">keras.layers.wrappers</span> <span class="k">import</span> <span class="n">TimeDistributed</span>
<span class="kn">from</span> <span class="nn">keras.layers.embeddings</span> <span class="k">import</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">keras.layers.recurrent</span> <span class="k">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">keras.layers.embeddings</span> <span class="k">import</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">keras.layers.recurrent</span> <span class="k">import</span> <span class="n">SimpleRNN</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's start by declaring a sequential model format, which is a linear stack of neural network layers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[709]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we can simply add more layers to our model like we're building legos:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We start by adding an embedding layer, that turns positive integers (indexes) into dense vectors of fixed size. eg. [[4], [20]] -&gt; [[0.25, 0.1], [0.6, -0.2]]</p>
<p>This layer can only be used as the first layer in a model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[710]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">output_dim</span><span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="c1"># the model will take as input an integer matrix of size (batch, vocabulary_size).</span>
<span class="c1"># the largest integer (i.e. word index) in the input should be no larger than 999 (vocabulary size).</span>
<span class="c1"># now model.output_shape == (None, vocabulary_size, 42), where None is the batch dimension.</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's connect it to a dense output layer, by first flattening the result, and then passing it to the output layer:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[711]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">output_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For Dense layers, the first parameter is the output size of the layer. Keras automatically handles the connections between layers.
Note that the final layer has an output size of the vocabulary, corresponding to each index in the vocabulary.
Also note that the weights from the embedding layer must be flattened (made 1-dimensional) before passing them to the fully connected Dense layer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compile-Model">Compile Model<a class="anchor-link" href="#Compile-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We just need to compile the model and we'll be ready to train it. When we compile the model, we declare the loss function and the optimizer (sgd, Adam, etc.).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[712]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Keras has a variety of <a href="https://keras.io/objectives/">loss functions</a>  and out-of-the-box <a href="https://keras.io/optimizers/">optimizers</a> to choose from.</p>
<p>Because this is a multi-class classification problem, we can use the log loss function (called categorical_crossentropy in Keras), and optimize the network using the rmsprop optimization optimizer, which is is usually a good choice for recurrent neural networks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>categorical_crossentropy</strong> is also known as multiclass logloss. Note: using this objective requires that your labels are binary arrays of shape (nb_samples, nb_classes).</p>
<p>The actual optimized loss is the mean of the output array across all datapoints.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-the-Model">Train the Model<a class="anchor-link" href="#Train-the-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To fit the model, all we have to do is declare the batch size and number of epochs to train for, then pass in our training data.</p>
<p>We usually train for several hundreds of iterations (nb_epoch), but I'm out of time here, so you will mostly view in this session poor results that could be easily improved with longer training.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">output_</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\models.py:939: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  max_q_size: maximum size for the generator queue
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 94696 samples, validate on 23675 samples
Epoch 1/10
  200/94696 [..............................] - ETA: 2:18 - loss: 4.8896 - acc: 0.0000e+00  400/94696 [..............................] - ETA: 2:15 - loss: 4.7185 - acc: 0.0000e+00  600/94696 [..............................] - ETA: 2:19 - loss: 4.7173 - acc: 0.0117      800/94696 [..............................] - ETA: 2:16 - loss: 4.6094 - acc: 0.0137 1000/94696 [..............................] - ETA: 2:15 - loss: 4.5261 - acc: 0.0130 1200/94696 [..............................] - ETA: 2:13 - loss: 4.4573 - acc: 0.0117 1400/94696 [..............................] - ETA: 2:12 - loss: 4.3844 - acc: 0.0114 1600/94696 [..............................] - ETA: 2:11 - loss: 4.2988 - acc: 0.0112 1800/94696 [..............................] - ETA: 2:10 - loss: 4.2702 - acc: 0.0128 2000/94696 [..............................] - ETA: 2:10 - loss: 4.2320 - acc: 0.0125 2200/94696 [..............................] - ETA: 2:10 - loss: 4.2273 - acc: 0.0123 2400/94696 [..............................] - ETA: 2:09 - loss: 4.2006 - acc: 0.0233 2600/94696 [..............................] - ETA: 2:09 - loss: 4.1861 - acc: 0.0285 2800/94696 [..............................] - ETA: 2:09 - loss: 4.1921 - acc: 0.0314 3000/94696 [..............................] - ETA: 2:09 - loss: 4.1737 - acc: 0.0367 3200/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1673 - acc: 0.0416 3400/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1685 - acc: 0.0438 3600/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1495 - acc: 0.0483 3800/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1432 - acc: 0.0505 4000/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1134 - acc: 0.0525 4200/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1059 - acc: 0.0538 4400/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1226 - acc: 0.0541 4600/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1139 - acc: 0.0539 4800/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1212 - acc: 0.0542 5000/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.1166 - acc: 0.0554 5200/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0992 - acc: 0.0560 5400/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0947 - acc: 0.0569 5600/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0965 - acc: 0.0582 5800/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0861 - acc: 0.0597 6000/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0817 - acc: 0.0602 6200/94696 [&gt;.............................] - ETA: 2:09 - loss: 4.0703 - acc: 0.0615 6400/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0820 - acc: 0.0625 6600/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0672 - acc: 0.0635 6800/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0724 - acc: 0.0644 7000/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0607 - acc: 0.0654 7200/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0555 - acc: 0.0649 7400/94696 [=&gt;............................] - ETA: 2:08 - loss: 4.0460 - acc: 0.0649 7600/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0457 - acc: 0.0661 7800/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0433 - acc: 0.0667 8000/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0423 - acc: 0.0678 8200/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0435 - acc: 0.0678 8400/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0413 - acc: 0.0677 8600/94696 [=&gt;............................] - ETA: 2:07 - loss: 4.0410 - acc: 0.0677 8800/94696 [=&gt;............................] - ETA: 2:06 - loss: 4.0379 - acc: 0.0680 9000/94696 [=&gt;............................] - ETA: 2:06 - loss: 4.0310 - acc: 0.0677 9200/94696 [=&gt;............................] - ETA: 2:06 - loss: 4.0290 - acc: 0.0678 9400/94696 [=&gt;............................] - ETA: 2:05 - loss: 4.0276 - acc: 0.0687 9600/94696 [==&gt;...........................] - ETA: 2:05 - loss: 4.0236 - acc: 0.0690 9800/94696 [==&gt;...........................] - ETA: 2:05 - loss: 4.0257 - acc: 0.069810000/94696 [==&gt;...........................] - ETA: 2:05 - loss: 4.0210 - acc: 0.069710200/94696 [==&gt;...........................] - ETA: 2:04 - loss: 4.0200 - acc: 0.070010400/94696 [==&gt;...........................] - ETA: 2:04 - loss: 4.0183 - acc: 0.070010600/94696 [==&gt;...........................] - ETA: 2:04 - loss: 4.0217 - acc: 0.070310800/94696 [==&gt;...........................] - ETA: 2:04 - loss: 4.0229 - acc: 0.070211000/94696 [==&gt;...........................] - ETA: 2:03 - loss: 4.0197 - acc: 0.071211200/94696 [==&gt;...........................] - ETA: 2:03 - loss: 4.0111 - acc: 0.071111400/94696 [==&gt;...........................] - ETA: 2:03 - loss: 4.0029 - acc: 0.071211600/94696 [==&gt;...........................] - ETA: 2:03 - loss: 4.0017 - acc: 0.071611800/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.9940 - acc: 0.072112000/94696 [==&gt;...........................] - ETA: 2:02 - loss: 3.9910 - acc: 0.071812200/94696 [==&gt;...........................] - ETA: 2:02 - loss: 3.9861 - acc: 0.072312400/94696 [==&gt;...........................] - ETA: 2:02 - loss: 3.9842 - acc: 0.072412600/94696 [==&gt;...........................] - ETA: 2:01 - loss: 3.9801 - acc: 0.072812800/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.9831 - acc: 0.072813000/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.9779 - acc: 0.073113200/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.9765 - acc: 0.073313400/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.9721 - acc: 0.073613600/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.9731 - acc: 0.074013800/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.9740 - acc: 0.074114000/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.9700 - acc: 0.074114200/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.9643 - acc: 0.074414400/94696 [===&gt;..........................] - ETA: 1:58 - loss: 3.9623 - acc: 0.074314600/94696 [===&gt;..........................] - ETA: 1:58 - loss: 3.9584 - acc: 0.074514800/94696 [===&gt;..........................] - ETA: 1:58 - loss: 3.9590 - acc: 0.074915000/94696 [===&gt;..........................] - ETA: 1:58 - loss: 3.9551 - acc: 0.074915200/94696 [===&gt;..........................] - ETA: 1:57 - loss: 3.9482 - acc: 0.075315400/94696 [===&gt;..........................] - ETA: 1:57 - loss: 3.9466 - acc: 0.075515600/94696 [===&gt;..........................] - ETA: 1:57 - loss: 3.9441 - acc: 0.075815800/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.9452 - acc: 0.075816000/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.9429 - acc: 0.076116200/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.9383 - acc: 0.076116400/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.9367 - acc: 0.076616600/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.9356 - acc: 0.076616800/94696 [====&gt;.........................] - ETA: 1:55 - loss: 3.9350 - acc: 0.076717000/94696 [====&gt;.........................] - ETA: 1:55 - loss: 3.9349 - acc: 0.076417200/94696 [====&gt;.........................] - ETA: 1:55 - loss: 3.9358 - acc: 0.076517400/94696 [====&gt;.........................] - ETA: 1:54 - loss: 3.9346 - acc: 0.076917600/94696 [====&gt;.........................] - ETA: 1:54 - loss: 3.9322 - acc: 0.077317800/94696 [====&gt;.........................] - ETA: 1:54 - loss: 3.9296 - acc: 0.077218000/94696 [====&gt;.........................] - ETA: 1:54 - loss: 3.9311 - acc: 0.076918200/94696 [====&gt;.........................] - ETA: 1:53 - loss: 3.9294 - acc: 0.076918400/94696 [====&gt;.........................] - ETA: 1:53 - loss: 3.9269 - acc: 0.077118600/94696 [====&gt;.........................] - ETA: 1:53 - loss: 3.9247 - acc: 0.077018800/94696 [====&gt;.........................] - ETA: 1:52 - loss: 3.9268 - acc: 0.077219000/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.9280 - acc: 0.077719200/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.9294 - acc: 0.077819400/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.9301 - acc: 0.077819600/94696 [=====&gt;........................] - ETA: 1:51 - loss: 3.9308 - acc: 0.077919800/94696 [=====&gt;........................] - ETA: 1:51 - loss: 3.9291 - acc: 0.078120000/94696 [=====&gt;........................] - ETA: 1:51 - loss: 3.9308 - acc: 0.077820200/94696 [=====&gt;........................] - ETA: 1:50 - loss: 3.9283 - acc: 0.078220400/94696 [=====&gt;........................] - ETA: 1:50 - loss: 3.9270 - acc: 0.078020600/94696 [=====&gt;........................] - ETA: 1:50 - loss: 3.9231 - acc: 0.078320800/94696 [=====&gt;........................] - ETA: 1:50 - loss: 3.9246 - acc: 0.078421000/94696 [=====&gt;........................] - ETA: 1:49 - loss: 3.9259 - acc: 0.078421200/94696 [=====&gt;........................] - ETA: 1:49 - loss: 3.9257 - acc: 0.078221400/94696 [=====&gt;........................] - ETA: 1:49 - loss: 3.9236 - acc: 0.078321600/94696 [=====&gt;........................] - ETA: 1:48 - loss: 3.9202 - acc: 0.078821800/94696 [=====&gt;........................] - ETA: 1:48 - loss: 3.9192 - acc: 0.078522000/94696 [=====&gt;........................] - ETA: 1:48 - loss: 3.9169 - acc: 0.078622200/94696 [======&gt;.......................] - ETA: 1:48 - loss: 3.9164 - acc: 0.078322400/94696 [======&gt;.......................] - ETA: 1:47 - loss: 3.9151 - acc: 0.078322600/94696 [======&gt;.......................] - ETA: 1:47 - loss: 3.9137 - acc: 0.078622800/94696 [======&gt;.......................] - ETA: 1:47 - loss: 3.9117 - acc: 0.079223000/94696 [======&gt;.......................] - ETA: 1:46 - loss: 3.9113 - acc: 0.079223200/94696 [======&gt;.......................] - ETA: 1:46 - loss: 3.9103 - acc: 0.078923400/94696 [======&gt;.......................] - ETA: 1:46 - loss: 3.9093 - acc: 0.078923600/94696 [======&gt;.......................] - ETA: 1:46 - loss: 3.9068 - acc: 0.079223800/94696 [======&gt;.......................] - ETA: 1:45 - loss: 3.9073 - acc: 0.079424000/94696 [======&gt;.......................] - ETA: 1:45 - loss: 3.9062 - acc: 0.079324200/94696 [======&gt;.......................] - ETA: 1:45 - loss: 3.9066 - acc: 0.079524400/94696 [======&gt;.......................] - ETA: 1:45 - loss: 3.9052 - acc: 0.079724600/94696 [======&gt;.......................] - ETA: 1:44 - loss: 3.9036 - acc: 0.080124800/94696 [======&gt;.......................] - ETA: 1:44 - loss: 3.8994 - acc: 0.079925000/94696 [======&gt;.......................] - ETA: 1:44 - loss: 3.8973 - acc: 0.080025200/94696 [======&gt;.......................] - ETA: 1:43 - loss: 3.8954 - acc: 0.080325400/94696 [=======&gt;......................] - ETA: 1:43 - loss: 3.8959 - acc: 0.080025600/94696 [=======&gt;......................] - ETA: 1:43 - loss: 3.8937 - acc: 0.080125800/94696 [=======&gt;......................] - ETA: 1:43 - loss: 3.8942 - acc: 0.080026000/94696 [=======&gt;......................] - ETA: 1:42 - loss: 3.8928 - acc: 0.080126200/94696 [=======&gt;......................] - ETA: 1:42 - loss: 3.8922 - acc: 0.080026400/94696 [=======&gt;......................] - ETA: 1:42 - loss: 3.8941 - acc: 0.080126600/94696 [=======&gt;......................] - ETA: 1:41 - loss: 3.8964 - acc: 0.080226800/94696 [=======&gt;......................] - ETA: 1:41 - loss: 3.8967 - acc: 0.080027000/94696 [=======&gt;......................] - ETA: 1:41 - loss: 3.8956 - acc: 0.079927200/94696 [=======&gt;......................] - ETA: 1:41 - loss: 3.8925 - acc: 0.079827400/94696 [=======&gt;......................] - ETA: 1:40 - loss: 3.8907 - acc: 0.079727600/94696 [=======&gt;......................] - ETA: 1:40 - loss: 3.8904 - acc: 0.079727800/94696 [=======&gt;......................] - ETA: 1:40 - loss: 3.8873 - acc: 0.079728000/94696 [=======&gt;......................] - ETA: 1:39 - loss: 3.8886 - acc: 0.079728200/94696 [=======&gt;......................] - ETA: 1:39 - loss: 3.8886 - acc: 0.079928400/94696 [=======&gt;......................] - ETA: 1:39 - loss: 3.8874 - acc: 0.080028600/94696 [========&gt;.....................] - ETA: 1:38 - loss: 3.8860 - acc: 0.080228800/94696 [========&gt;.....................] - ETA: 1:38 - loss: 3.8858 - acc: 0.080229000/94696 [========&gt;.....................] - ETA: 1:38 - loss: 3.8871 - acc: 0.080129200/94696 [========&gt;.....................] - ETA: 1:38 - loss: 3.8855 - acc: 0.080329400/94696 [========&gt;.....................] - ETA: 1:37 - loss: 3.8854 - acc: 0.080329600/94696 [========&gt;.....................] - ETA: 1:37 - loss: 3.8827 - acc: 0.080229800/94696 [========&gt;.....................] - ETA: 1:37 - loss: 3.8832 - acc: 0.080230000/94696 [========&gt;.....................] - ETA: 1:36 - loss: 3.8831 - acc: 0.080230200/94696 [========&gt;.....................] - ETA: 1:36 - loss: 3.8817 - acc: 0.080230400/94696 [========&gt;.....................] - ETA: 1:36 - loss: 3.8805 - acc: 0.080130600/94696 [========&gt;.....................] - ETA: 1:35 - loss: 3.8808 - acc: 0.080230800/94696 [========&gt;.....................] - ETA: 1:35 - loss: 3.8800 - acc: 0.080231000/94696 [========&gt;.....................] - ETA: 1:35 - loss: 3.8807 - acc: 0.080131200/94696 [========&gt;.....................] - ETA: 1:35 - loss: 3.8811 - acc: 0.080131400/94696 [========&gt;.....................] - ETA: 1:34 - loss: 3.8820 - acc: 0.079931600/94696 [=========&gt;....................] - ETA: 1:34 - loss: 3.8826 - acc: 0.080131800/94696 [=========&gt;....................] - ETA: 1:34 - loss: 3.8807 - acc: 0.080232000/94696 [=========&gt;....................] - ETA: 1:33 - loss: 3.8807 - acc: 0.080132200/94696 [=========&gt;....................] - ETA: 1:33 - loss: 3.8803 - acc: 0.080032400/94696 [=========&gt;....................] - ETA: 1:33 - loss: 3.8808 - acc: 0.080032600/94696 [=========&gt;....................] - ETA: 1:33 - loss: 3.8796 - acc: 0.080132800/94696 [=========&gt;....................] - ETA: 1:32 - loss: 3.8794 - acc: 0.079933000/94696 [=========&gt;....................] - ETA: 1:32 - loss: 3.8805 - acc: 0.079833200/94696 [=========&gt;....................] - ETA: 1:32 - loss: 3.8790 - acc: 0.079933400/94696 [=========&gt;....................] - ETA: 1:31 - loss: 3.8771 - acc: 0.079733600/94696 [=========&gt;....................] - ETA: 1:31 - loss: 3.8759 - acc: 0.079633800/94696 [=========&gt;....................] - ETA: 1:31 - loss: 3.8746 - acc: 0.079734000/94696 [=========&gt;....................] - ETA: 1:31 - loss: 3.8730 - acc: 0.079834200/94696 [=========&gt;....................] - ETA: 1:30 - loss: 3.8722 - acc: 0.079834400/94696 [=========&gt;....................] - ETA: 1:30 - loss: 3.8719 - acc: 0.079834600/94696 [=========&gt;....................] - ETA: 1:30 - loss: 3.8701 - acc: 0.080134800/94696 [==========&gt;...................] - ETA: 1:29 - loss: 3.8691 - acc: 0.079935000/94696 [==========&gt;...................] - ETA: 1:29 - loss: 3.8678 - acc: 0.079835200/94696 [==========&gt;...................] - ETA: 1:29 - loss: 3.8673 - acc: 0.079835400/94696 [==========&gt;...................] - ETA: 1:29 - loss: 3.8668 - acc: 0.079835600/94696 [==========&gt;...................] - ETA: 1:28 - loss: 3.8690 - acc: 0.079635800/94696 [==========&gt;...................] - ETA: 1:28 - loss: 3.8687 - acc: 0.079736000/94696 [==========&gt;...................] - ETA: 1:28 - loss: 3.8659 - acc: 0.079736200/94696 [==========&gt;...................] - ETA: 1:27 - loss: 3.8664 - acc: 0.079736400/94696 [==========&gt;...................] - ETA: 1:27 - loss: 3.8649 - acc: 0.079736600/94696 [==========&gt;...................] - ETA: 1:27 - loss: 3.8639 - acc: 0.079836800/94696 [==========&gt;...................] - ETA: 1:26 - loss: 3.8624 - acc: 0.079637000/94696 [==========&gt;...................] - ETA: 1:26 - loss: 3.8627 - acc: 0.079537200/94696 [==========&gt;...................] - ETA: 1:26 - loss: 3.8604 - acc: 0.079637400/94696 [==========&gt;...................] - ETA: 1:25 - loss: 3.8609 - acc: 0.079837600/94696 [==========&gt;...................] - ETA: 1:25 - loss: 3.8613 - acc: 0.079637800/94696 [==========&gt;...................] - ETA: 1:25 - loss: 3.8602 - acc: 0.079638000/94696 [===========&gt;..................] - ETA: 1:25 - loss: 3.8600 - acc: 0.079638200/94696 [===========&gt;..................] - ETA: 1:24 - loss: 3.8579 - acc: 0.079838400/94696 [===========&gt;..................] - ETA: 1:24 - loss: 3.8572 - acc: 0.080038600/94696 [===========&gt;..................] - ETA: 1:24 - loss: 3.8570 - acc: 0.080138800/94696 [===========&gt;..................] - ETA: 1:23 - loss: 3.8549 - acc: 0.080039000/94696 [===========&gt;..................] - ETA: 1:23 - loss: 3.8524 - acc: 0.080039200/94696 [===========&gt;..................] - ETA: 1:23 - loss: 3.8514 - acc: 0.080339400/94696 [===========&gt;..................] - ETA: 1:22 - loss: 3.8500 - acc: 0.080339600/94696 [===========&gt;..................] - ETA: 1:22 - loss: 3.8486 - acc: 0.080339800/94696 [===========&gt;..................] - ETA: 1:22 - loss: 3.8472 - acc: 0.080240000/94696 [===========&gt;..................] - ETA: 1:21 - loss: 3.8471 - acc: 0.080140200/94696 [===========&gt;..................] - ETA: 1:21 - loss: 3.8461 - acc: 0.080040400/94696 [===========&gt;..................] - ETA: 1:21 - loss: 3.8441 - acc: 0.080040600/94696 [===========&gt;..................] - ETA: 1:21 - loss: 3.8426 - acc: 0.079940800/94696 [===========&gt;..................] - ETA: 1:20 - loss: 3.8416 - acc: 0.080041000/94696 [===========&gt;..................] - ETA: 1:20 - loss: 3.8416 - acc: 0.080141200/94696 [============&gt;.................] - ETA: 1:20 - loss: 3.8398 - acc: 0.080341400/94696 [============&gt;.................] - ETA: 1:19 - loss: 3.8381 - acc: 0.080341600/94696 [============&gt;.................] - ETA: 1:19 - loss: 3.8385 - acc: 0.080341800/94696 [============&gt;.................] - ETA: 1:19 - loss: 3.8378 - acc: 0.080542000/94696 [============&gt;.................] - ETA: 1:18 - loss: 3.8376 - acc: 0.080542200/94696 [============&gt;.................] - ETA: 1:18 - loss: 3.8376 - acc: 0.080342400/94696 [============&gt;.................] - ETA: 1:18 - loss: 3.8363 - acc: 0.080242600/94696 [============&gt;.................] - ETA: 1:18 - loss: 3.8339 - acc: 0.080342800/94696 [============&gt;.................] - ETA: 1:17 - loss: 3.8328 - acc: 0.080443000/94696 [============&gt;.................] - ETA: 1:17 - loss: 3.8321 - acc: 0.080443200/94696 [============&gt;.................] - ETA: 1:17 - loss: 3.8302 - acc: 0.080343400/94696 [============&gt;.................] - ETA: 1:16 - loss: 3.8296 - acc: 0.080243600/94696 [============&gt;.................] - ETA: 1:16 - loss: 3.8285 - acc: 0.080343800/94696 [============&gt;.................] - ETA: 1:16 - loss: 3.8281 - acc: 0.080244000/94696 [============&gt;.................] - ETA: 1:15 - loss: 3.8270 - acc: 0.080244200/94696 [=============&gt;................] - ETA: 1:15 - loss: 3.8258 - acc: 0.080244400/94696 [=============&gt;................] - ETA: 1:15 - loss: 3.8258 - acc: 0.080044600/94696 [=============&gt;................] - ETA: 1:15 - loss: 3.8254 - acc: 0.079944800/94696 [=============&gt;................] - ETA: 1:14 - loss: 3.8248 - acc: 0.079945000/94696 [=============&gt;................] - ETA: 1:14 - loss: 3.8238 - acc: 0.080045200/94696 [=============&gt;................] - ETA: 1:14 - loss: 3.8233 - acc: 0.079945400/94696 [=============&gt;................] - ETA: 1:13 - loss: 3.8239 - acc: 0.079845600/94696 [=============&gt;................] - ETA: 1:13 - loss: 3.8231 - acc: 0.079845800/94696 [=============&gt;................] - ETA: 1:13 - loss: 3.8208 - acc: 0.079646000/94696 [=============&gt;................] - ETA: 1:12 - loss: 3.8211 - acc: 0.079646200/94696 [=============&gt;................] - ETA: 1:12 - loss: 3.8209 - acc: 0.079746400/94696 [=============&gt;................] - ETA: 1:12 - loss: 3.8221 - acc: 0.079746600/94696 [=============&gt;................] - ETA: 1:12 - loss: 3.8216 - acc: 0.079846800/94696 [=============&gt;................] - ETA: 1:11 - loss: 3.8200 - acc: 0.079947000/94696 [=============&gt;................] - ETA: 1:11 - loss: 3.8191 - acc: 0.079947200/94696 [=============&gt;................] - ETA: 1:11 - loss: 3.8191 - acc: 0.079947400/94696 [==============&gt;...............] - ETA: 1:10 - loss: 3.8178 - acc: 0.079947600/94696 [==============&gt;...............] - ETA: 1:10 - loss: 3.8192 - acc: 0.079847800/94696 [==============&gt;...............] - ETA: 1:10 - loss: 3.8195 - acc: 0.079948000/94696 [==============&gt;...............] - ETA: 1:09 - loss: 3.8183 - acc: 0.079948200/94696 [==============&gt;...............] - ETA: 1:09 - loss: 3.8171 - acc: 0.079948400/94696 [==============&gt;...............] - ETA: 1:09 - loss: 3.8169 - acc: 0.079948600/94696 [==============&gt;...............] - ETA: 1:09 - loss: 3.8161 - acc: 0.080148800/94696 [==============&gt;...............] - ETA: 1:08 - loss: 3.8161 - acc: 0.080149000/94696 [==============&gt;...............] - ETA: 1:08 - loss: 3.8143 - acc: 0.080249200/94696 [==============&gt;...............] - ETA: 1:08 - loss: 3.8126 - acc: 0.080149400/94696 [==============&gt;...............] - ETA: 1:07 - loss: 3.8119 - acc: 0.080249600/94696 [==============&gt;...............] - ETA: 1:07 - loss: 3.8102 - acc: 0.080249800/94696 [==============&gt;...............] - ETA: 1:07 - loss: 3.8097 - acc: 0.080350000/94696 [==============&gt;...............] - ETA: 1:06 - loss: 3.8102 - acc: 0.080250200/94696 [==============&gt;...............] - ETA: 1:06 - loss: 3.8084 - acc: 0.080350400/94696 [==============&gt;...............] - ETA: 1:06 - loss: 3.8078 - acc: 0.080350600/94696 [===============&gt;..............] - ETA: 1:06 - loss: 3.8069 - acc: 0.080350800/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.8064 - acc: 0.080451000/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.8054 - acc: 0.080451200/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.8033 - acc: 0.080451400/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.8041 - acc: 0.080551600/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.8024 - acc: 0.080651800/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.8034 - acc: 0.080752000/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.8025 - acc: 0.080752200/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.8016 - acc: 0.080952400/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.8000 - acc: 0.081052600/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.7996 - acc: 0.081152800/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.7997 - acc: 0.081353000/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.7988 - acc: 0.081453200/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.7986 - acc: 0.081453400/94696 [===============&gt;..............] - ETA: 1:01 - loss: 3.7974 - acc: 0.081653600/94696 [===============&gt;..............] - ETA: 1:01 - loss: 3.7976 - acc: 0.081753800/94696 [================&gt;.............] - ETA: 1:01 - loss: 3.7970 - acc: 0.081754000/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.7961 - acc: 0.081854200/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.7943 - acc: 0.081954400/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.7933 - acc: 0.082054600/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.7919 - acc: 0.082054800/94696 [================&gt;.............] - ETA: 59s - loss: 3.7913 - acc: 0.0823 55000/94696 [================&gt;.............] - ETA: 59s - loss: 3.7918 - acc: 0.082455200/94696 [================&gt;.............]67000/94696 [====================&gt;.........] - ETA: 41s - loss: 3.3034 - acc: 0.144067200/94696 [====================&gt;.........] - ETA: 41s - loss: 3.3036 - acc: 0.144067400/94696 [====================&gt;.........] - ETA: 40s - loss: 3.3025 - acc: 0.144067600/94696 [====================&gt;.........] - ETA: 40s - loss: 3.3025 - acc: 0.143967800/94696 [====================&gt;.........] - ETA: 40s - loss: 3.3021 - acc: 0.143968000/94696 [====================&gt;.........] - ETA: 40s - loss: 3.3028 - acc: 0.143968200/94696 [====================&gt;.........] - ETA: 39s - loss: 3.3028 - acc: 0.144068400/94696 [====================&gt;.........] - ETA: 39s - loss: 3.3031 - acc: 0.144168600/94696 [====================&gt;.........] - ETA: 39s - loss: 3.3033 - acc: 0.144268800/94696 [====================&gt;.........] - ETA: 38s - loss: 3.3028 - acc: 0.144269000/94696 [====================&gt;.........] - ETA: 38s - loss: 3.3035 - acc: 0.144169200/94696 [====================&gt;.........] - ETA: 38s - loss: 3.3040 - acc: 0.144069400/94696 [====================&gt;.........] - ETA: 38s - loss: 3.3052 - acc: 0.143869600/94696 [=====================&gt;........] - ETA: 37s - loss: 3.3043 - acc: 0.143869800/94696 [=====================&gt;........] - ETA: 37s - loss: 3.3047 - acc: 0.143870000/94696 [=====================&gt;........] - ETA: 37s - loss: 3.3045 - acc: 0.143870200/94696 [=====================&gt;........] - ETA: 36s - loss: 3.3043 - acc: 0.143870400/94696 [=====================&gt;........] - ETA: 36s - loss: 3.3041 - acc: 0.143970600/94696 [=====================&gt;........] - ETA: 36s - loss: 3.3038 - acc: 0.143970800/94696 [=====================&gt;........] - ETA: 35s - loss: 3.3043 - acc: 0.143971000/94696 [=====================&gt;........] - ETA: 35s - loss: 3.3043 - acc: 0.143971200/94696 [=====================&gt;........] - ETA: 35s - loss: 3.3036 - acc: 0.143971400/94696 [=====================&gt;........] - ETA: 35s - loss: 3.3035 - acc: 0.143871600/94696 [=====================&gt;........] - ETA: 34s - loss: 3.3034 - acc: 0.143871800/94696 [=====================&gt;........] - ETA: 34s - loss: 3.3030 - acc: 0.143872000/94696 [=====================&gt;........] - ETA: 34s - loss: 3.3021 - acc: 0.143972200/94696 [=====================&gt;........] - ETA: 33s - loss: 3.3025 - acc: 0.143972400/94696 [=====================&gt;........] - ETA: 33s - loss: 3.3025 - acc: 0.143972600/94696 [=====================&gt;........] - ETA: 33s - loss: 3.3030 - acc: 0.143972800/94696 [======================&gt;.......] - ETA: 32s - loss: 3.3037 - acc: 0.143973000/94696 [======================&gt;.......] - ETA: 32s - loss: 3.3041 - acc: 0.143973200/94696 [======================&gt;.......] - ETA: 32s - loss: 3.3044 - acc: 0.143873400/94696 [======================&gt;.......] - ETA: 32s - loss: 3.3050 - acc: 0.143873600/94696 [======================&gt;.......] - ETA: 31s - loss: 3.3055 - acc: 0.143973800/94696 [======================&gt;.......] - ETA: 31s - loss: 3.3058 - acc: 0.143974000/94696 [======================&gt;.......] - ETA: 31s - loss: 3.3065 - acc: 0.143974200/94696 [======================&gt;.......] - ETA: 30s - loss: 3.3058 - acc: 0.143974400/94696 [======================&gt;.......] - ETA: 30s - loss: 3.3057 - acc: 0.144074600/94696 [======================&gt;.......] - ETA: 30s - loss: 3.3053 - acc: 0.144074800/94696 [======================&gt;.......] - ETA: 29s - loss: 3.3058 - acc: 0.144075000/94696 [======================&gt;.......] - ETA: 29s - loss: 3.3062 - acc: 0.144075200/94696 [======================&gt;.......] - ETA: 29s - loss: 3.3065 - acc: 0.144175400/94696 [======================&gt;.......] - ETA: 29s - loss: 3.3077 - acc: 0.144075600/94696 [======================&gt;.......] - ETA: 28s - loss: 3.3067 - acc: 0.144175800/94696 [=======================&gt;......] - ETA: 28s - loss: 3.3075 - acc: 0.144076000/94696 [=======================&gt;......] - ETA: 28s - loss: 3.3079 - acc: 0.144176200/94696 [=======================&gt;......] - ETA: 27s - loss: 3.3068 - acc: 0.144276400/94696 [=======================&gt;......] - ETA: 27s - loss: 3.3073 - acc: 0.144376600/94696 [=======================&gt;......] - ETA: 27s - loss: 3.3064 - acc: 0.144376800/94696 [=======================&gt;......] - ETA: 26s - loss: 3.3067 - acc: 0.144377000/94696 [=======================&gt;......] - ETA: 26s - loss: 3.3065 - acc: 0.144477200/94696 [=======================&gt;......] - ETA: 26s - loss: 3.3055 - acc: 0.144477400/94696 [=======================&gt;......] - ETA: 26s - loss: 3.3055 - acc: 0.144577600/94696 [=======================&gt;......] - ETA: 25s - loss: 3.3051 - acc: 0.144677800/94696 [=======================&gt;......] - ETA: 25s - loss: 3.3058 - acc: 0.144678000/94696 [=======================&gt;......] - ETA: 25s - loss: 3.3059 - acc: 0.144678200/94696 [=======================&gt;......] - ETA: 24s - loss: 3.3060 - acc: 0.144678400/94696 [=======================&gt;......] - ETA: 24s - loss: 3.3063 - acc: 0.144878600/94696 [=======================&gt;......] - ETA: 24s - loss: 3.3058 - acc: 0.144778800/94696 [=======================&gt;......] - ETA: 23s - loss: 3.3046 - acc: 0.144779000/94696 [========================&gt;.....] - ETA: 23s - loss: 3.3045 - acc: 0.144679200/94696 [========================&gt;.....] - ETA: 23s - loss: 3.3043 - acc: 0.144779400/94696 [========================&gt;.....] - ETA: 22s - loss: 3.3047 - acc: 0.144679600/94696 [========================&gt;.....] - ETA: 22s - loss: 3.3052 - acc: 0.144679800/94696 [========================&gt;.....] - ETA: 22s - loss: 3.3052 - acc: 0.144680000/94696 [========================&gt;.....] - ETA: 22s - loss: 3.3050 - acc: 0.144680200/94696 [========================&gt;.....] - ETA: 21s - loss: 3.3052 - acc: 0.144680400/94696 [========================&gt;.....] - ETA: 21s - loss: 3.3061 - acc: 0.144680600/94696 [========================&gt;.....] - ETA: 21s - loss: 3.3063 - acc: 0.144580800/94696 [========================&gt;.....] - ETA: 20s - loss: 3.3046 - acc: 0.144581000/94696 [========================&gt;.....] - ETA: 20s - loss: 3.3047 - acc: 0.144481200/94696 [========================&gt;.....] - ETA: 20s - loss: 3.3042 - acc: 0.144381400/94696 [========================&gt;.....] - ETA: 19s - loss: 3.3035 - acc: 0.144481600/94696 [========================&gt;.....] - ETA: 19s - loss: 3.3039 - acc: 0.144381800/94696 [========================&gt;.....] - ETA: 19s - loss: 3.3035 - acc: 0.144482000/94696 [========================&gt;.....] - ETA: 19s - loss: 3.3031 - acc: 0.144482200/94696 [=========================&gt;....] - ETA: 18s - loss: 3.3030 - acc: 0.144382400/94696 [=========================&gt;....] - ETA: 18s - loss: 3.3031 - acc: 0.144382600/94696 [=========================&gt;....] - ETA: 18s - loss: 3.3037 - acc: 0.144282800/94696 [=========================&gt;....] - ETA: 17s - loss: 3.3040 - acc: 0.144283000/94696 [=========================&gt;....] - ETA: 17s - loss: 3.3041 - acc: 0.144383200/94696 [=========================&gt;....] - ETA: 17s - loss: 3.3045 - acc: 0.144383400/94696 [=========================&gt;....] - ETA: 16s - loss: 3.3037 - acc: 0.144483600/94696 [=========================&gt;....] - ETA: 16s - loss: 3.3040 - acc: 0.144483800/94696 [=========================&gt;....] - ETA: 16s - loss: 3.3033 - acc: 0.144484000/94696 [=========================&gt;....] - ETA: 16s - loss: 3.3041 - acc: 0.144484200/94696 [=========================&gt;....] - ETA: 15s - loss: 3.3049 - acc: 0.144484400/94696 [=========================&gt;....] - ETA: 15s - loss: 3.3050 - acc: 0.144384600/94696 [=========================&gt;....] - ETA: 15s - loss: 3.3049 - acc: 0.144384800/94696 [=========================&gt;....] - ETA: 14s - loss: 3.3052 - acc: 0.144385000/94696 [=========================&gt;....] - ETA: 14s - loss: 3.3055 - acc: 0.144285200/94696 [=========================&gt;....] - ETA: 14s - loss: 3.3055 - acc: 0.144185400/94696 [==========================&gt;...] - ETA: 13s - loss: 3.3059 - acc: 0.144185600/94696 [==========================&gt;...] - ETA: 13s - loss: 3.3053 - acc: 0.144285800/94696 [==========================&gt;...] - ETA: 13s - loss: 3.3050 - acc: 0.144186000/94696 [==========================&gt;...] - ETA: 13s - loss: 3.3045 - acc: 0.144186200/94696 [==========================&gt;...] - ETA: 12s - loss: 3.3051 - acc: 0.144186400/94696 [==========================&gt;...]94696/94696 [==============================] - 148s 2ms/step - loss: 3.2713 - acc: 0.1471 - val_loss: 3.5532 - val_acc: 0.1598
Epoch 6/10
  200/94696 [..............................] - ETA: 2:32 - loss: 3.4407 - acc: 0.1700  400/94696 [..............................] - ETA: 2:27 - loss: 3.3390 - acc: 0.1675  600/94696 [..............................] - ETA: 2:23 - loss: 3.3542 - acc: 0.1567  800/94696 [..............................] - ETA: 2:22 - loss: 3.3664 - acc: 0.1550 1000/94696 [..............................] - ETA: 2:20 - loss: 3.4024 - acc: 0.1460 1200/94696 [..............................] - ETA: 2:20 - loss: 3.3779 - acc: 0.1492 1400/94696 [..............................] - ETA: 2:19 - loss: 3.3729 - acc: 0.1450 1600/94696 [..............................] - ETA: 2:19 - loss: 3.3592 - acc: 0.1394 1800/94696 [..............................] - ETA: 2:19 - loss: 3.3328 - acc: 0.1467 2000/94696 [..............................] - ETA: 2:19 - loss: 3.3367 - acc: 0.1425 2200/94696 [..............................] - ETA: 2:18 - loss: 3.3177 - acc: 0.1414 2400/94696 [..............................] - ETA: 2:18 - loss: 3.2914 - acc: 0.1413 2600/94696 [..............................] - ETA: 2:17 - loss: 3.2633 - acc: 0.1450 2800/94696 [..............................] - ETA: 2:16 - loss: 3.2528 - acc: 0.1475 3000/94696 [..............................] - ETA: 2:17 - loss: 3.2637 - acc: 0.1487 3200/94696 [&gt;.............................] - ETA: 2:16 - loss: 3.2522 - acc: 0.1456 3400/94696 [&gt;.............................] - ETA: 2:16 - loss: 3.2369 - acc: 0.1453 3600/94696 [&gt;.............................] - ETA: 2:16 - loss: 3.2244 - acc: 0.1475 3800/94696 [&gt;.............................] - ETA: 2:17 - loss: 3.2029 - acc: 0.1497 4000/94696 [&gt;.............................] - ETA: 2:17 - loss: 3.2003 - acc: 0.1495 4200/94696 [&gt;.............................] - ETA: 2:17 - loss: 3.2120 - acc: 0.1479 4400/94696 [&gt;.............................] - ETA: 2:17 - loss: 3.2019 - acc: 0.1491 4600/94696 [&gt;.............................] - ETA: 2:16 - loss: 3.1958 - acc: 0.1507 4800/94696 [&gt;.............................] - ETA: 2:15 - loss: 3.1954 - acc: 0.1492 5000/94696 [&gt;.............................] - ETA: 2:15 - loss: 3.2138 - acc: 0.1496 5200/94696 [&gt;.............................] - ETA: 2:15 - loss: 3.2167 - acc: 0.1487 5400/94696 [&gt;.............................] - ETA: 2:14 - loss: 3.2168 - acc: 0.1487 5600/94696 [&gt;.............................] - ETA: 2:14 - loss: 3.2125 - acc: 0.1480 5800/94696 [&gt;.............................] - ETA: 2:14 - loss: 3.2158 - acc: 0.1474 6000/94696 [&gt;.............................] - ETA: 2:13 - loss: 3.2175 - acc: 0.1473 6200/94696 [&gt;.............................] - ETA: 2:13 - loss: 3.2214 - acc: 0.1463 6400/94696 [=&gt;............................] - ETA: 2:13 - loss: 3.2117 - acc: 0.1464 6600/94696 [=&gt;............................] - ETA: 2:12 - loss: 3.2245 - acc: 0.1464 6800/94696 [=&gt;............................] - ETA: 2:12 - loss: 3.2268 - acc: 0.1456 7000/94696 [=&gt;............................] - ETA: 2:11 - loss: 3.2423 - acc: 0.1450 7200/94696 [=&gt;............................] - ETA: 2:11 - loss: 3.2414 - acc: 0.1458 7400/94696 [=&gt;............................] - ETA: 2:11 - loss: 3.2453 - acc: 0.1465 7600/94696 [=&gt;............................] - ETA: 2:11 - loss: 3.2490 - acc: 0.1468 7800/94696 [=&gt;............................] - ETA: 2:11 - loss: 3.2522 - acc: 0.1468 8000/94696 [=&gt;............................] - ETA: 2:10 - loss: 3.2512 - acc: 0.1473 8200/94696 [=&gt;............................] - ETA: 2:10 - loss: 3.2475 - acc: 0.1477 8400/94696 [=&gt;............................] - ETA: 2:10 - loss: 3.2476 - acc: 0.1488 8600/94696 [=&gt;............................] - ETA: 2:09 - loss: 3.2483 - acc: 0.1480 8800/94696 [=&gt;............................] - ETA: 2:09 - loss: 3.2472 - acc: 0.1482 9000/94696 [=&gt;............................] - ETA: 2:09 - loss: 3.2434 - acc: 0.1484 9200/94696 [=&gt;............................] - ETA: 2:08 - loss: 3.2427 - acc: 0.1485 9400/94696 [=&gt;............................] - ETA: 2:08 - loss: 3.2402 - acc: 0.1486 9600/94696 [==&gt;...........................] - ETA: 2:08 - loss: 3.2396 - acc: 0.1476 9800/94696 [==&gt;...........................] - ETA: 2:07 - loss: 3.2371 - acc: 0.148310000/94696 [==&gt;...........................] - ETA: 2:07 - loss: 3.2444 - acc: 0.148610200/94696 [==&gt;...........................] - ETA: 2:07 - loss: 3.2433 - acc: 0.148710400/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2364 - acc: 0.148710600/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2347 - acc: 0.148610800/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2338 - acc: 0.148711000/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2397 - acc: 0.148311200/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2422 - acc: 0.147911400/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2486 - acc: 0.148311600/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2465 - acc: 0.148911800/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2450 - acc: 0.148812000/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2431 - acc: 0.149512200/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.2421 - acc: 0.149112400/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.2367 - acc: 0.149912600/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.2357 - acc: 0.149912800/94696 [===&gt;..........................] - ETA: 2:03 - loss: 3.2346 - acc: 0.150113000/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2321 - acc: 0.150513200/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2307 - acc: 0.150713400/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2306 - acc: 0.150613600/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2321 - acc: 0.151313800/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2295 - acc: 0.151714000/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2278 - acc: 0.151514200/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2267 - acc: 0.151514400/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.2294 - acc: 0.1510 9400/94696 [=&gt;............................] - ETA: 2:08 - loss: 3.2354 - acc: 0.1437 9600/94696 [==&gt;...........................] - ETA: 2:07 - loss: 3.2410 - acc: 0.1439 9800/94696 [==&gt;...........................] - ETA: 2:07 - loss: 3.2400 - acc: 0.143510000/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2448 - acc: 0.143610200/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2474 - acc: 0.144010400/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2511 - acc: 0.144410600/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2514 - acc: 0.144410800/94696 [==&gt;...........................] - ETA: 2:06 - loss: 3.2575 - acc: 0.144411000/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2563 - acc: 0.144411200/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2512 - acc: 0.144711400/94696 [==&gt;...........................] - ETA: 2:05 - loss: 3.2452 - acc: 0.145411600/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2467 - acc: 0.144911800/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2464 - acc: 0.144812000/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2420 - acc: 0.145812200/94696 [==&gt;...........................] - ETA: 2:04 - loss: 3.2399 - acc: 0.146512400/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.2402 - acc: 0.146912600/94696 [==&gt;...........................] - ETA: 2:03 - loss: 3.2439 - acc: 0.147112800/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2446 - acc: 0.146713000/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2400 - acc: 0.146813200/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2392 - acc: 0.146513400/94696 [===&gt;..........................] - ETA: 2:02 - loss: 3.2405 - acc: 0.146613600/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2423 - acc: 0.146613800/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2547 - acc: 0.145914000/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2583 - acc: 0.145914200/94696 [===&gt;..........................] - ETA: 2:01 - loss: 3.2596 - acc: 0.145914400/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.2578 - acc: 0.146314600/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.2558 - acc: 0.145814800/94696 [===&gt;..........................] - ETA: 2:00 - loss: 3.2554 - acc: 0.146015000/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.2526 - acc: 0.146315200/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.2530 - acc: 0.146015400/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.2520 - acc: 0.145615600/94696 [===&gt;..........................] - ETA: 1:59 - loss: 3.2540 - acc: 0.145315800/94696 [====&gt;.........................] - ETA: 1:58 - loss: 3.2547 - acc: 0.145016000/94696 [====&gt;.........................] - ETA: 1:58 - loss: 3.2542 - acc: 0.144816200/94696 [====&gt;.........................] - ETA: 1:58 - loss: 3.2550 - acc: 0.144816400/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2526 - acc: 0.144616600/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2526 - acc: 0.144916800/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2522 - acc: 0.145417000/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2531 - acc: 0.145617200/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2564 - acc: 0.145517400/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2560 - acc: 0.145717600/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2553 - acc: 0.145717800/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2527 - acc: 0.145718000/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2482 - acc: 0.145618200/94696 [====&gt;.........................] - ETA: 1:57 - loss: 3.2457 - acc: 0.145818400/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2433 - acc: 0.146018600/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2447 - acc: 0.145718800/94696 [====&gt;.........................] - ETA: 1:56 - loss: 3.2506 - acc: 0.145619000/94696 [=====&gt;........................] - ETA: 1:56 - loss: 3.2543 - acc: 0.145219200/94696 [=====&gt;........................] - ETA: 1:55 - loss: 3.2553 - acc: 0.145319400/94696 [=====&gt;........................] - ETA: 1:55 - loss: 3.2534 - acc: 0.145019600/94696 [=====&gt;........................] - ETA: 1:55 - loss: 3.2523 - acc: 0.144619800/94696 [=====&gt;........................] - ETA: 1:54 - loss: 3.2508 - acc: 0.144820000/94696 [=====&gt;........................] - ETA: 1:54 - loss: 3.2497 - acc: 0.145020200/94696 [=====&gt;........................] - ETA: 1:54 - loss: 3.2499 - acc: 0.145420400/94696 [=====&gt;........................] - ETA: 1:53 - loss: 3.2507 - acc: 0.145220600/94696 [=====&gt;........................] - ETA: 1:53 - loss: 3.2502 - acc: 0.145520800/94696 [=====&gt;........................] - ETA: 1:53 - loss: 3.2494 - acc: 0.145721000/94696 [=====&gt;........................] - ETA: 1:53 - loss: 3.2496 - acc: 0.145821200/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.2480 - acc: 0.145821400/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.2470 - acc: 0.146121600/94696 [=====&gt;........................] - ETA: 1:52 - loss: 3.2469 - acc: 0.145821800/94696 [=====&gt;........................] - ETA: 1:51 - loss: 3.2480 - acc: 0.145622000/94696 [=====&gt;........................] - ETA: 1:51 - loss: 3.2477 - acc: 0.145622200/94696 [======&gt;.......................] - ETA: 1:51 - loss: 3.2454 - acc: 0.145822400/94696 [======&gt;.......................] - ETA: 1:51 - loss: 3.2479 - acc: 0.145522600/94696 [======&gt;.......................] - ETA: 1:50 - loss: 3.2477 - acc: 0.145822800/94696 [======&gt;.......................] - ETA: 1:50 - loss: 3.2479 - acc: 0.145423000/94696 [======&gt;.......................] - ETA: 1:50 - loss: 3.2496 - acc: 0.145423200/94696 [======&gt;.......................] - ETA: 1:49 - loss: 3.2547 - acc: 0.145023400/94696 [======&gt;.......................] - ETA: 1:49 - loss: 3.2546 - acc: 0.145323600/94696 [======&gt;.......................] - ETA: 1:49 - loss: 3.2550 - acc: 0.145223800/94696 [======&gt;.......................] - ETA: 1:48 - loss: 3.2544 - acc: 0.145050200/94696 [==============&gt;...............] - ETA: 1:07 - loss: 3.2390 - acc: 0.149850400/94696 [==============&gt;...............] - ETA: 1:07 - loss: 3.2384 - acc: 0.149950600/94696 [===============&gt;..............] - ETA: 1:06 - loss: 3.2381 - acc: 0.149850800/94696 [===============&gt;..............] - ETA: 1:06 - loss: 3.2379 - acc: 0.149851000/94696 [===============&gt;..............] - ETA: 1:06 - loss: 3.2361 - acc: 0.149851200/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.2364 - acc: 0.149751400/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.2362 - acc: 0.149851600/94696 [===============&gt;..............] - ETA: 1:05 - loss: 3.2352 - acc: 0.149751800/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.2344 - acc: 0.149752000/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.2346 - acc: 0.149752200/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.2350 - acc: 0.149652400/94696 [===============&gt;..............] - ETA: 1:04 - loss: 3.2338 - acc: 0.149652600/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.2331 - acc: 0.149652800/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.2328 - acc: 0.149653000/94696 [===============&gt;..............] - ETA: 1:03 - loss: 3.2330 - acc: 0.149653200/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.2337 - acc: 0.149553400/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.2332 - acc: 0.149653600/94696 [===============&gt;..............] - ETA: 1:02 - loss: 3.2330 - acc: 0.149653800/94696 [================&gt;.............] - ETA: 1:01 - loss: 3.2327 - acc: 0.149654000/94696 [================&gt;.............] - ETA: 1:01 - loss: 3.2324 - acc: 0.149554200/94696 [================&gt;.............] - ETA: 1:01 - loss: 3.2325 - acc: 0.149454400/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.2331 - acc: 0.149454600/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.2341 - acc: 0.149454800/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.2336 - acc: 0.149355000/94696 [================&gt;.............] - ETA: 1:00 - loss: 3.2338 - acc: 0.149355200/94696 [================&gt;.............] - ETA: 59s - loss: 3.2355 - acc: 0.1493 55400/94696 [================&gt;.............] - ETA: 59s - loss: 3.2370 - acc: 0.149255600/94696 [================&gt;.............] - ETA: 59s - loss: 3.2375 - acc: 0.149255800/94696 [================&gt;.............] - ETA: 58s - loss: 3.2379 - acc: 0.149256000/94696 [================&gt;.............] - ETA: 58s - loss: 3.2386 - acc: 0.149256200/94696 [================&gt;.............] - ETA: 58s - loss: 3.2382 - acc: 0.149156400/94696 [================&gt;.............] - ETA: 57s - loss: 3.2383 - acc: 0.149256600/94696 [================&gt;.............] - ETA: 57s - loss: 3.2385 - acc: 0.149156800/94696 [================&gt;.............] - ETA: 57s - loss: 3.2378 - acc: 0.149157000/94696 [=================&gt;............] - ETA: 57s - loss: 3.2369 - acc: 0.149157200/94696 [=================&gt;............] - ETA: 56s - loss: 3.2373 - acc: 0.149157400/94696 [=================&gt;............] - ETA: 56s - loss: 3.2375 - acc: 0.149157600/94696 [=================&gt;............] - ETA: 56s - loss: 3.2374 - acc: 0.149157800/94696 [=================&gt;............] - ETA: 55s - loss: 3.2376 - acc: 0.149258000/94696 [=================&gt;............] - ETA: 55s - loss: 3.2374 - acc: 0.149158200/94696 [=================&gt;............] - ETA: 55s - loss: 3.2372 - acc: 0.149058400/94696 [=================&gt;............] - ETA: 54s - loss: 3.2375 - acc: 0.148858600/94696 [=================&gt;............] - ETA: 54s - loss: 3.2371 - acc: 0.148958800/94696 [=================&gt;............] - ETA: 54s - loss: 3.2361 - acc: 0.148859000/94696 [=================&gt;............] - ETA: 54s - loss: 3.2354 - acc: 0.148959200/94696 [=================&gt;............] - ETA: 53s - loss: 3.2349 - acc: 0.148959400/94696 [=================&gt;............] - ETA: 53s - loss: 3.2358 - acc: 0.148859600/94696 [=================&gt;............] - ETA: 53s - loss: 3.2364 - acc: 0.148759800/94696 [=================&gt;............] - ETA: 52s - loss: 3.2371 - acc: 0.148760000/94696 [==================&gt;...........] - ETA: 52s - loss: 3.2363 - acc: 0.148860200/94696 [==================&gt;...........] - ETA: 52s - loss: 3.2353 - acc: 0.148860400/94696 [==================&gt;...........] - ETA: 51s - loss: 3.2349 - acc: 0.148860600/94696 [==================&gt;...........] - ETA: 51s - loss: 3.2348 - acc: 0.148760800/94696 [==================&gt;...........] - ETA: 51s - loss: 3.2359 - acc: 0.148661000/94696 [==================&gt;...........] - ETA: 50s - loss: 3.2373 - acc: 0.148561200/94696 [==================&gt;...........] - ETA: 50s - loss: 3.2379 - acc: 0.148661400/94696 [==================&gt;...........] - ETA: 50s - loss: 3.2380 - acc: 0.148561600/94696 [==================&gt;...........] - ETA: 50s - loss: 3.2384 - acc: 0.148561800/94696 [==================&gt;...........] - ETA: 49s - loss: 3.2381 - acc: 0.148562000/94696 [==================&gt;...........] - ETA: 49s - loss: 3.2389 - acc: 0.148562200/94696 [==================&gt;...........] - ETA: 49s - loss: 3.2392 - acc: 0.148562400/94696 [==================&gt;...........] - ETA: 48s - loss: 3.2387 - acc: 0.148562600/94696 [==================&gt;...........] - ETA: 48s - loss: 3.2391 - acc: 0.148762800/94696 [==================&gt;...........] - ETA: 48s - loss: 3.2395 - acc: 0.148863000/94696 [==================&gt;...........] - ETA: 47s - loss: 3.2396 - acc: 0.148963200/94696 [===================&gt;..........] - ETA: 47s - loss: 3.2389 - acc: 0.148963400/94696 [===================&gt;..........] - ETA: 47s - loss: 3.2386 - acc: 0.148863600/94696 [===================&gt;..........] - ETA: 47s - loss: 3.2401 - acc: 0.148763800/94696 [===================&gt;..........] - ETA: 46s - loss: 3.2407 - acc: 0.148864000/94696 [===================&gt;..........] - ETA: 46s - loss: 3.2425 - acc: 0.148664200/94696 [===================&gt;..........] - ETA: 46s - loss: 3.2431 - acc: 0.148664400/94696 [===================&gt;..........] - ETA: 45s - loss: 3.2444 - acc: 0.148564600/94696 [===================&gt;..........] - ETA: 45s - loss: 3.2451 - acc: 0.1485</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Check-the-Model">Check the Model<a class="anchor-link" href="#Check-the-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also use a variety of callbacks to set early-stopping rules, save model weights along the way, or log the history of each training epoch.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[714]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s1">&#39;weights_1&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[715]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s1">&#39;weights_1&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluate-model-on-test-data">Evaluate model on test data<a class="anchor-link" href="#Evaluate-model-on-test-data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can evaluate our model on the test data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[716]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span><span class="n">output_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">score</span>
<span class="c1">#(loss,accuracy)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[716]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[3.3922732705569265, 0.14287283202836676]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To predict the class labels, we can then use the predict_classes method to return the class labels directly as integers:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[717]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[718]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_test_pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[718]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(118371,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Comparing a sample of true and predicted labels:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[719]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output_</span><span class="p">[:</span><span class="mi">150</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[719]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([  1,  44,  21,   0,   1,   0,   0, 237,  60,  11,  23,  21,  13,
         5,  12], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[720]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_test_pred</span><span class="p">[:</span><span class="mi">150</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[720]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([4, 4, 1, 1, 4, 4, 1, 1, 1, 4, 9, 1, 1, 1, 1], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predicting probabilities for each class:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[721]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[722]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[722]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([5.41178250e-17, 1.03345021e-09, 3.17614102e-10, 3.77417181e-10,
       5.24395805e-10, 2.41877546e-10, 3.30501143e-12, 5.48998548e-17,
       1.56096108e-10, 8.58819751e-11, 8.86526200e-11, 2.30165691e-12,
       9.65985625e-11, 6.21548438e-11, 8.60205032e-11, 6.16482143e-11,
       5.33132254e-11, 1.27810757e-11, 1.71790152e-11, 5.61647534e-11,
       2.57353930e-11, 9.97394268e-12, 2.33259904e-11, 1.42741296e-11,
       1.57949591e-11, 2.02788463e-11, 1.77293735e-11, 2.54098669e-11,
       9.64293402e-12, 8.74314249e-12, 1.14051659e-11, 9.92386468e-12,
       9.79088425e-12, 1.60335686e-11, 9.15038791e-12, 1.24934594e-11,
       1.78804957e-11, 1.23501435e-11, 1.47317054e-11, 1.85107173e-11,
       1.37886751e-11, 8.45183645e-12, 1.66086988e-11, 1.21529687e-11,
       9.00764793e-12, 7.56969227e-12, 4.29442202e-12, 3.71187239e-12,
       4.33188598e-12, 6.65464298e-12, 5.66181867e-12, 2.69454576e-12,
       1.26949475e-11, 2.16301499e-12, 8.48096853e-12, 3.27938544e-12,
       2.83456592e-12, 3.37848483e-13, 1.96454767e-12, 9.72460502e-13,
       7.02217798e-12, 2.63554781e-12, 3.98134607e-12, 6.27104401e-12,
       2.93749790e-12, 5.25232071e-12, 5.91431548e-12, 4.59191582e-12,
       3.68801951e-12, 7.95821742e-12, 3.18839269e-12, 1.52436364e-12,
       7.86437213e-13, 5.40045396e-12, 4.85991022e-12, 1.35130242e-12,
       3.22990441e-12, 9.13835327e-12, 1.11872100e-12, 4.79155084e-12,
       1.41005870e-12, 1.90729637e-12, 9.55118580e-13, 7.49551029e-13,
       1.42201821e-12, 5.08617942e-13, 2.07763732e-12, 4.49988918e-12,
       2.34668578e-12, 2.20746945e-12, 3.37527250e-12, 3.68973602e-12,
       3.26247818e-12, 2.05130639e-12, 4.52163003e-12, 1.10103864e-12,
       6.88967709e-13, 2.28098530e-12, 1.40431503e-12, 3.83797725e-12,
       3.68007924e-12, 6.17159210e-13, 1.94063450e-12, 4.50213597e-13,
       3.44575686e-13, 4.52310281e-13, 3.69307151e-13, 1.22063232e-12,
       1.23314716e-12, 7.44108171e-13, 7.89438447e-13, 1.05738519e-12,
       2.42631371e-12, 1.15079929e-12, 7.76750300e-13, 9.99894720e-13,
       1.06828945e-12, 2.09103771e-13, 1.89248617e-12, 2.98187343e-12,
       4.84077622e-13, 8.48049048e-14, 2.96002724e-13, 2.90453772e-12,
       5.94359035e-13, 7.77854831e-13, 5.10057654e-13, 3.81792634e-13,
       1.61933444e-12, 1.19591414e-12, 3.85386411e-13, 3.23265151e-13,
       1.37171080e-12, 1.20327468e-12, 2.30335092e-13, 1.94585586e-13,
       2.96761509e-12, 4.53130849e-12, 2.41281040e-12, 3.22674396e-13,
       2.65577274e-12, 1.24684573e-12, 2.14584253e-12, 3.80704772e-13,
       2.93826405e-13, 5.63826926e-13, 1.86721927e-12, 1.25340049e-12,
       1.43993899e-12, 1.11951713e-12, 1.13988311e-12, 4.42910004e-13,
       3.43921723e-13, 2.62937198e-12, 1.22333599e-12, 9.42486581e-14,
       3.87740648e-13, 1.49363364e-13, 1.55126807e-13, 9.54148110e-13,
       2.38284522e-12, 7.59126052e-13, 1.05225084e-12, 9.48841483e-13,
       9.31703933e-13, 3.97113603e-13, 1.55931984e-12, 3.82533225e-13,
       2.27655080e-13, 5.96139295e-13, 3.87133197e-13, 2.35014395e-12,
       7.29470534e-14, 3.98105567e-13, 1.29361867e-13, 8.06911829e-13,
       4.89972483e-13, 2.33144911e-13, 7.47321259e-13, 5.16754608e-13,
       2.33671128e-13, 3.52463935e-13, 9.16428608e-13, 1.43673945e-13,
       2.18156331e-13, 4.05265855e-13, 6.47594500e-13, 3.57948886e-13,
       1.44784846e-12, 2.66108663e-12, 6.45525137e-13, 9.14684019e-13,
       8.84297315e-14, 1.08111718e-12, 8.99963562e-14, 3.31605349e-13,
       1.12357736e-12, 1.51786407e-13, 8.85479244e-13, 9.26384403e-13,
       5.45644191e-14, 5.00812770e-13, 3.94700752e-14, 1.46867533e-12,
       1.78933393e-13, 8.77157979e-14, 5.33377867e-13, 1.45806829e-13,
       5.80958214e-14, 3.73811361e-14, 5.50493841e-13, 2.90159064e-13,
       3.54666410e-13, 1.64788756e-12, 3.51937256e-13, 1.73403379e-13,
       7.82847975e-14, 5.62456067e-14, 1.11100419e-12, 2.65112530e-13,
       4.40329143e-13, 3.57492410e-13, 4.54518178e-13, 4.77271326e-13,
       1.49517565e-13, 8.39619064e-13, 2.46997545e-13, 5.98048033e-13,
       3.98978241e-13, 6.55212782e-14, 1.26487701e-13, 4.81655406e-13,
       7.19482491e-15, 2.48719312e-13, 7.87074995e-13, 3.91277722e-13,
       1.16363418e-12, 1.47218595e-13, 4.05121120e-14, 1.93313410e-13,
       6.57879187e-13, 2.37390294e-13, 7.47312300e-14, 2.33224057e-13,
       1.12027976e-12, 1.45204039e-13, 1.16573512e-13, 1.04037418e-13,
       1.75751517e-13, 2.86664715e-14, 1.28970402e-13, 9.52378011e-15,
       1.16901267e-13, 5.83818543e-14, 1.81851138e-12, 1.01660791e-12,
       2.41763234e-13, 5.60573249e-14, 4.62632211e-13, 8.02422229e-14,
       2.01050954e-13, 4.97553421e-14, 3.14956699e-14, 4.01829909e-13,
       4.81319696e-15, 7.94460526e-14, 1.42638275e-13, 6.12099211e-14,
       4.72124747e-14, 7.83102261e-13, 1.81449738e-14, 9.62315419e-14,
       2.26856647e-13, 3.42917562e-13, 3.40097769e-13, 1.21772967e-13,
       2.45875558e-13, 4.50288326e-13, 3.67947372e-13, 4.22105656e-13,
       2.33207605e-13, 8.72782207e-14, 4.18562652e-14, 6.24398374e-13,
       1.37558246e-13, 2.02806725e-14, 1.07608251e-13, 1.51681930e-13,
       1.90950120e-13, 1.03976710e-13, 1.57692964e-13, 2.07179529e-13,
       9.53088994e-14, 2.78997474e-13, 1.65371799e-13, 3.38814507e-13,
       1.41250482e-13, 5.38918106e-14, 3.89743332e-13, 1.23740460e-12,
       4.77361172e-14, 3.96572220e-14, 6.91320983e-14, 5.52754626e-14,
       3.17837255e-13, 8.48693511e-13, 5.81367230e-14, 2.35400417e-14,
       5.69871434e-14, 3.50709452e-14, 5.05568081e-14, 1.99903042e-13,
       1.27801849e-13, 1.57840931e-14, 7.79810854e-14, 1.55176741e-14,
       1.06173988e-13, 2.45416277e-14, 1.15691419e-14, 2.01195180e-13,
       1.76204320e-13, 1.38259521e-13, 1.02557001e-13, 1.07357116e-13,
       1.52999344e-13, 1.96251313e-13, 2.24382673e-13, 9.61388968e-14,
       4.19897203e-14, 2.35637708e-13, 1.57623412e-14, 2.67780471e-14,
       2.02901620e-13, 3.00067696e-13, 1.93580910e-13, 1.21501049e-13,
       2.55136098e-14, 2.50484122e-13, 2.89162384e-13, 7.73251024e-14,
       5.74181070e-14, 3.47237159e-13, 4.70413266e-14, 3.74228182e-13,
       2.18118058e-13, 4.67947858e-14, 4.54611595e-14, 1.59384211e-13,
       4.10214126e-14, 5.70375995e-14, 3.65385619e-13, 2.84236441e-14,
       1.37561918e-13, 1.20494150e-13, 3.96368051e-14, 4.33393962e-14,
       1.32556970e-13, 2.93168078e-13, 1.88104483e-13, 1.32377833e-13,
       6.27676960e-14, 2.85504232e-13, 1.62526852e-13, 5.12325303e-14,
       8.34180205e-14, 4.21680581e-14, 9.06520545e-14, 4.22459851e-14,
       5.69105386e-15, 3.21057959e-13, 1.60362649e-14, 6.86180510e-14,
       1.33638922e-13, 5.40670448e-14, 3.56642951e-14, 5.10096319e-14,
       1.26971865e-13, 2.33500810e-14, 3.31924091e-14, 5.88774702e-14,
       2.37236852e-13, 1.29794814e-14, 3.60300880e-14, 8.37886076e-14,
       9.55101680e-14, 9.54611298e-15, 3.91049416e-13, 3.79438133e-14,
       2.80386608e-13, 1.16706935e-14, 1.94427550e-13, 1.27029938e-14,
       4.56099358e-14, 2.38833611e-13, 8.23660123e-14, 5.70306402e-14,
       5.45481866e-14, 6.74526786e-13, 5.27040163e-13, 1.25606279e-14,
       2.96623145e-14, 2.40302553e-14, 5.47752626e-14, 2.47581957e-13,
       1.64786702e-14, 1.59539232e-14, 1.70863229e-13, 1.57157815e-14,
       5.62333004e-13, 2.23166568e-14, 8.89875738e-14, 2.12240249e-14,
       2.03265342e-13, 5.12636130e-14, 1.93380790e-14, 4.20942069e-14,
       2.14354952e-14, 1.65023228e-14, 6.63041196e-14, 5.20919291e-15,
       1.05984808e-13, 3.07848148e-13, 2.56938110e-14, 1.86047453e-13,
       2.92103513e-14, 1.98276183e-14, 4.57962444e-13, 1.42109821e-13,
       1.50802670e-13, 2.43948996e-14, 8.88842697e-14, 2.40110581e-14,
       1.36327166e-14, 9.79296600e-14, 4.13689401e-14, 3.43642859e-14,
       4.86642620e-14, 1.21612281e-14, 9.62100679e-14, 1.34098529e-13,
       3.28550494e-14, 9.51318221e-14, 4.58686027e-14, 5.22059440e-14,
       2.38147074e-14, 6.07227798e-15, 8.84273733e-14, 3.99970076e-14,
       1.44586830e-14, 2.27762230e-14, 1.45775685e-13, 5.91362151e-14,
       5.58877895e-14, 1.96098546e-14, 3.75282318e-14, 3.32439832e-14,
       2.10750227e-13, 5.28183081e-14, 4.25885320e-14, 1.33494154e-14,
       2.26020374e-14, 7.63035993e-15, 2.63170731e-14, 2.44794504e-14,
       2.37321352e-14, 1.42497081e-14, 1.24670714e-13, 9.19851760e-14,
       4.98143092e-14, 1.17501639e-14, 2.38549398e-14, 9.63347512e-14,
       9.17355046e-14, 4.41380839e-14, 4.82444048e-14, 1.18399336e-13,
       2.25979429e-14, 3.43292357e-14, 6.91711364e-14, 1.75775244e-14,
       6.19710311e-14, 2.55335202e-14, 3.74470935e-13, 1.19634637e-14,
       4.89128154e-14, 2.40185239e-14, 6.23710068e-14, 2.27075151e-14,
       1.03090203e-14, 4.10911065e-14, 4.00357238e-13, 3.80890523e-14,
       3.30070545e-14, 2.06903400e-14, 2.55568102e-14, 6.58968932e-14,
       2.27918253e-14, 3.24580349e-14, 2.51076642e-14, 7.18539269e-14,
       6.59496676e-15, 1.36541855e-14, 8.43808869e-14, 1.67478793e-14,
       4.71749376e-14, 4.80205814e-14, 8.61165658e-14, 2.71472874e-14,
       3.25278812e-14, 1.35068077e-13, 5.88113610e-14, 1.07336232e-13,
       2.08020856e-14, 8.84300279e-15, 2.93886789e-14, 6.58047022e-14,
       2.17679065e-14, 5.98539569e-14, 2.31957821e-14, 1.14014348e-13,
       1.88758514e-14, 1.76320886e-14, 1.27366257e-13, 1.47880514e-13,
       9.51249238e-14, 4.74620309e-14, 2.45487445e-14, 7.69615220e-14,
       1.37372286e-14, 4.26854698e-14, 6.42141640e-14, 1.62995228e-14,
       9.66877691e-15, 1.34842258e-14, 1.33261381e-14, 1.53444355e-14,
       3.07420241e-14, 5.13664801e-14, 3.06242729e-14, 7.63797933e-14,
       1.41002237e-14, 2.36599562e-14, 1.79910001e-14, 1.28677197e-14,
       2.86520380e-14, 2.05303439e-14, 2.11555203e-14, 4.79555055e-14,
       2.43711925e-13, 2.17403135e-14, 6.09367564e-14, 9.80436706e-14,
       3.13709663e-14, 1.02216565e-14, 2.05185210e-14, 1.40260567e-14,
       3.36123815e-14, 3.54178831e-14, 2.02771912e-14, 2.36781945e-14,
       4.21034396e-14, 4.14148086e-14, 9.55551251e-15, 2.17082432e-14,
       2.02675524e-15, 1.67715901e-15, 2.53530412e-14, 1.50110705e-14,
       9.21282331e-15, 1.73115459e-14, 1.86606390e-14, 7.34427981e-14,
       6.19164144e-15, 8.80982502e-14, 3.65329681e-14, 1.07526123e-14,
       1.59770675e-14, 6.04321077e-14, 1.98011621e-14, 7.21970650e-15,
       6.34606867e-15, 4.63847524e-15, 9.34174680e-15, 1.09901759e-13,
       2.32550100e-14, 1.38937518e-14, 4.90704550e-14, 1.60373661e-14,
       1.24771036e-14, 6.97011215e-15, 7.32639928e-14, 4.06113741e-14,
       1.89575108e-13, 1.32640862e-14, 8.31262126e-15, 2.25941075e-14,
       3.59356506e-14, 2.26262795e-14, 5.81450442e-14, 1.56447511e-14],
      dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[723]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[723]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(118371, 600)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generating-new-text">Generating new text<a class="anchor-link" href="#Generating-new-text">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's define a function that accepts a word, convert it to its one-hot representation, predicts the following word using the trained model, and finally convert the predicted one-hot result into a text and returns it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[724]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_next</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">token</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">vocabulary</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Predicts the following word, given a text word, a tokenizer to convert it to 1-hot vector, a trained model and a vocabulary</span>
<span class="sd">    with word and index representations&#39;&#39;&#39;</span>
    <span class="c1">#converting the word to 1-hot matrix represenation</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">text_to_word_sequence</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">texts_to_matrix</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="c1">#predicting next word</span>
    <span class="n">bestMatch</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">vocabulary</span><span class="p">[</span><span class="n">vocabulary</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">bestMatch</span><span class="p">][</span><span class="s1">&#39;word&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now use this function, together with some saved parameters from the preprocessing phase, to predict the next word:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[739]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_next</span><span class="p">(</span><span class="s2">&quot;say&quot;</span><span class="p">,</span><span class="n">token</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[739]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;to&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[741]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_next</span><span class="p">(</span><span class="s2">&quot;did&quot;</span><span class="p">,</span><span class="n">token</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[741]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;not&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's try another model. This time we also use a RNN layer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recurrent-Neural-Network">Recurrent Neural Network<a class="anchor-link" href="#Recurrent-Neural-Network">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's use <strong>SimpleRNN</strong> to add a fully-connected RNN where the output is to be fed back to input.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[742]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.layers.recurrent</span> <span class="k">import</span> <span class="n">SimpleRNN</span>
<span class="n">n_hidden</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_fac</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span> <span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_dim</span><span class="o">=</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">inner_init</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="n">output_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\ipykernel\__main__.py:6: UserWarning: Update your `SimpleRNN` call to the Keras 2 API: `SimpleRNN(256, recurrent_initializer=&#34;identity&#34;, activation=&#34;relu&#34;)`
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[743]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">line_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>____________________________________________________________________________________________________
Layer (type)                                 Output Shape                            Param #        
====================================================================================================
embedding_29 (Embedding)                     (None, 600, 42)                         25200          
____________________________________________________________________________________________________
simple_rnn_45 (SimpleRNN)                    (None, 256)                             76544          
____________________________________________________________________________________________________
dense_92 (Dense)                             (None, 600)                             154200         
====================================================================================================
Total params: 255,944
Trainable params: 255,944
Non-trainable params: 0
____________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compile the model and fit it to the data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[745]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">output_</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\models.py:939: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  max_q_size: maximum size for the generator queue
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 94696 samples, validate on 23675 samples
Epoch 1/5
  300/94696 [..............................] - ETA: 12:11 - loss: 11.1382 - acc: 0.0000e+00  600/94696 [..............................] - ETA: 11:33 - loss: nan - acc: 0.1150          900/94696 [..............................] - ETA: 11:08 - loss: nan - acc: 0.1511 1200/94696 [..............................] - ETA: 10:53 - loss: nan - acc: 0.1742 1500/94696 [..............................] - ETA: 10:44 - loss: nan - acc: 0.1927 1800/94696 [..............................] - ETA: 10:35 - loss: nan - acc: 0.1961 2100/94696 [..............................] - ETA: 10:27 - loss: nan - acc: 0.2005 2400/94696 [..............................] - ETA: 10:24 - loss: nan - acc: 0.2063 2700/94696 [..............................] - ETA: 10:19 - loss: nan - acc: 0.2067 3000/94696 [..............................] - ETA: 10:15 - loss: nan - acc: 0.2093 3300/94696 [&gt;.............................] - ETA: 10:13 - loss: nan - acc: 0.2136 3600/94696 [&gt;.............................] - ETA: 10:09 - loss: nan - acc: 0.2164 3900/94696 [&gt;.............................] - ETA: 10:08 - loss: nan - acc: 0.2174 4200/94696 [&gt;.............................] - ETA: 10:05 - loss: nan - acc: 0.2198 4500/94696 [&gt;.............................] - ETA: 10:03 - loss: nan - acc: 0.2184 4800/94696 [&gt;.............................] - ETA: 10:00 - loss: nan - acc: 0.2177 5100/94696 [&gt;.............................] - ETA: 9:59 - loss: nan - acc: 0.2206  5400/94696 [&gt;.............................] - ETA: 9:57 - loss: nan - acc: 0.2202 5700/94696 [&gt;.............................] - ETA: 9:56 - loss: nan - acc: 0.2214 6000/94696 [&gt;.............................] - ETA: 9:53 - loss: nan - acc: 0.2230 6300/94696 [&gt;.............................] - ETA: 9:52 - loss: nan - acc: 0.2232 6600/94696 [=&gt;............................] - ETA: 9:50 - loss: nan - acc: 0.2230 6900/94696 [=&gt;............................] - ETA: 9:47 - loss: nan - acc: 0.2236 7200/94696 [=&gt;............................] - ETA: 9:46 - loss: nan - acc: 0.2215 7500/94696 [=&gt;............................] - ETA: 9:44 - loss: nan - acc: 0.2213 7800/94696 [=&gt;............................] - ETA: 9:42 - loss: nan - acc: 0.2212 8100/94696 [=&gt;............................] - ETA: 9:40 - loss: nan - acc: 0.2220 8400/94696 [=&gt;............................] - ETA: 9:39 - loss: nan - acc: 0.2230 8700/94696 [=&gt;............................] - ETA: 9:37 - loss: nan - acc: 0.2236 9000/94696 [=&gt;............................] - ETA: 9:35 - loss: nan - acc: 0.2238 9300/94696 [=&gt;............................] - ETA: 9:33 - loss: nan - acc: 0.2241 9600/94696 [==&gt;...........................] - ETA: 9:31 - loss: nan - acc: 0.2236 9900/94696 [==&gt;...........................] - ETA: 9:29 - loss: nan - acc: 0.224610200/94696 [==&gt;...........................] - ETA: 9:26 - loss: nan - acc: 0.223610500/94696 [==&gt;...........................] - ETA: 9:25 - loss: nan - acc: 0.222910800/94696 [==&gt;...........................] - ETA: 9:22 - loss: nan - acc: 0.223011100/94696 [==&gt;...........................] - ETA: 9:20 - loss: nan - acc: 0.222411400/94696 [==&gt;...........................] - ETA: 9:18 - loss: nan - acc: 0.221911700/94696 [==&gt;...........................] - ETA: 9:16 - loss: nan - acc: 0.221312000/94696 [==&gt;...........................] - ETA: 9:14 - loss: nan - acc: 0.221512300/94696 [==&gt;...........................] - ETA: 9:12 - loss: nan - acc: 0.220612600/94696 [==&gt;...........................] - ETA: 9:10 - loss: nan - acc: 0.220812900/94696 [===&gt;..........................] - ETA: 9:08 - loss: nan - acc: 0.220813200/94696 [===&gt;..........................] - ETA: 9:08 - loss: nan - acc: 0.221113500/94696 [===&gt;..........................] - ETA: 9:07 - loss: nan - acc: 0.221313800/94696 [===&gt;..........................] - ETA: 9:07 - loss: nan - acc: 0.221214100/94696 [===&gt;..........................] - ETA: 9:05 - loss: nan - acc: 0.220914400/94696 [===&gt;..........................] - ETA: 9:04 - loss: nan - acc: 0.221114700/94696 [===&gt;..........................] - ETA: 9:02 - loss: nan - acc: 0.220815000/94696 [===&gt;..........................] - ETA: 9:00 - loss: nan - acc: 0.220515300/94696 [===&gt;..........................] - ETA: 8:58 - loss: nan - acc: 0.220815600/94696 [===&gt;..........................] - ETA: 8:56 - loss: nan - acc: 0.220815900/94696 [====&gt;.........................] - ETA: 8:54 - loss: nan - acc: 0.221416200/94696 [====&gt;.........................] - ETA: 8:52 - loss: nan - acc: 0.221916500/94696 [====&gt;.........................] - ETA: 8:50 - loss: nan - acc: 0.221916800/94696 [====&gt;.........................] - ETA: 8:49 - loss: nan - acc: 0.221817100/94696 [====&gt;.........................] - ETA: 8:47 - loss: nan - acc: 0.221617400/94696 [====&gt;.........................] - ETA: 8:46 - loss: nan - acc: 0.222417700/94696 [====&gt;.........................] - ETA: 8:44 - loss: nan - acc: 0.222718000/94696 [====&gt;.........................] - ETA: 8:42 - loss: nan - acc: 0.222418300/94696 [====&gt;.........................] - ETA: 8:40 - loss: nan - acc: 0.222318600/94696 [====&gt;.........................] - ETA: 8:38 - loss: nan - acc: 0.222418900/94696 [====&gt;.........................] - ETA: 8:36 - loss: nan - acc: 0.222419200/94696 [=====&gt;........................] - ETA: 8:34 - loss: nan - acc: 0.222219500/94696 [=====&gt;........................] - ETA: 8:33 - loss: nan - acc: 0.221819800/94696 [=====&gt;........................] - ETA: 8:31 - loss: nan - acc: 0.221820100/94696 [=====&gt;........................] - ETA: 8:29 - loss: nan - acc: 0.221820400/94696 [=====&gt;........................] - ETA: 8:27 - loss: nan - acc: 0.221420700/94696 [=====&gt;........................] - ETA: 8:25 - loss: nan - acc: 0.221221000/94696 [=====&gt;........................] - ETA: 8:23 - loss: nan - acc: 0.221221300/94696 [=====&gt;........................] - ETA: 8:21 - loss: nan - acc: 0.221521600/94696 [=====&gt;........................] - ETA: 8:19 - loss: nan - acc: 0.221621900/94696 [=====&gt;........................] - ETA: 8:17 - loss: nan - acc: 0.221822200/94696 [======&gt;.......................] - ETA: 8:16 - loss: nan - acc: 0.222222500/94696 [======&gt;.......................] - ETA: 8:14 - loss: nan - acc: 0.221822800/94696 [======&gt;.......................] - ETA: 8:12 - loss: nan - acc: 0.221323100/94696 [======&gt;.......................] - ETA: 8:10 - loss: nan - acc: 0.221323400/94696 [======&gt;.......................] - ETA: 8:08 - loss: nan - acc: 0.221423700/94696 [======&gt;.......................] - ETA: 8:06 - loss: nan - acc: 0.221524000/94696 [======&gt;.......................] - ETA: 8:04 - loss: nan - acc: 0.221124300/94696 [======&gt;.......................] - ETA: 8:02 - loss: nan - acc: 0.221024600/94696 [======&gt;.......................] - ETA: 8:00 - loss: nan - acc: 0.220824900/94696 [======&gt;.......................] - ETA: 7:58 - loss: nan - acc: 0.220225200/94696 [======&gt;.......................] - ETA: 7:56 - loss: nan - acc: 0.220325500/94696 [=======&gt;......................] - ETA: 7:54 - loss: nan - acc: 0.220225800/94696 [=======&gt;......................] - ETA: 7:52 - loss: nan - acc: 0.220126100/94696 [=======&gt;......................] - ETA: 7:51 - loss: nan - acc: 0.220126400/94696 [=======&gt;......................] - ETA: 7:49 - loss: nan - acc: 0.220026700/94696 [=======&gt;......................] - ETA: 7:47 - loss: nan - acc: 0.220527000/94696 [=======&gt;......................] - ETA: 7:45 - loss: nan - acc: 0.220227300/94696 [=======&gt;......................] - ETA: 7:43 - loss: nan - acc: 0.220427600/94696 [=======&gt;......................] - ETA: 7:41 - loss: nan - acc: 0.220327900/94696 [=======&gt;......................] - ETA: 7:39 - loss: nan - acc: 0.220728200/94696 [=======&gt;......................] - ETA: 7:37 - loss: nan - acc: 0.221028500/94696 [========&gt;.....................] - ETA: 7:36 - loss: nan - acc: 0.220928800/94696 [========&gt;.....................] - ETA: 7:34 - loss: nan - acc: 0.220829100/94696 [========&gt;.....................] - ETA: 7:32 - loss: nan - acc: 0.220829400/94696 [========&gt;.....................] - ETA: 7:30 - loss: nan - acc: 0.221029700/94696 [========&gt;.....................] - ETA: 7:28 - loss: nan - acc: 0.220930000/94696 [========&gt;.....................] - ETA: 7:26 - loss: nan - acc: 0.221230300/94696 [========&gt;.....................] - ETA: 7:24 - loss: nan - acc: 0.221030600/94696 [========&gt;.....................] - ETA: 7:22 - loss: nan - acc: 0.220930900/94696 [========&gt;.....................] - ETA: 7:20 - loss: nan - acc: 0.220731200/94696 [========&gt;.....................] - ETA: 7:18 - loss: nan - acc: 0.220631500/94696 [========&gt;.....................] - ETA: 7:16 - loss: nan - acc: 0.220331800/94696 [=========&gt;....................] - ETA: 7:14 - loss: nan - acc: 0.220632100/94696 [=========&gt;....................] - ETA: 7:13 - loss: nan - acc: 0.220632400/94696 [=========&gt;....................] - ETA: 7:10 - loss: nan - acc: 0.220732700/94696 [=========&gt;....................] - ETA: 7:09 - loss: nan - acc: 0.220933000/94696 [=========&gt;....................] - ETA: 7:07 - loss: nan - acc: 0.220833300/94696 [=========&gt;....................] - ETA: 7:05 - loss: nan - acc: 0.220733600/94696 [=========&gt;....................] - ETA: 7:03 - loss: nan - acc: 0.220633900/94696 [=========&gt;....................] - ETA: 7:01 - loss: nan - acc: 0.220534200/94696 [=========&gt;....................] - ETA: 6:59 - loss: nan - acc: 0.220734500/94696 [=========&gt;....................] - ETA: 6:58 - loss: nan - acc: 0.220334800/94696 [==========&gt;...................] - ETA: 6:56 - loss: nan - acc: 0.220135100/94696 [==========&gt;...................] - ETA: 6:54 - loss: nan - acc: 0.219935400/94696 [==========&gt;...................] - ETA: 6:52 - loss: nan - acc: 0.220235700/94696 [==========&gt;...................] - ETA: 6:50 - loss: nan - acc: 0.220336000/94696 [==========&gt;...................] - ETA: 6:48 - loss: nan - acc: 0.220036300/94696 [==========&gt;...................] - ETA: 6:46 - loss: nan - acc: 0.219836600/94696 [==========&gt;...................] - ETA: 6:44 - loss: nan - acc: 0.219836900/94696 [==========&gt;...................] - ETA: 6:43 - loss: nan - acc: 0.219737200/94696 [==========&gt;...................] - ETA: 6:41 - loss: nan - acc: 0.219537500/94696 [==========&gt;...................] - ETA: 6:39 - loss: nan - acc: 0.219637800/94696 [==========&gt;...................] - ETA: 6:37 - loss: nan - acc: 0.219338100/94696 [===========&gt;..................] - ETA: 6:35 - loss: nan - acc: 0.219138400/94696 [===========&gt;..................] - ETA: 6:33 - loss: nan - acc: 0.219138700/94696 [===========&gt;..................] - ETA: 6:31 - loss: nan - acc: 0.219139000/94696 [===========&gt;..................] - ETA: 6:29 - loss: nan - acc: 0.219139300/94696 [===========&gt;..................] - ETA: 6:27 - loss: nan - acc: 0.219339600/94696 [===========&gt;..................] - ETA: 6:25 - loss: nan - acc: 0.219539900/94696 [===========&gt;..................] - ETA: 6:23 - loss: nan - acc: 0.219540200/94696 [===========&gt;..................] - ETA: 6:21 - loss: nan - acc: 0.219240500/94696 [===========&gt;..................] - ETA: 6:19 - loss: nan - acc: 0.219140800/94696 [===========&gt;..................] - ETA: 6:17 - loss: nan - acc: 0.219041100/94696 [============&gt;.................] - ETA: 6:15 - loss: nan - acc: 0.218841400/94696 [============&gt;.................] - ETA: 6:13 - loss: nan - acc: 0.219041700/94696 [============&gt;.................] - ETA: 6:11 - loss: nan - acc: 0.219242000/94696 [============&gt;.................] - ETA: 6:09 - loss: nan - acc: 0.219042300/94696 [============&gt;.................] - ETA: 6:07 - loss: nan - acc: 0.219242600/94696 [============&gt;.................] - ETA: 6:05 - loss: nan - acc: 0.219142900/94696 [============&gt;.................] - ETA: 6:03 - loss: nan - acc: 0.219243200/94696 [============&gt;.................] - ETA: 6:01 - loss: nan - acc: 0.219343500/94696 [============&gt;.................] - ETA: 5:59 - loss: nan - acc: 0.219243800/94696 [============&gt;.................] - ETA: 5:57 - loss: nan - acc: 0.219544100/94696 [============&gt;.................] - ETA: 5:55 - loss: nan - acc: 0.219544400/94696 [=============&gt;................] - ETA: 5:53 - loss: nan - acc: 0.219744700/94696 [=============&gt;................] - ETA: 5:51 - loss: nan - acc: 0.219645000/94696 [=============&gt;................] - ETA: 5:49 - loss: nan - acc: 0.219645300/94696 [=============&gt;................] - ETA: 5:47 - loss: nan - acc: 0.219945600/94696 [=============&gt;................] - ETA: 5:45 - loss: nan - acc: 0.219845900/94696 [=============&gt;................] - ETA: 5:43 - loss: nan - acc: 0.220046200/94696 [=============&gt;................] - ETA: 5:41 - loss: nan - acc: 0.220046500/94696 [=============&gt;................] - ETA: 5:39 - loss: nan - acc: 0.220046800/94696 [=============&gt;................] - ETA: 5:37 - loss: nan - acc: 0.220147100/94696 [=============&gt;................] - ETA: 5:35 - loss: nan - acc: 0.220447400/94696 [==============&gt;...............] - ETA: 5:33 - loss: nan - acc: 0.220447700/94696 [==============&gt;...............] - ETA: 5:31 - loss: nan - acc: 0.220348000/94696 [==============&gt;...............] - ETA: 5:29 - loss: nan - acc: 0.220248300/94696 [==============&gt;...............] - ETA: 5:27 - loss: nan - acc: 0.220548600/94696 [==============&gt;...............] - ETA: 5:25 - loss: nan - acc: 0.220448900/94696 [==============&gt;...............] - ETA: 5:23 - loss: nan - acc: 0.220549200/94696 [==============&gt;...............] - ETA: 5:21 - loss: nan - acc: 0.220649500/94696 [==============&gt;...............] - ETA: 5:19 - loss: nan - acc: 0.220849800/94696 [==============&gt;...............] - ETA: 5:17 - loss: nan - acc: 0.221050100/94696 [==============&gt;...............] - ETA: 5:15 - loss: nan - acc: 0.220950400/94696 [==============&gt;...............] - ETA: 5:13 - loss: nan - acc: 0.221050700/94696 [===============&gt;..............] - ETA: 5:11 - loss: nan - acc: 0.221051000/94696 [===============&gt;..............] - ETA: 5:09 - loss: nan - acc: 0.221051300/94696 [===============&gt;..............] - ETA: 5:07 - loss: nan - acc: 0.221051600/94696 [===============&gt;..............] - ETA: 5:05 - loss: nan - acc: 0.221051900/94696 [===============&gt;..............] - ETA: 5:03 - loss: nan - acc: 0.221452200/94696 [===============&gt;..............] - ETA: 5:01 - loss: nan - acc: 0.221552500/94696 [===============&gt;..............] - ETA: 4:59 - loss: nan - acc: 0.221752800/94696 [===============&gt;..............] - ETA: 4:57 - loss: nan - acc: 0.221553100/94696 [===============&gt;..............] - ETA: 4:55 - loss: nan - acc: 0.221553400/94696 [===============&gt;..............] - ETA: 4:53 - loss: nan - acc: 0.221353700/94696 [================&gt;.............] - ETA: 4:51 - loss: nan - acc: 0.221354000/94696 [================&gt;.............] - ETA: 4:49 - loss: nan - acc: 0.221354300/94696 [================&gt;.............] - ETA: 4:47 - loss: nan - acc: 0.221354600/94696 [================&gt;.............] - ETA: 4:45 - loss: nan - acc: 0.221654900/94696 [================&gt;.............] - ETA: 4:43 - loss: nan - acc: 0.221655200/94696 [================&gt;.............] - ETA: 4:40 - loss: nan - acc: 0.221655500/94696 [================&gt;.............] - ETA: 4:38 - loss: nan - acc: 0.221655800/94696 [================&gt;.............] - ETA: 4:36 - loss: nan - acc: 0.221456100/94696 [================&gt;.............] - ETA: 4:34 - loss: nan - acc: 0.221456400/94696 [================&gt;.............] - ETA: 4:32 - loss: nan - acc: 0.221256700/94696 [================&gt;.............] - ETA: 4:30 - loss: nan - acc: 0.221257000/94696 [=================&gt;............] - ETA: 4:28 - loss: nan - acc: 0.221557300/94696 [=================&gt;............] - ETA: 4:26 - loss: nan - acc: 0.221857600/94696 [=================&gt;............] - ETA: 4:24 - loss: nan - acc: 0.222057900/94696 [=================&gt;............] - ETA: 4:22 - loss: nan - acc: 0.222158200/94696 [=================&gt;............] - ETA: 4:20 - loss: nan - acc: 0.222358500/94696 [=================&gt;............] - ETA: 4:18 - loss: nan - acc: 0.222558800/94696 [=================&gt;............] - ETA: 4:15 - loss: nan - acc: 0.222659100/94696 [=================&gt;............] - ETA: 4:13 - loss: nan - acc: 0.222759400/94696 [=================&gt;............] - ETA: 4:11 - loss: nan - acc: 0.222659700/94696 [=================&gt;............] - ETA: 4:09 - loss: nan - acc: 0.222460000/94696 [==================&gt;...........] - ETA: 4:07 - loss: nan - acc: 0.222660300/94696 [==================&gt;...........] - ETA: 4:05 - loss: nan - acc: 0.222460600/94696 [==================&gt;...........] - ETA: 4:03 - loss: nan - acc: 0.222560900/94696 [==================&gt;...........] - ETA: 4:01 - loss: nan - acc: 0.222561200/94696 [==================&gt;...........] - ETA: 3:59 - loss: nan - acc: 0.222461500/94696 [==================&gt;...........] - ETA: 3:57 - loss: nan - acc: 0.222361800/94696 [==================&gt;...........] - ETA: 3:55 - loss: nan - acc: 0.222662100/94696 [==================&gt;...........] - ETA: 3:53 - loss: nan - acc: 0.222762400/94696 [==================&gt;...........] - ETA: 3:50 - loss: nan - acc: 0.222762700/94696 [==================&gt;...........] - ETA: 3:48 - loss: nan - acc: 0.222763000/94696 [==================&gt;...........] - ETA: 3:46 - loss: nan - acc: 0.222863300/94696 [===================&gt;..........] - ETA: 3:44 - loss: nan - acc: 0.222863600/94696 [===================&gt;..........] - ETA: 3:42 - loss: nan - acc: 0.222863900/94696 [===================&gt;..........] - ETA: 3:40 - loss: nan - acc: 0.223064200/94696 [===================&gt;..........] - ETA: 3:38 - loss: nan - acc: 0.223064500/94696 [===================&gt;..........] - ETA: 3:36 - loss: nan - acc: 0.223364800/94696 [===================&gt;..........] - ETA: 3:34 - loss: nan - acc: 0.223465100/94696 [===================&gt;..........] - ETA: 3:31 - loss: nan - acc: 0.223365400/94696 [===================&gt;..........] - ETA: 3:29 - loss: nan - acc: 0.223465700/94696 [===================&gt;..........] - ETA: 3:27 - loss: nan - acc: 0.223466000/94696 [===================&gt;..........] - ETA: 3:25 - loss: nan - acc: 0.223266300/94696 [====================&gt;.........] - ETA: 3:23 - loss: nan - acc: 0.223266600/94696 [====================&gt;.........] - ETA: 3:21 - loss: nan - acc: 0.223566900/94696 [====================&gt;.........] - ETA: 3:19 - loss: nan - acc: 0.223467200/94696 [====================&gt;.........] - ETA: 3:17 - loss: nan - acc: 0.223367500/94696 [====================&gt;.........] - ETA: 3:15 - loss: nan - acc: 0.223567800/94696 [====================&gt;.........] - ETA: 3:13 - loss: nan - acc: 0.223468100/94696 [====================&gt;.........] - ETA: 3:10 - loss: nan - acc: 0.223568400/94696 [====================&gt;.........] - ETA: 3:08 - loss: nan - acc: 0.223668700/94696 [====================&gt;.........] - ETA: 3:06 - loss: nan - acc: 0.223869000/94696 [====================&gt;.........] - ETA: 3:04 - loss: nan - acc: 0.223769300/94696 [====================&gt;.........] - ETA: 3:02 - loss: nan - acc: 0.223969600/94696 [=====================&gt;........] - ETA: 3:00 - loss: nan - acc: 0.223869900/94696 [=====================&gt;........] - ETA: 2:58 - loss: nan - acc: 0.223970200/94696 [=====================&gt;........] - ETA: 2:56 - loss: nan - acc: 0.223970500/94696 [=====================&gt;........] - ETA: 2:53 - loss: nan - acc: 0.223970800/94696 [=====================&gt;........] - ETA: 2:51 - loss: nan - acc: 0.224071100/94696 [=====================&gt;........] - ETA: 2:49 - loss: nan - acc: 0.224171400/94696 [=====================&gt;........] - ETA: 2:47 - loss: nan - acc: 0.224171700/94696 [=====================&gt;........] - ETA: 2:45 - loss: nan - acc: 0.224272000/94696 [=====================&gt;........] - ETA: 2:43 - loss: nan - acc: 0.224172300/94696 [=====================&gt;........] - ETA: 2:41 - loss: nan - acc: 0.224272600/94696 [=====================&gt;........] - ETA: 2:39 - loss: nan - acc: 0.224172900/94696 [======================&gt;.......] - ETA: 2:36 - loss: nan - acc: 0.224273200/94696 [======================&gt;.......] - ETA: 2:34 - loss: nan - acc: 0.224173500/94696 [======================&gt;.......] - ETA: 2:32 - loss: nan - acc: 0.223973800/94696 [======================&gt;.......] - ETA: 2:30 - loss: nan - acc: 0.224074100/94696 [======================&gt;.......] - ETA: 2:28 - loss: nan - acc: 0.224174400/94696 [======================&gt;.......] - ETA: 2:26 - loss: nan - acc: 0.224274700/94696 [======================&gt;.......] - ETA: 2:24 - loss: nan - acc: 0.224375000/94696 [======================&gt;.......] - ETA: 2:21 - loss: nan - acc: 0.224375300/94696 [======================&gt;.......] - ETA: 2:19 - loss: nan - acc: 0.224175600/94696 [======================&gt;.......] - ETA: 2:17 - loss: nan - acc: 0.224175900/94696 [=======================&gt;......] - ETA: 2:15 - loss: nan - acc: 0.224176200/94696 [=======================&gt;......] - ETA: 2:13 - loss: nan - acc: 0.224276500/94696 [=======================&gt;......] - ETA: 2:11 - loss: nan - acc: 0.224376800/94696 [=======================&gt;......] - ETA: 2:09 - loss: nan - acc: 0.224377100/94696 [=======================&gt;......] - ETA: 2:06 - loss: nan - acc: 0.224277400/94696 [=======================&gt;......] - ETA: 2:04 - loss: nan - acc: 0.224377700/94696 [=======================&gt;......] - ETA: 2:02 - loss: nan - acc: 0.224378000/94696 [=======================&gt;......] - ETA: 2:00 - loss: nan - acc: 0.224378300/94696 [=======================&gt;......] - ETA: 1:58 - loss: nan - acc: 0.224478600/94696 [=======================&gt;......] - ETA: 1:56 - loss: nan - acc: 0.224578900/94696 [=======================&gt;......] - ETA: 1:54 - loss: nan - acc: 0.224679200/94696 [========================&gt;.....] - ETA: 1:51 - loss: nan - acc: 0.224579500/94696 [========================&gt;.....] - ETA: 1:49 - loss: nan - acc: 0.224579800/94696 [========================&gt;.....] - ETA: 1:47 - loss: nan - acc: 0.224580100/94696 [========================&gt;.....] - ETA: 1:45 - loss: nan - acc: 0.224580400/94696 [========================&gt;.....] - ETA: 1:43 - loss: nan - acc: 0.224580700/94696 [========================&gt;.....] - ETA: 1:41 - loss: nan - acc: 0.224481000/94696 [========================&gt;.....] - ETA: 1:39 - loss: nan - acc: 0.224581300/94696 [========================&gt;.....] - ETA: 1:36 - loss: nan - acc: 0.224481600/94696 [========================&gt;.....] - ETA: 1:34 - loss: nan - acc: 0.224581900/94696 [========================&gt;.....] - ETA: 1:32 - loss: nan - acc: 0.224682200/94696 [=========================&gt;....] - ETA: 1:30 - loss: nan - acc: 0.224682500/94696 [=========================&gt;....] - ETA: 1:28 - loss: nan - acc: 0.224682800/94696 [=========================&gt;....] - ETA: 1:26 - loss: nan - acc: 0.224483100/94696 [=========================&gt;....] - ETA: 1:23 - loss: nan - acc: 0.224583400/94696 [=========================&gt;....] - ETA: 1:21 - loss: nan - acc: 0.224583700/94696 [=========================&gt;....] - ETA: 1:19 - loss: nan - acc: 0.224684000/94696 [=========================&gt;....] - ETA: 1:17 - loss: nan - acc: 0.224684300/94696 [=========================&gt;....] - ETA: 1:15 - loss: nan - acc: 0.224784600/94696 [=========================&gt;....] - ETA: 1:13 - loss: nan - acc: 0.224784900/94696 [=========================&gt;....] - ETA: 1:10 - loss: nan - acc: 0.224885200/94696 [=========================&gt;....] - ETA: 1:08 - loss: nan - acc: 0.224885500/94696 [==========================&gt;...] - ETA: 1:06 - loss: nan - acc: 0.224885800/94696 [==========================&gt;...] - ETA: 1:04 - loss: nan - acc: 0.224886100/94696 [==========================&gt;...] - ETA: 1:02 - loss: nan - acc: 0.224986400/94696 [==========================&gt;...] - ETA: 1:00 - loss: nan - acc: 0.224786700/94696 [==========================&gt;...] - ETA: 57s - loss: nan - acc: 0.2248 87000/94696 [==========================&gt;...] - ETA: 55s - loss: nan - acc: 0.224987300/94696 [==========================&gt;...] - ETA: 53s - loss: nan - acc: 0.225087600/94696 [==========================&gt;...] - ETA: 51s - loss: nan - acc: 0.224987900/94696 [==========================&gt;...] - ETA: 49s - loss: nan - acc: 0.224988200/94696 [==========================&gt;...] - ETA: 47s - loss: nan - acc: 0.225088500/94696 [===========================&gt;..] - ETA: 44s - loss: nan - acc: 0.225188800/94696 [===========================&gt;..] - ETA: 42s - loss: nan - acc: 0.225189100/94696 [===========================&gt;..] - ETA: 40s - loss: nan - acc: 0.225189400/94696 [===========================&gt;..] - ETA: 38s - loss: nan - acc: 0.225289700/94696 [===========================&gt;..] - ETA: 36s - loss: nan - acc: 0.225390000/94696 [===========================&gt;..] - ETA: 34s - loss: nan - acc: 0.225490300/94696 [===========================&gt;..] - ETA: 31s - loss: nan - acc: 0.225590600/94696 [===========================&gt;..] - ETA: 29s - loss: nan - acc: 0.225790900/94696 [===========================&gt;..] - ETA: 27s - loss: nan - acc: 0.225791200/94696 [===========================&gt;..] - ETA: 25s - loss: nan - acc: 0.225791500/94696 [===========================&gt;..] - ETA: 23s - loss: nan - acc: 0.225691800/94696 [============================&gt;.] - ETA: 21s - loss: nan - acc: 0.225692100/94696 [============================&gt;.] - ETA: 18s - loss: nan - acc: 0.225592400/94696 [============================&gt;.] - ETA: 16s - loss: nan - acc: 0.225492700/94696 [============================&gt;.] - ETA: 14s - loss: nan - acc: 0.225393000/94696 [============================&gt;.] - ETA: 12s - loss: nan - acc: 0.225493300/94696 [============================&gt;.] - ETA: 10s - loss: nan - acc: 0.225493600/94696 [============================&gt;.] - ETA: 7s - loss: nan - acc: 0.2253 93900/94696 [============================&gt;.] - ETA: 5s - loss: nan - acc: 0.225394200/94696 [============================&gt;.] - ETA: 3s - loss: nan - acc: 0.225294500/94696 [============================&gt;.] - ETA: 1s - loss: nan - acc: 0.225294696/94696 [==============================] - 718s 8ms/step - loss: nan - acc: 0.2252 - val_loss: nan - val_acc: 0.2186
Epoch 2/5
  300/94696 [..............................] - ETA: 11:39 - loss: nan - acc: 0.2100  600/94696 [..............................] - ETA: 11:45 - loss: nan - acc: 0.2100  900/94696 [..............................] - ETA: 11:43 - loss: nan - acc: 0.2222 1200/94696 [..............................] - ETA: 11:39 - loss: nan - acc: 0.2150 1500/94696 [..............................] - ETA: 11:38 - loss: nan - acc: 0.2213 1800/94696 [..............................] - ETA: 11:37 - loss: nan - acc: 0.2283 2100/94696 [..............................] - ETA: 11:35 - loss: nan - acc: 0.2290 2400/94696 [..............................] - ETA: 11:32 - loss: nan - acc: 0.2283 2700/94696 [..............................] - ETA: 11:30 - loss: nan - acc: 0.2311 3000/94696 [..............................] - ETA: 11:29 - loss: nan - acc: 0.2297 3300/94696 [&gt;.............................] - ETA: 11:27 - loss: nan - acc: 0.2333 3600/94696 [&gt;.............................] - ETA: 11:25 - loss: nan - acc: 0.2336 3900/94696 [&gt;.............................] - ETA: 11:25 - loss: nan - acc: 0.2290 4200/94696 [&gt;.............................] - ETA: 11:23 - loss: nan - acc: 0.2295 4500/94696 [&gt;.............................] - ETA: 11:21 - loss: nan - acc: 0.2262 4800/94696 [&gt;.............................] - ETA: 11:18 - loss: nan - acc: 0.2240 5100/94696 [&gt;.............................] - ETA: 11:17 - loss: nan - acc: 0.2243 5400/94696 [&gt;.............................] - ETA: 11:16 - loss: nan - acc: 0.2237 5700/94696 [&gt;.............................] - ETA: 11:14 - loss: nan - acc: 0.2254 6000/94696 [&gt;.............................] - ETA: 11:11 - loss: nan - acc: 0.2273 6300/94696 [&gt;.............................] - ETA: 11:10 - loss: nan - acc: 0.2281 6600/94696 [=&gt;............................] - ETA: 11:07 - loss: nan - acc: 0.2277 6900/94696 [=&gt;............................] - ETA: 11:04 - loss: nan - acc: 0.2281 7200/94696 [=&gt;............................] - ETA: 11:02 - loss: nan - acc: 0.2267 7500/94696 [=&gt;............................] - ETA: 10:59 - loss: nan - acc: 0.2255 7800/94696 [=&gt;............................] - ETA: 10:57 - loss: nan - acc: 0.2276 8100/94696 [=&gt;............................] - ETA: 10:55 - loss: nan - acc: 0.2270 8400/94696 [=&gt;............................] - ETA: 10:53 - loss: nan - acc: 0.2262 8700/94696 [=&gt;............................] - ETA: 10:51 - loss: nan - acc: 0.2252 9000/94696 [=&gt;............................] - ETA: 10:48 - loss: nan - acc: 0.2237 9300/94696 [=&gt;............................] - ETA: 10:46 - loss: nan - acc: 0.2240 9600/94696 [==&gt;...........................] - ETA: 10:44 - loss: nan - acc: 0.2237 9900/94696 [==&gt;...........................] - ETA: 10:42 - loss: nan - acc: 0.224010200/94696 [==&gt;...........................] - ETA: 10:39 - loss: nan - acc: 0.224110500/94696 [==&gt;...........................] - ETA: 10:37 - loss: nan - acc: 0.224510800/94696 [==&gt;...........................] - ETA: 10:35 - loss: nan - acc: 0.225111100/94696 [==&gt;...........................] - ETA: 10:32 - loss: nan - acc: 0.225011400/94696 [==&gt;...........................] - ETA: 10:30 - loss: nan - acc: 0.224611700/94696 [==&gt;...........................] - ETA: 10:28 - loss: nan - acc: 0.224412000/94696 [==&gt;...........................] - ETA: 10:25 - loss: nan - acc: 0.224312300/94696 [==&gt;...........................] - ETA: 10:23 - loss: nan - acc: 0.225012600/94696 [==&gt;...........................] - ETA: 10:21 - loss: nan - acc: 0.225912900/94696 [===&gt;..........................] - ETA: 10:19 - loss: nan - acc: 0.225713200/94696 [===&gt;..........................] - ETA: 10:16 - loss: nan - acc: 0.225913500/94696 [===&gt;..........................] - ETA: 10:14 - loss: nan - acc: 0.225913800/94696 [===&gt;..........................] - ETA: 10:12 - loss: nan - acc: 0.225914100/94696 [===&gt;..........................] - ETA: 10:10 - loss: nan - acc: 0.226714400/94696 [===&gt;..........................] - ETA: 10:07 - loss: nan - acc: 0.226514700/94696 [===&gt;..........................] - ETA: 10:05 - loss: nan - acc: 0.226015000/94696 [===&gt;..........................] - ETA: 10:03 - loss: nan - acc: 0.226515300/94696 [===&gt;..........................] - ETA: 10:01 - loss: nan - acc: 0.226315600/94696 [===&gt;..........................] - ETA: 9:59 - loss: nan - acc: 0.2263 15900/94696 [====&gt;.........................] - ETA: 9:57 - loss: nan - acc: 0.226016200/94696 [====&gt;.........................] - ETA: 9:54 - loss: nan - acc: 0.226216500/94696 [====&gt;.........................] - ETA: 9:52 - loss: nan - acc: 0.225816800/94696 [====&gt;.........................] - ETA: 9:50 - loss: nan - acc: 0.225517100/94696 [====&gt;.........................] - ETA: 9:48 - loss: nan - acc: 0.225017400/94696 [====&gt;.........................] - ETA: 9:45 - loss: nan - acc: 0.224417700/94696 [====&gt;.........................] - ETA: 9:43 - loss: nan - acc: 0.224618000/94696 [====&gt;.........................] - ETA: 9:41 - loss: nan - acc: 0.224318300/94696 [====&gt;.........................] - ETA: 9:38 - loss: nan - acc: 0.224518600/94696 [====&gt;.........................] - ETA: 9:36 - loss: nan - acc: 0.224718900/94696 [====&gt;.........................] - ETA: 9:34 - loss: nan - acc: 0.224819200/94696 [=====&gt;........................] - ETA: 9:31 - loss: nan - acc: 0.225119500/94696 [=====&gt;........................] - ETA: 9:29 - loss: nan - acc: 0.224919800/94696 [=====&gt;........................] - ETA: 9:27 - loss: nan - acc: 0.224720100/94696 [=====&gt;........................] - ETA: 9:24 - loss: nan - acc: 0.224220400/94696 [=====&gt;........................] - ETA: 9:22 - loss: nan - acc: 0.224320700/94696 [=====&gt;........................] - ETA: 9:20 - loss: nan - acc: 0.224721000/94696 [=====&gt;........................] - ETA: 9:18 - loss: nan - acc: 0.224621300/94696 [=====&gt;........................] - ETA: 9:15 - loss: nan - acc: 0.224621600/94696 [=====&gt;........................] - ETA: 9:13 - loss: nan - acc: 0.224721900/94696 [=====&gt;........................] - ETA: 9:11 - loss: nan - acc: 0.224622200/94696 [======&gt;.......................] - ETA: 9:09 - loss: nan - acc: 0.225022500/94696 [======&gt;.......................] - ETA: 9:06 - loss: nan - acc: 0.224722800/94696 [======&gt;.......................] - ETA: 9:04 - loss: nan - acc: 0.224423100/94696 [======&gt;.......................] - ETA: 9:02 - loss: nan - acc: 0.224723400/94696 [======&gt;.......................] - ETA: 8:59 - loss: nan - acc: 0.224823700/94696 [======&gt;.......................] - ETA: 8:57 - loss: nan - acc: 0.224924000/94696 [======&gt;.......................] - ETA: 8:55 - loss: nan - acc: 0.225224300/94696 [======&gt;.......................] - ETA: 8:53 - loss: nan - acc: 0.224924600/94696 [======&gt;.......................] - ETA: 8:50 - loss: nan - acc: 0.224824900/94696 [======&gt;.......................] - ETA: 8:48 - loss: nan - acc: 0.224525200/94696 [======&gt;.......................] - ETA: 8:46 - loss: nan - acc: 0.224725500/94696 [=======&gt;......................] - ETA: 8:44 - loss: nan - acc: 0.224725800/94696 [=======&gt;......................] - ETA: 8:41 - loss: nan - acc: 0.225226100/94696 [=======&gt;......................] - ETA: 8:39 - loss: nan - acc: 0.225226400/94696 [=======&gt;......................] - ETA: 8:37 - loss: nan - acc: 0.225326700/94696 [=======&gt;......................] - ETA: 8:35 - loss: nan - acc: 0.225127000/94696 [=======&gt;......................] - ETA: 8:32 - loss: nan - acc: 0.225027300/94696 [=======&gt;......................] - ETA: 8:30 - loss: nan - acc: 0.225227600/94696 [=======&gt;......................] - ETA: 8:28 - loss: nan - acc: 0.225327900/94696 [=======&gt;......................] - ETA: 8:25 - loss: nan - acc: 0.225628200/94696 [=======&gt;......................] - ETA: 8:23 - loss: nan - acc: 0.225528500/94696 [========&gt;.....................] - ETA: 8:21 - loss: nan - acc: 0.225528800/94696 [========&gt;.....................] - ETA: 8:18 - loss: nan - acc: 0.225729100/94696 [========&gt;.....................] - ETA: 8:16 - loss: nan - acc: 0.225629400/94696 [========&gt;.....................] - ETA: 8:14 - loss: nan - acc: 0.225629700/94696 [========&gt;.....................] - ETA: 8:12 - loss: nan - acc: 0.225830000/94696 [========&gt;.....................] - ETA: 8:09 - loss: nan - acc: 0.225530300/94696 [========&gt;.....................] - ETA: 8:07 - loss: nan - acc: 0.225330600/94696 [========&gt;.....................] - ETA: 8:05 - loss: nan - acc: 0.224830900/94696 [========&gt;.....................] - ETA: 8:03 - loss: nan - acc: 0.224731200/94696 [========&gt;.....................] - ETA: 8:00 - loss: nan - acc: 0.224831500/94696 [========&gt;.....................] - ETA: 7:58 - loss: nan - acc: 0.224731800/94696 [=========&gt;....................] - ETA: 7:56 - loss: nan - acc: 0.224632100/94696 [=========&gt;....................] - ETA: 7:54 - loss: nan - acc: 0.224532400/94696 [=========&gt;....................] - ETA: 7:51 - loss: nan - acc: 0.224832700/94696 [=========&gt;....................] - ETA: 7:49 - loss: nan - acc: 0.225033000/94696 [=========&gt;....................] - ETA: 7:47 - loss: nan - acc: 0.224733300/94696 [=========&gt;....................] - ETA: 7:45 - loss: nan - acc: 0.224833600/94696 [=========&gt;....................] - ETA: 7:42 - loss: nan - acc: 0.224833900/94696 [=========&gt;....................] - ETA: 7:40 - loss: nan - acc: 0.224634200/94696 [=========&gt;....................] - ETA: 7:38 - loss: nan - acc: 0.224634500/94696 [=========&gt;....................] - ETA: 7:36 - loss: nan - acc: 0.224534800/94696 [==========&gt;...................] - ETA: 7:33 - loss: nan - acc: 0.224435100/94696 [==========&gt;...................] - ETA: 7:31 - loss: nan - acc: 0.224335400/94696 [==========&gt;...................] - ETA: 7:29 - loss: nan - acc: 0.224435700/94696 [==========&gt;...................] - ETA: 7:26 - loss: nan - acc: 0.224136000/94696 [==========&gt;...................] - ETA: 7:24 - loss: nan - acc: 0.224036300/94696 [==========&gt;...................] - ETA: 7:22 - loss: nan - acc: 0.224136600/94696 [==========&gt;...................] - ETA: 7:20 - loss: nan - acc: 0.224236900/94696 [==========&gt;...................] - ETA: 7:17 - loss: nan - acc: 0.223937200/94696 [==========&gt;...................] - ETA: 7:15 - loss: nan - acc: 0.224037500/94696 [==========&gt;...................] - ETA: 7:13 - loss: nan - acc: 0.223937800/94696 [==========&gt;...................] - ETA: 7:11 - loss: nan - acc: 0.224038100/94696 [===========&gt;..................] - ETA: 7:08 - loss: nan - acc: 0.224138400/94696 [===========&gt;..................] - ETA: 7:06 - loss: nan - acc: 0.224338700/94696 [===========&gt;..................] - ETA: 7:04 - loss: nan - acc: 0.224639000/94696 [===========&gt;..................] - ETA: 7:02 - loss: nan - acc: 0.224739300/94696 [===========&gt;..................] - ETA: 6:59 - loss: nan - acc: 0.224639600/94696 [===========&gt;..................] - ETA: 6:57 - loss: nan - acc: 0.224739900/94696 [===========&gt;..................] - ETA: 6:55 - loss: nan - acc: 0.224840200/94696 [===========&gt;..................] - ETA: 6:53 - loss: nan - acc: 0.224940500/94696 [===========&gt;..................] - ETA: 6:50 - loss: nan - acc: 0.224940800/94696 [===========&gt;..................] - ETA: 6:48 - loss: nan - acc: 0.224641100/94696 [============&gt;.................] - ETA: 6:46 - loss: nan - acc: 0.224741400/94696 [============&gt;.................] - ETA: 6:43 - loss: nan - acc: 0.224741700/94696 [============&gt;.................] - ETA: 6:41 - loss: nan - acc: 0.224842000/94696 [============&gt;.................] - ETA: 6:39 - loss: nan - acc: 0.224642300/94696 [============&gt;.................] - ETA: 6:37 - loss: nan - acc: 0.224742600/94696 [============&gt;.................] - ETA: 6:34 - loss: nan - acc: 0.224442900/94696 [============&gt;.................] - ETA: 6:32 - loss: nan - acc: 0.224243200/94696 [============&gt;.................] - ETA: 6:30 - loss: nan - acc: 0.224443500/94696 [============&gt;.................] - ETA: 6:28 - loss: nan - acc: 0.224243800/94696 [============&gt;.................] - ETA: 6:25 - loss: nan - acc: 0.224344100/94696 [============&gt;.................] - ETA: 6:23 - loss: nan - acc: 0.224644400/94696 [=============&gt;................] - ETA: 6:21 - loss: nan - acc: 0.224644700/94696 [=============&gt;................] - ETA: 6:19 - loss: nan - acc: 0.224645000/94696 [=============&gt;................] - ETA: 6:16 - loss: nan - acc: 0.224945300/94696 [=============&gt;................] - ETA: 6:14 - loss: nan - acc: 0.225045600/94696 [=============&gt;................] - ETA: 6:12 - loss: nan - acc: 0.224945900/94696 [=============&gt;................] - ETA: 6:09 - loss: nan - acc: 0.224946200/94696 [=============&gt;................] - ETA: 6:07 - loss: nan - acc: 0.225046500/94696 [=============&gt;................] - ETA: 6:05 - loss: nan - acc: 0.225046800/94696 [=============&gt;................] - ETA: 6:03 - loss: nan - acc: 0.225047100/94696 [=============&gt;................] - ETA: 6:00 - loss: nan - acc: 0.224847400/94696 [==============&gt;...............] - ETA: 5:58 - loss: nan - acc: 0.224847700/94696 [==============&gt;...............] - ETA: 5:56 - loss: nan - acc: 0.224648000/94696 [==============&gt;...............] - ETA: 5:54 - loss: nan - acc: 0.224448300/94696 [==============&gt;...............] - ETA: 5:51 - loss: nan - acc: 0.224548600/94696 [==============&gt;...............] - ETA: 5:49 - loss: nan - acc: 0.224548900/94696 [==============&gt;...............] - ETA: 5:47 - loss: nan - acc: 0.224449200/94696 [==============&gt;...............] - ETA: 5:44 - loss: nan - acc: 0.224449500/94696 [==============&gt;...............] - ETA: 5:42 - loss: nan - acc: 0.224449800/94696 [==============&gt;...............] - ETA: 5:40 - loss: nan - acc: 0.224650100/94696 [==============&gt;...............] - ETA: 5:38 - loss: nan - acc: 0.224550400/94696 [==============&gt;...............] - ETA: 5:35 - loss: nan - acc: 0.224650700/94696 [===============&gt;..............] - ETA: 5:33 - loss: nan - acc: 0.224351000/94696 [===============&gt;..............] - ETA: 5:31 - loss: nan - acc: 0.224451300/94696 [===============&gt;..............] - ETA: 5:29 - loss: nan - acc: 0.224451600/94696 [===============&gt;..............] - ETA: 5:26 - loss: nan - acc: 0.224451900/94696 [===============&gt;..............] - ETA: 5:24 - loss: nan - acc: 0.224552200/94696 [===============&gt;..............] - ETA: 5:22 - loss: nan - acc: 0.224652500/94696 [===============&gt;..............] - ETA: 5:20 - loss: nan - acc: 0.224752800/94696 [===============&gt;..............] - ETA: 5:17 - loss: nan - acc: 0.224653100/94696 [===============&gt;..............] - ETA: 5:15 - loss: nan - acc: 0.224553400/94696 [===============&gt;..............] - ETA: 5:13 - loss: nan - acc: 0.224353700/94696 [================&gt;.............] - ETA: 5:10 - loss: nan - acc: 0.224354000/94696 [================&gt;.............] - ETA: 5:08 - loss: nan - acc: 0.224554300/94696 [================&gt;.............] - ETA: 5:06 - loss: nan - acc: 0.224654600/94696 [================&gt;.............] - ETA: 5:04 - loss: nan - acc: 0.224554900/94696 [================&gt;.............] - ETA: 5:01 - loss: nan - acc: 0.224455200/94696 [================&gt;.............] - ETA: 4:59 - loss: nan - acc: 0.224655500/94696 [================&gt;.............] - ETA: 4:57 - loss: nan - acc: 0.224855800/94696 [================&gt;.............] - ETA: 4:55 - loss: nan - acc: 0.224856100/94696 [================&gt;.............] - ETA: 4:52 - loss: nan - acc: 0.224956400/94696 [================&gt;.............] - ETA: 4:50 - loss: nan - acc: 0.224756700/94696 [================&gt;.............] - ETA: 4:48 - loss: nan - acc: 0.224857000/94696 [=================&gt;............] - ETA: 4:45 - loss: nan - acc: 0.224857300/94696 [=================&gt;............] - ETA: 4:43 - loss: nan - acc: 0.224757600/94696 [=================&gt;............] - ETA: 4:41 - loss: nan - acc: 0.224857900/94696 [=================&gt;............] - ETA: 4:39 - loss: nan - acc: 0.224758200/94696 [=================&gt;............] - ETA: 4:36 - loss: nan - acc: 0.224858500/94696 [=================&gt;............] - ETA: 4:34 - loss: nan - acc: 0.224758800/94696 [=================&gt;............] - ETA: 4:32 - loss: nan - acc: 0.224959100/94696 [=================&gt;............] - ETA: 4:30 - loss: nan - acc: 0.224959400/94696 [=================&gt;............] - ETA: 4:27 - loss: nan - acc: 0.225059700/94696 [=================&gt;............] - ETA: 4:25 - loss: nan - acc: 0.225060000/94696 [==================&gt;...........] - ETA: 4:23 - loss: nan - acc: 0.225160300/94696 [==================&gt;...........] - ETA: 4:20 - loss: nan - acc: 0.225060600/94696 [==================&gt;...........] - ETA: 4:18 - loss: nan - acc: 0.225060900/94696 [==================&gt;...........] - ETA: 4:16 - loss: nan - acc: 0.225261200/94696 [==================&gt;...........] - ETA: 4:14 - loss: nan - acc: 0.225161500/94696 [==================&gt;...........] - ETA: 4:11 - loss: nan - acc: 0.225261800/94696 [==================&gt;...........] - ETA: 4:09 - loss: nan - acc: 0.225662100/94696 [==================&gt;...........] - ETA: 4:07 - loss: nan - acc: 0.225662400/94696 [==================&gt;...........] - ETA: 4:05 - loss: nan - acc: 0.225562700/94696 [==================&gt;...........] - ETA: 4:02 - loss: nan - acc: 0.225463000/94696 [==================&gt;...........] - ETA: 4:00 - loss: nan - acc: 0.225463300/94696 [===================&gt;..........] - ETA: 3:58 - loss: nan - acc: 0.225263600/94696 [===================&gt;..........] - ETA: 3:55 - loss: nan - acc: 0.225363900/94696 [===================&gt;..........] - ETA: 3:53 - loss: nan - acc: 0.225364200/94696 [===================&gt;..........] - ETA: 3:51 - loss: nan - acc: 0.225364500/94696 [===================&gt;..........] - ETA: 3:49 - loss: nan - acc: 0.225364800/94696 [===================&gt;..........] - ETA: 3:46 - loss: nan - acc: 0.225465100/94696 [===================&gt;..........] - ETA: 3:44 - loss: nan - acc: 0.225565400/94696 [===================&gt;..........] - ETA: 3:42 - loss: nan - acc: 0.225665700/94696 [===================&gt;..........] - ETA: 3:39 - loss: nan - acc: 0.225566000/94696 [===================&gt;..........] - ETA: 3:37 - loss: nan - acc: 0.225766300/94696 [====================&gt;.........] - ETA: 3:35 - loss: nan - acc: 0.225766600/94696 [====================&gt;.........] - ETA: 3:33 - loss: nan - acc: 0.225866900/94696 [====================&gt;.........] - ETA: 3:30 - loss: nan - acc: 0.225967200/94696 [====================&gt;.........] - ETA: 3:28 - loss: nan - acc: 0.225867500/94696 [====================&gt;.........] - ETA: 3:26 - loss: nan - acc: 0.225767800/94696 [====================&gt;.........] - ETA: 3:23 - loss: nan - acc: 0.225868100/94696 [====================&gt;.........] - ETA: 3:21 - loss: nan - acc: 0.225768400/94696 [====================&gt;.........] - ETA: 3:19 - loss: nan - acc: 0.225768700/94696 [====================&gt;.........] - ETA: 3:17 - loss: nan - acc: 0.225769000/94696 [====================&gt;.........] - ETA: 3:14 - loss: nan - acc: 0.225769300/94696 [====================&gt;.........] - ETA: 3:12 - loss: nan - acc: 0.225669600/94696 [=====================&gt;........] - ETA: 3:10 - loss: nan - acc: 0.225569900/94696 [=====================&gt;........] - ETA: 3:08 - loss: nan - acc: 0.225670200/94696 [=====================&gt;........] - ETA: 3:05 - loss: nan - acc: 0.225870500/94696 [=====================&gt;........] - ETA: 3:03 - loss: nan - acc: 0.225570800/94696 [=====================&gt;........] - ETA: 3:01 - loss: nan - acc: 0.225571100/94696 [=====================&gt;........] - ETA: 2:58 - loss: nan - acc: 0.225571400/94696 [=====================&gt;........] - ETA: 2:56 - loss: nan - acc: 0.225571700/94696 [=====================&gt;........] - ETA: 2:54 - loss: nan - acc: 0.225572000/94696 [=====================&gt;........] - ETA: 2:52 - loss: nan - acc: 0.225572300/94696 [=====================&gt;........] - ETA: 2:49 - loss: nan - acc: 0.225472600/94696 [=====================&gt;........] - ETA: 2:47 - loss: nan - acc: 0.225572900/94696 [======================&gt;.......] - ETA: 2:45 - loss: nan - acc: 0.225573200/94696 [======================&gt;.......] - ETA: 2:43 - loss: nan - acc: 0.225573500/94696 [======================&gt;.......] - ETA: 2:40 - loss: nan - acc: 0.225573800/94696 [======================&gt;.......] - ETA: 2:38 - loss: nan - acc: 0.225674100/94696 [======================&gt;.......] - ETA: 2:36 - loss: nan - acc: 0.225574400/94696 [======================&gt;.......] - ETA: 2:33 - loss: nan - acc: 0.225574700/94696 [======================&gt;.......] - ETA: 2:31 - loss: nan - acc: 0.225575000/94696 [======================&gt;.......] - ETA: 2:29 - loss: nan - acc: 0.225675300/94696 [======================&gt;.......] - ETA: 2:27 - loss: nan - acc: 0.225475600/94696 [======================&gt;.......] - ETA: 2:24 - loss: nan - acc: 0.225575900/94696 [=======================&gt;......] - ETA: 2:22 - loss: nan - acc: 0.225676200/94696 [=======================&gt;......] - ETA: 2:20 - loss: nan - acc: 0.225876500/94696 [=======================&gt;......] - ETA: 2:17 - loss: nan - acc: 0.225776800/94696 [=======================&gt;......] - ETA: 2:15 - loss: nan - acc: 0.225577100/94696 [=======================&gt;......] - ETA: 2:13 - loss: nan - acc: 0.225677400/94696 [=======================&gt;......] - ETA: 2:11 - loss: nan - acc: 0.225677700/94696 [=======================&gt;......] - ETA: 2:08 - loss: nan - acc: 0.225878000/94696 [=======================&gt;......] - ETA: 2:06 - loss: nan - acc: 0.225978300/94696 [=======================&gt;......] - ETA: 2:04 - loss: nan - acc: 0.225778600/94696 [=======================&gt;......] - ETA: 2:02 - loss: nan - acc: 0.225778900/94696 [=======================&gt;......] - ETA: 1:59 - loss: nan - acc: 0.225679200/94696 [========================&gt;.....] - ETA: 1:57 - loss: nan - acc: 0.225679500/94696 [========================&gt;.....] - ETA: 1:55 - loss: nan - acc: 0.225779800/94696 [========================&gt;.....] - ETA: 1:52 - loss: nan - acc: 0.225780100/94696 [========================&gt;.....] - ETA: 1:50 - loss: nan - acc: 0.225880400/94696 [========================&gt;.....] - ETA: 1:48 - loss: nan - acc: 0.225780700/94696 [========================&gt;.....] - ETA: 1:46 - loss: nan - acc: 0.225781000/94696 [========================&gt;.....] - ETA: 1:43 - loss: nan - acc: 0.225681300/94696 [========================&gt;.....] - ETA: 1:41 - loss: nan - acc: 0.225781600/94696 [========================&gt;.....] - ETA: 1:39 - loss: nan - acc: 0.225781900/94696 [========================&gt;.....] - ETA: 1:37 - loss: nan - acc: 0.225682200/94696 [=========================&gt;....] - ETA: 1:34 - loss: nan - acc: 0.225582500/94696 [=========================&gt;....] - ETA: 1:32 - loss: nan - acc: 0.225382800/94696 [=========================&gt;....] - ETA: 1:30 - loss: nan - acc: 0.225483100/94696 [=========================&gt;....] - ETA: 1:27 - loss: nan - acc: 0.225483400/94696 [=========================&gt;....] - ETA: 1:25 - loss: nan - acc: 0.225583700/94696 [=========================&gt;....] - ETA: 1:23 - loss: nan - acc: 0.225484000/94696 [=========================&gt;....] - ETA: 1:21 - loss: nan - acc: 0.225384300/94696 [=========================&gt;....] - ETA: 1:18 - loss: nan - acc: 0.225384600/94696 [=========================&gt;....] - ETA: 1:16 - loss: nan - acc: 0.225484900/94696 [=========================&gt;....] - ETA: 1:14 - loss: nan - acc: 0.225645300/94696 [=============&gt;................] - ETA: 6:13 - loss: nan - acc: 0.224745600/94696 [=============&gt;................] - ETA: 6:11 - loss: nan - acc: 0.224745900/94696 [=============&gt;................] - ETA: 6:09 - loss: nan - acc: 0.224846200/94696 [=============&gt;................] - ETA: 6:06 - loss: nan - acc: 0.224846500/94696 [=============&gt;................] - ETA: 6:04 - loss: nan - acc: 0.224946800/94696 [=============&gt;................] - ETA: 6:02 - loss: nan - acc: 0.224747100/94696 [=============&gt;................] - ETA: 6:00 - loss: nan - acc: 0.225047400/94696 [==============&gt;...............] - ETA: 5:57 - loss: nan - acc: 0.225047700/94696 [==============&gt;...............] - ETA: 5:55 - loss: nan - acc: 0.224948000/94696 [==============&gt;...............] - ETA: 5:53 - loss: nan - acc: 0.225148300/94696 [==============&gt;...............] - ETA: 5:50 - loss: nan - acc: 0.225348600/94696 [==============&gt;...............] - ETA: 5:48 - loss: nan - acc: 0.225448900/94696 [==============&gt;...............] - ETA: 5:46 - loss: nan - acc: 0.225549200/94696 [==============&gt;...............] - ETA: 5:44 - loss: nan - acc: 0.225649500/94696 [==============&gt;...............] - ETA: 5:41 - loss: nan - acc: 0.225649800/94696 [==============&gt;...............] - ETA: 5:39 - loss: nan - acc: 0.225650100/94696 [==============&gt;...............] - ETA: 5:37 - loss: nan - acc: 0.225650400/94696 [==============&gt;...............] - ETA: 5:35 - loss: nan - acc: 0.225550700/94696 [===============&gt;..............] - ETA: 5:32 - loss: nan - acc: 0.225351000/94696 [===============&gt;..............] - ETA: 5:30 - loss: nan - acc: 0.225351300/94696 [===============&gt;..............] - ETA: 5:28 - loss: nan - acc: 0.225251600/94696 [===============&gt;..............] - ETA: 5:25 - loss: nan - acc: 0.225251900/94696 [===============&gt;..............] - ETA: 5:23 - loss: nan - acc: 0.225052200/94696 [===============&gt;..............] - ETA: 5:21 - loss: nan - acc: 0.225252500/94696 [===============&gt;..............] - ETA: 5:19 - loss: nan - acc: 0.225252800/94696 [===============&gt;..............] - ETA: 5:16 - loss: nan - acc: 0.225053100/94696 [===============&gt;..............] - ETA: 5:14 - loss: nan - acc: 0.225053400/94696 [===============&gt;..............] - ETA: 5:12 - loss: nan - acc: 0.225053700/94696 [================&gt;.............] - ETA: 5:10 - loss: nan - acc: 0.225054000/94696 [================&gt;.............] - ETA: 5:07 - loss: nan - acc: 0.225054300/94696 [================&gt;.............] - ETA: 5:05 - loss: nan - acc: 0.225154600/94696 [================&gt;.............] - ETA: 5:03 - loss: nan - acc: 0.225154900/94696 [================&gt;.............] - ETA: 5:00 - loss: nan - acc: 0.225155200/94696 [================&gt;.............] - ETA: 4:58 - loss: nan - acc: 0.224955500/94696 [================&gt;.............] - ETA: 4:56 - loss: nan - acc: 0.225055800/94696 [================&gt;.............] - ETA: 4:54 - loss: nan - acc: 0.225056100/94696 [================&gt;.............] - ETA: 4:51 - loss: nan - acc: 0.224956400/94696 [================&gt;.............] - ETA: 4:49 - loss: nan - acc: 0.224856700/94696 [================&gt;.............] - ETA: 4:47 - loss: nan - acc: 0.224957000/94696 [=================&gt;............] - ETA: 4:45 - loss: nan - acc: 0.225057300/94696 [=================&gt;............] - ETA: 4:42 - loss: nan - acc: 0.224957600/94696 [=================&gt;............] - ETA: 4:40 - loss: nan - acc: 0.224757900/94696 [=================&gt;............] - ETA: 4:38 - loss: nan - acc: 0.224858200/94696 [=================&gt;............] - ETA: 4:35 - loss: nan - acc: 0.224758500/94696 [=================&gt;............] - ETA: 4:33 - loss: nan - acc: 0.224758800/94696 [=================&gt;............] - ETA: 4:31 - loss: nan - acc: 0.224659100/94696 [=================&gt;............] - ETA: 4:29 - loss: nan - acc: 0.224559400/94696 [=================&gt;............] - ETA: 4:26 - loss: nan - acc: 0.224459700/94696 [=================&gt;............] - ETA: 4:24 - loss: nan - acc: 0.224460000/94696 [==================&gt;...........] - ETA: 4:22 - loss: nan - acc: 0.224260300/94696 [==================&gt;...........] - ETA: 4:20 - loss: nan - acc: 0.224460600/94696 [==================&gt;...........] - ETA: 4:17 - loss: nan - acc: 0.224460900/94696 [==================&gt;...........] - ETA: 4:15 - loss: nan - acc: 0.224361200/94696 [==================&gt;...........] - ETA: 4:13 - loss: nan - acc: 0.224561500/94696 [==================&gt;...........] - ETA: 4:11 - loss: nan - acc: 0.224661800/94696 [==================&gt;...........] - ETA: 4:08 - loss: nan - acc: 0.224762100/94696 [==================&gt;...........] - ETA: 4:06 - loss: nan - acc: 0.224862400/94696 [==================&gt;...........] - ETA: 4:04 - loss: nan - acc: 0.225062700/94696 [==================&gt;...........] - ETA: 4:01 - loss: nan - acc: 0.225063000/94696 [==================&gt;...........] - ETA: 3:59 - loss: nan - acc: 0.225063300/94696 [===================&gt;..........] - ETA: 3:57 - loss: nan - acc: 0.225063600/94696 [===================&gt;..........] - ETA: 3:55 - loss: nan - acc: 0.225163900/94696 [===================&gt;..........] - ETA: 3:52 - loss: nan - acc: 0.225164200/94696 [===================&gt;..........] - ETA: 3:50 - loss: nan - acc: 0.225064500/94696 [===================&gt;..........] - ETA: 3:48 - loss: nan - acc: 0.225064800/94696 [===================&gt;..........] - ETA: 3:46 - loss: nan - acc: 0.225065100/94696 [===================&gt;..........] - ETA: 3:43 - loss: nan - acc: 0.225065400/94696 [===================&gt;..........] - ETA: 3:41 - loss: nan - acc: 0.225265700/94696 [===================&gt;..........] - ETA: 3:39 - loss: nan - acc: 0.225166000/94696 [===================&gt;..........] - ETA: 3:36 - loss: nan - acc: 0.225366300/94696 [====================&gt;.........] - ETA: 3:34 - loss: nan - acc: 0.225566600/94696 [====================&gt;.........] - ETA: 3:32 - loss: nan - acc: 0.225466900/94696 [====================&gt;.........] - ETA: 3:30 - loss: nan - acc: 0.225467200/94696 [====================&gt;.........] - ETA: 3:27 - loss: nan - acc: 0.225467500/94696 [====================&gt;.........] - ETA: 3:25 - loss: nan - acc: 0.225267800/94696 [====================&gt;.........] - ETA: 3:23 - loss: nan - acc: 0.225368100/94696 [====================&gt;.........] - ETA: 3:21 - loss: nan - acc: 0.225268400/94696 [====================&gt;.........] - ETA: 3:18 - loss: nan - acc: 0.225168700/94696 [====================&gt;.........] - ETA: 3:16 - loss: nan - acc: 0.225369000/94696 [====================&gt;.........] - ETA: 3:14 - loss: nan - acc: 0.225469300/94696 [====================&gt;.........] - ETA: 3:11 - loss: nan - acc: 0.225669600/94696 [=====================&gt;........] - ETA: 3:09 - loss: nan - acc: 0.225569900/94696 [=====================&gt;........] - ETA: 3:07 - loss: nan - acc: 0.225570200/94696 [=====================&gt;........] - ETA: 3:05 - loss: nan - acc: 0.225670500/94696 [=====================&gt;........] - ETA: 3:02 - loss: nan - acc: 0.225670800/94696 [=====================&gt;........] - ETA: 3:00 - loss: nan - acc: 0.225771100/94696 [=====================&gt;........] - ETA: 2:58 - loss: nan - acc: 0.225771400/94696 [=====================&gt;........] - ETA: 2:56 - loss: nan - acc: 0.225671700/94696 [=====================&gt;........] - ETA: 2:53 - loss: nan - acc: 0.225772000/94696 [=====================&gt;........] - ETA: 2:51 - loss: nan - acc: 0.225872300/94696 [=====================&gt;........] - ETA: 2:49 - loss: nan - acc: 0.225972600/94696 [=====================&gt;........] - ETA: 2:46 - loss: nan - acc: 0.226072900/94696 [======================&gt;.......] - ETA: 2:44 - loss: nan - acc: 0.225773200/94696 [======================&gt;.......] - ETA: 2:42 - loss: nan - acc: 0.225873500/94696 [======================&gt;.......] - ETA: 2:40 - loss: nan - acc: 0.225873800/94696 [======================&gt;.......] - ETA: 2:37 - loss: nan - acc: 0.225874100/94696 [======================&gt;.......] - ETA: 2:35 - loss: nan - acc: 0.226074400/94696 [======================&gt;.......] - ETA: 2:33 - loss: nan - acc: 0.226074700/94696 [======================&gt;.......] - ETA: 2:31 - loss: nan - acc: 0.226075000/94696 [======================&gt;.......] - ETA: 2:28 - loss: nan - acc: 0.225975300/94696 [======================&gt;.......] - ETA: 2:26 - loss: nan - acc: 0.226075600/94696 [======================&gt;.......] - ETA: 2:24 - loss: nan - acc: 0.226075900/94696 [=======================&gt;......] - ETA: 2:22 - loss: nan - acc: 0.225976200/94696 [=======================&gt;......]18600/94696 [====&gt;.........................] - ETA: 9:34 - loss: nan - acc: 0.224918900/94696 [====&gt;.........................] - ETA: 9:32 - loss: nan - acc: 0.225119200/94696 [=====&gt;........................] - ETA: 9:30 - loss: nan - acc: 0.225019500/94696 [=====&gt;........................] - ETA: 9:27 - loss: nan - acc: 0.225219800/94696 [=====&gt;........................] - ETA: 9:25 - loss: nan - acc: 0.224920100/94696 [=====&gt;........................] - ETA: 9:23 - loss: nan - acc: 0.225220400/94696 [=====&gt;........................] - ETA: 9:21 - loss: nan - acc: 0.225420700/94696 [=====&gt;........................] - ETA: 9:19 - loss: nan - acc: 0.225221000/94696 [=====&gt;........................] - ETA: 9:16 - loss: nan - acc: 0.224521300/94696 [=====&gt;........................] - ETA: 9:14 - loss: nan - acc: 0.224821600/94696 [=====&gt;........................] - ETA: 9:12 - loss: nan - acc: 0.224521900/94696 [=====&gt;........................] - ETA: 9:10 - loss: nan - acc: 0.224222200/94696 [======&gt;.......................] - ETA: 9:07 - loss: nan - acc: 0.224122500/94696 [======&gt;.......................] - ETA: 9:05 - loss: nan - acc: 0.224422800/94696 [======&gt;.......................] - ETA: 9:03 - loss: nan - acc: 0.224523100/94696 [======&gt;.......................] - ETA: 9:00 - loss: nan - acc: 0.224523400/94696 [======&gt;.......................] - ETA: 8:58 - loss: nan - acc: 0.224423700/94696 [======&gt;.......................] - ETA: 8:56 - loss: nan - acc: 0.224624000/94696 [======&gt;.......................] - ETA: 8:54 - loss: nan - acc: 0.224424300/94696 [======&gt;.......................] - ETA: 8:51 - loss: nan - acc: 0.224624600/94696 [======&gt;.......................] - ETA: 8:49 - loss: nan - acc: 0.224824900/94696 [======&gt;.......................] - ETA: 8:47 - loss: nan - acc: 0.224125200/94696 [======&gt;.......................] - ETA: 8:45 - loss: nan - acc: 0.224225500/94696 [=======&gt;......................] - ETA: 8:42 - loss: nan - acc: 0.224025800/94696 [=======&gt;......................] - ETA: 8:40 - loss: nan - acc: 0.224426100/94696 [=======&gt;......................] - ETA: 8:38 - loss: nan - acc: 0.224626400/94696 [=======&gt;......................] - ETA: 8:36 - loss: nan - acc: 0.224626700/94696 [=======&gt;......................] - ETA: 8:33 - loss: nan - acc: 0.224927000/94696 [=======&gt;......................] - ETA: 8:31 - loss: nan - acc: 0.225027300/94696 [=======&gt;......................] - ETA: 8:29 - loss: nan - acc: 0.225027600/94696 [=======&gt;......................] - ETA: 8:27 - loss: nan - acc: 0.225227900/94696 [=======&gt;......................] - ETA: 8:24 - loss: nan - acc: 0.225328200/94696 [=======&gt;......................] - ETA: 8:22 - loss: nan - acc: 0.225428500/94696 [========&gt;.....................] - ETA: 8:20 - loss: nan - acc: 0.225328800/94696 [========&gt;.....................] - ETA: 8:18 - loss: nan - acc: 0.225429100/94696 [========&gt;.....................] - ETA: 8:15 - loss: nan - acc: 0.225629400/94696 [========&gt;.....................] - ETA: 8:13 - loss: nan - acc: 0.225529700/94696 [========&gt;.....................] - ETA: 8:11 - loss: nan - acc: 0.225530000/94696 [========&gt;.....................] - ETA: 8:09 - loss: nan - acc: 0.225730300/94696 [========&gt;.....................] - ETA: 8:06 - loss: nan - acc: 0.225830600/94696 [========&gt;.....................] - ETA: 8:04 - loss: nan - acc: 0.225530900/94696 [========&gt;.....................] - ETA: 8:02 - loss: nan - acc: 0.225231200/94696 [========&gt;.....................] - ETA: 8:00 - loss: nan - acc: 0.225331500/94696 [========&gt;.....................] - ETA: 7:57 - loss: nan - acc: 0.225331800/94696 [=========&gt;....................] - ETA: 7:55 - loss: nan - acc: 0.225332100/94696 [=========&gt;....................] - ETA: 7:53 - loss: nan - acc: 0.225132400/94696 [=========&gt;....................] - ETA: 7:50 - loss: nan - acc: 0.225532700/94696 [=========&gt;....................] - ETA: 7:48 - loss: nan - acc: 0.225533000/94696 [=========&gt;....................] - ETA: 7:46 - loss: nan - acc: 0.225833300/94696 [=========&gt;....................] - ETA: 7:44 - loss: nan - acc: 0.225733600/94696 [=========&gt;....................] - ETA: 7:41 - loss: nan - acc: 0.225533900/94696 [=========&gt;....................] - ETA: 7:39 - loss: nan - acc: 0.225634200/94696 [=========&gt;....................] - ETA: 7:37 - loss: nan - acc: 0.225834500/94696 [=========&gt;....................] - ETA: 7:35 - loss: nan - acc: 0.225934800/94696 [==========&gt;...................] - ETA: 7:32 - loss: nan - acc: 0.226035100/94696 [==========&gt;...................] - ETA: 7:30 - loss: nan - acc: 0.225935400/94696 [==========&gt;...................] - ETA: 7:28 - loss: nan - acc: 0.225535700/94696 [==========&gt;...................] - ETA: 7:25 - loss: nan - acc: 0.225436000/94696 [==========&gt;...................] - ETA: 7:23 - loss: nan - acc: 0.225636300/94696 [==========&gt;...................] - ETA: 7:21 - loss: nan - acc: 0.225336600/94696 [==========&gt;...................] - ETA: 7:19 - loss: nan - acc: 0.225236900/94696 [==========&gt;...................] - ETA: 7:16 - loss: nan - acc: 0.225137200/94696 [==========&gt;...................] - ETA: 7:14 - loss: nan - acc: 0.225237500/94696 [==========&gt;...................] - ETA: 7:12 - loss: nan - acc: 0.225437800/94696 [==========&gt;...................] - ETA: 7:09 - loss: nan - acc: 0.225138100/94696 [===========&gt;..................] - ETA: 7:07 - loss: nan - acc: 0.224938400/94696 [===========&gt;..................] - ETA: 7:05 - loss: nan - acc: 0.225338700/94696 [===========&gt;..................] - ETA: 7:03 - loss: nan - acc: 0.225139000/94696 [===========&gt;..................] - ETA: 7:00 - loss: nan - acc: 0.225139300/94696 [===========&gt;..................] - ETA: 6:58 - loss: nan - acc: 0.225039600/94696 [===========&gt;..................] - ETA: 6:56 - loss: nan - acc: 0.224839900/94696 [===========&gt;..................] - ETA: 6:53 - loss: nan - acc: 0.224640200/94696 [===========&gt;..................] - ETA: 6:51 - loss: nan - acc: 0.224940500/94696 [===========&gt;..................] - ETA: 6:49 - loss: nan - acc: 0.224940800/94696 [===========&gt;..................] - ETA: 6:47 - loss: nan - acc: 0.225041100/94696 [============&gt;.................] - ETA: 6:44 - loss: nan - acc: 0.225041400/94696 [============&gt;.................] - ETA: 6:42 - loss: nan - acc: 0.225041700/94696 [============&gt;.................] - ETA: 6:40 - loss: nan - acc: 0.224942000/94696 [============&gt;.................] - ETA: 6:38 - loss: nan - acc: 0.224842300/94696 [============&gt;.................] - ETA: 6:35 - loss: nan - acc: 0.224842600/94696 [============&gt;.................] - ETA: 6:33 - loss: nan - acc: 0.224942900/94696 [============&gt;.................] - ETA: 6:31 - loss: nan - acc: 0.224843200/94696 [============&gt;.................] - ETA: 6:29 - loss: nan - acc: 0.224943500/94696 [============&gt;.................] - ETA: 6:26 - loss: nan - acc: 0.224943800/94696 [============&gt;.................] - ETA: 6:24 - loss: nan - acc: 0.224544100/94696 [============&gt;.................] - ETA: 6:22 - loss: nan - acc: 0.224544400/94696 [=============&gt;................] - ETA: 6:20 - loss: nan - acc: 0.224444700/94696 [=============&gt;................] - ETA: 6:17 - loss: nan - acc: 0.224445000/94696 [=============&gt;................] - ETA: 6:15 - loss: nan - acc: 0.224645300/94696 [=============&gt;................] - ETA: 6:13 - loss: nan - acc: 0.224745600/94696 [=============&gt;................] - ETA: 6:11 - loss: nan - acc: 0.224945900/94696 [=============&gt;................] - ETA: 6:08 - loss: nan - acc: 0.225046200/94696 [=============&gt;................] - ETA: 6:06 - loss: nan - acc: 0.224846500/94696 [=============&gt;................] - ETA: 6:04 - loss: nan - acc: 0.224946800/94696 [=============&gt;................] - ETA: 6:02 - loss: nan - acc: 0.224847100/94696 [=============&gt;................] - ETA: 5:59 - loss: nan - acc: 0.224647400/94696 [==============&gt;...............] - ETA: 5:57 - loss: nan - acc: 0.224547700/94696 [==============&gt;...............] - ETA: 5:55 - loss: nan - acc: 0.224548000/94696 [==============&gt;...............] - ETA: 5:53 - loss: nan - acc: 0.224748300/94696 [==============&gt;...............] - ETA: 5:50 - loss: nan - acc: 0.224848600/94696 [==============&gt;...............] - ETA: 5:48 - loss: nan - acc: 0.224748900/94696 [==============&gt;...............] - ETA: 5:46 - loss: nan - acc: 0.224849200/94696 [==============&gt;...............] - ETA: 5:44 - loss: nan - acc: 0.224849500/94696 [==============&gt;...............] - ETA: 5:41 - loss: nan - acc: 0.224649800/94696 [==============&gt;...............] - ETA: 5:39 - loss: nan - acc: 0.224650100/94696 [==============&gt;...............] - ETA: 5:37 - loss: nan - acc: 0.224850400/94696 [==============&gt;...............] - ETA: 5:34 - loss: nan - acc: 0.224750700/94696 [===============&gt;..............] - ETA: 5:32 - loss: nan - acc: 0.224951000/94696 [===============&gt;..............] - ETA: 5:30 - loss: nan - acc: 0.224851300/94696 [===============&gt;..............] - ETA: 5:28 - loss: nan - acc: 0.224851600/94696 [===============&gt;..............] - ETA: 5:25 - loss: nan - acc: 0.225051900/94696 [===============&gt;..............] - ETA: 5:23 - loss: nan - acc: 0.224752200/94696 [===============&gt;..............] - ETA: 5:21 - loss: nan - acc: 0.224852500/94696 [===============&gt;..............] - ETA: 5:19 - loss: nan - acc: 0.224652800/94696 [===============&gt;..............] - ETA: 5:16 - loss: nan - acc: 0.224653100/94696 [===============&gt;..............] - ETA: 5:14 - loss: nan - acc: 0.224753400/94696 [===============&gt;..............] - ETA: 5:12 - loss: nan - acc: 0.224653700/94696 [================&gt;.............] - ETA: 5:09 - loss: nan - acc: 0.224654000/94696 [================&gt;.............] - ETA: 5:07 - loss: nan - acc: 0.224454300/94696 [================&gt;.............] - ETA: 5:05 - loss: nan - acc: 0.224554600/94696 [================&gt;.............] - ETA: 5:03 - loss: nan - acc: 0.224554900/94696 [================&gt;.............] - ETA: 5:00 - loss: nan - acc: 0.224655200/94696 [================&gt;.............] - ETA: 4:58 - loss: nan - acc: 0.224555500/94696 [================&gt;.............] - ETA: 4:56 - loss: nan - acc: 0.224855800/94696 [================&gt;.............] - ETA: 4:54 - loss: nan - acc: 0.224956100/94696 [================&gt;.............] - ETA: 4:51 - loss: nan - acc: 0.224756400/94696 [================&gt;.............] - ETA: 4:49 - loss: nan - acc: 0.224856700/94696 [================&gt;.............] - ETA: 4:47 - loss: nan - acc: 0.224857000/94696 [=================&gt;............] - ETA: 4:45 - loss: nan - acc: 0.224857300/94696 [=================&gt;............] - ETA: 4:42 - loss: nan - acc: 0.224757600/94696 [=================&gt;............] - ETA: 4:40 - loss: nan - acc: 0.224757900/94696 [=================&gt;............] - ETA: 4:38 - loss: nan - acc: 0.224658200/94696 [=================&gt;............] - ETA: 4:36 - loss: nan - acc: 0.224558500/94696 [=================&gt;............] - ETA: 4:33 - loss: nan - acc: 0.224658800/94696 [=================&gt;............] - ETA: 4:31 - loss: nan - acc: 0.224659100/94696 [=================&gt;............] - ETA: 4:29 - loss: nan - acc: 0.224559400/94696 [=================&gt;............] - ETA: 4:26 - loss: nan - acc: 0.224659700/94696 [=================&gt;............] - ETA: 4:24 - loss: nan - acc: 0.224660000/94696 [==================&gt;...........] - ETA: 4:22 - loss: nan - acc: 0.224660300/94696 [==================&gt;...........] - ETA: 4:20 - loss: nan - acc: 0.224660600/94696 [==================&gt;...........] - ETA: 4:17 - loss: nan - acc: 0.224760900/94696 [==================&gt;...........] - ETA: 4:15 - loss: nan - acc: 0.224861200/94696 [==================&gt;...........] - ETA: 4:13 - loss: nan - acc: 0.224761500/94696 [==================&gt;...........] - ETA: 4:11 - loss: nan - acc: 0.224761800/94696 [==================&gt;...........] - ETA: 4:08 - loss: nan - acc: 0.224762100/94696 [==================&gt;...........] - ETA: 4:06 - loss: nan - acc: 0.224862400/94696 [==================&gt;...........] - ETA: 4:04 - loss: nan - acc: 0.224962700/94696 [==================&gt;...........] - ETA: 4:02 - loss: nan - acc: 0.224863000/94696 [==================&gt;...........] - ETA: 3:59 - loss: nan - acc: 0.224763300/94696 [===================&gt;..........] - ETA: 3:57 - loss: nan - acc: 0.224863600/94696 [===================&gt;..........] - ETA: 3:55 - loss: nan - acc: 0.224663900/94696 [===================&gt;..........] - ETA: 3:52 - loss: nan - acc: 0.224764200/94696 [===================&gt;..........] - ETA: 3:50 - loss: nan - acc: 0.225064500/94696 [===================&gt;..........] - ETA: 3:48 - loss: nan - acc: 0.225064800/94696 [===================&gt;..........] - ETA: 3:46 - loss: nan - acc: 0.224865100/94696 [===================&gt;..........] - ETA: 3:43 - loss: nan - acc: 0.224665400/94696 [===================&gt;..........] - ETA: 3:41 - loss: nan - acc: 0.224665700/94696 [===================&gt;..........] - ETA: 3:39 - loss: nan - acc: 0.224666000/94696 [===================&gt;..........] - ETA: 3:37 - loss: nan - acc: 0.224666300/94696 [====================&gt;.........] - ETA: 3:34 - loss: nan - acc: 0.224866600/94696 [====================&gt;.........] - ETA: 3:32 - loss: nan - acc: 0.224766900/94696 [====================&gt;.........] - ETA: 3:30 - loss: nan - acc: 0.224767200/94696 [====================&gt;.........] - ETA: 3:28 - loss: nan - acc: 0.224767500/94696 [====================&gt;.........] - ETA: 3:25 - loss: nan - acc: 0.224767800/94696 [====================&gt;.........] - ETA: 3:23 - loss: nan - acc: 0.224968100/94696 [====================&gt;.........] - ETA: 3:21 - loss: nan - acc: 0.225068400/94696 [====================&gt;.........] - ETA: 3:18 - loss: nan - acc: 0.225068700/94696 [====================&gt;.........] - ETA: 3:16 - loss: nan - acc: 0.224869000/94696 [====================&gt;.........] - ETA: 3:14 - loss: nan - acc: 0.224869300/94696 [====================&gt;.........] - ETA: 3:12 - loss: nan - acc: 0.224769600/94696 [=====================&gt;........] - ETA: 3:09 - loss: nan - acc: 0.224669900/94696 [=====================&gt;........] - ETA: 3:07 - loss: nan - acc: 0.224670200/94696 [=====================&gt;........] - ETA: 3:05 - loss: nan - acc: 0.224570500/94696 [=====================&gt;........] - ETA: 3:03 - loss: nan - acc: 0.224670800/94696 [=====================&gt;........] - ETA: 3:00 - loss: nan - acc: 0.224671100/94696 [=====================&gt;........] - ETA: 2:58 - loss: nan - acc: 0.224771400/94696 [=====================&gt;........] - ETA: 2:56 - loss: nan - acc: 0.224671700/94696 [=====================&gt;........] - ETA: 2:54 - loss: nan - acc: 0.225072000/94696 [=====================&gt;........] - ETA: 2:51 - loss: nan - acc: 0.225072300/94696 [=====================&gt;........] - ETA: 2:49 - loss: nan - acc: 0.224972600/94696 [=====================&gt;........] - ETA: 2:47 - loss: nan - acc: 0.225172900/94696 [======================&gt;.......] - ETA: 2:44 - loss: nan - acc: 0.225173200/94696 [======================&gt;.......] - ETA: 2:42 - loss: nan - acc: 0.225273500/94696 [======================&gt;.......] - ETA: 2:40 - loss: nan - acc: 0.225473800/94696 [======================&gt;.......] - ETA: 2:38 - loss: nan - acc: 0.226474100/94696 [======================&gt;.......] - ETA: 2:36 - loss: nan - acc: 0.226474400/94696 [======================&gt;.......] - ETA: 2:33 - loss: nan - acc: 0.226374700/94696 [======================&gt;.......] - ETA: 2:31 - loss: nan - acc: 0.226375000/94696 [======================&gt;.......] - ETA: 2:29 - loss: nan - acc: 0.226375300/94696 [======================&gt;.......] - ETA: 2:27 - loss: nan - acc: 0.226375600/94696 [======================&gt;.......] - ETA: 2:24 - loss: nan - acc: 0.226475900/94696 [=======================&gt;......] - ETA: 2:22 - loss: nan - acc: 0.226476200/94696 [=======================&gt;......] - ETA: 2:20 - loss: nan - acc: 0.226376500/94696 [=======================&gt;......] - ETA: 2:18 - loss: nan - acc: 0.226276800/94696 [=======================&gt;......] - ETA: 2:15 - loss: nan - acc: 0.226277100/94696 [=======================&gt;......] - ETA: 2:13 - loss: nan - acc: 0.226377400/94696 [=======================&gt;......] - ETA: 2:11 - loss: nan - acc: 0.226277700/94696 [=======================&gt;......] - ETA: 2:09 - loss: nan - acc: 0.226378000/94696 [=======================&gt;......] - ETA: 2:06 - loss: nan - acc: 0.226378300/94696 [=======================&gt;......] - ETA: 2:04 - loss: nan - acc: 0.226478600/94696 [=======================&gt;......] - ETA: 2:02 - loss: nan - acc: 0.226478900/94696 [=======================&gt;......] - ETA: 1:59 - loss: nan - acc: 0.226579200/94696 [========================&gt;.....] - ETA: 1:57 - loss: nan - acc: 0.226479500/94696 [========================&gt;.....] - ETA: 1:55 - loss: nan - acc: 0.226479800/94696 [========================&gt;.....] - ETA: 1:53 - loss: nan - acc: 0.226380100/94696 [========================&gt;.....] - ETA: 1:50 - loss: nan - acc: 0.226380400/94696 [========================&gt;.....] - ETA: 1:48 - loss: nan - acc: 0.226380700/94696 [========================&gt;.....] - ETA: 1:46 - loss: nan - acc: 0.226481000/94696 [========================&gt;.....] - ETA: 1:43 - loss: nan - acc: 0.226581300/94696 [========================&gt;.....] - ETA: 1:41 - loss: nan - acc: 0.226481600/94696 [========================&gt;.....] - ETA: 1:39 - loss: nan - acc: 0.226281900/94696 [========================&gt;.....] - ETA: 1:37 - loss: nan - acc: 0.226282200/94696 [=========================&gt;....] - ETA: 1:34 - loss: nan - acc: 0.226382500/94696 [=========================&gt;....] - ETA: 1:32 - loss: nan - acc: 0.226382800/94696 [=========================&gt;....] - ETA: 1:30 - loss: nan - acc: 0.226283100/94696 [=========================&gt;....] - ETA: 1:28 - loss: nan - acc: 0.226283400/94696 [=========================&gt;....] - ETA: 1:25 - loss: nan - acc: 0.226283700/94696 [=========================&gt;....] - ETA: 1:23 - loss: nan - acc: 0.226284000/94696 [=========================&gt;....] - ETA: 1:21 - loss: nan - acc: 0.226484300/94696 [=========================&gt;....] - ETA: 1:18 - loss: nan - acc: 0.226384600/94696 [=========================&gt;....] - ETA: 1:16 - loss: nan - acc: 0.226384900/94696 [=========================&gt;....] - ETA: 1:14 - loss: nan - acc: 0.226285200/94696 [=========================&gt;....] - ETA: 1:12 - loss: nan - acc: 0.226185500/94696 [==========================&gt;...] - ETA: 1:09 - loss: nan - acc: 0.226185800/94696 [==========================&gt;...] - ETA: 1:07 - loss: nan - acc: 0.226086100/94696 [==========================&gt;...] - ETA: 1:05 - loss: nan - acc: 0.226186400/94696 [==========================&gt;...] - ETA: 1:02 - loss: nan - acc: 0.226386700/94696 [==========================&gt;...] - ETA: 1:00 - loss: nan - acc: 0.226287000/94696 [==========================&gt;...] - ETA: 58s - loss: nan - acc: 0.2262 87300/94696 [==========================&gt;...] - ETA: 56s - loss: nan - acc: 0.226287600/94696 [==========================&gt;...] - ETA: 53s - loss: nan - acc: 0.226187900/94696 [==========================&gt;...] - ETA: 51s - loss: nan - acc: 0.226088200/94696 [==========================&gt;...] - ETA: 49s - loss: nan - acc: 0.226288500/94696 [===========================&gt;..] - ETA: 47s - loss: nan - acc: 0.226188800/94696 [===========================&gt;..] - ETA: 44s - loss: nan - acc: 0.226189100/94696 [===========================&gt;..] - ETA: 42s - loss: nan - acc: 0.226189400/94696 [===========================&gt;..] - ETA: 40s - loss: nan - acc: 0.226089700/94696 [===========================&gt;..] - ETA: 37s - loss: nan - acc: 0.226190000/94696 [===========================&gt;..] - ETA: 35s - loss: nan - acc: 0.226090300/94696 [===========================&gt;..] - ETA: 33s - loss: nan - acc: 0.225890600/94696 [===========================&gt;..] - ETA: 31s - loss: nan - acc: 0.225990900/94696 [===========================&gt;..] - ETA: 28s - loss: nan - acc: 0.225891200/94696 [===========================&gt;..] - ETA: 26s - loss: nan - acc: 0.225891500/94696 [===========================&gt;..] - ETA: 24s - loss: nan - acc: 0.225891800/94696 [============================&gt;.] - ETA: 21s - loss: nan - acc: 0.225892100/94696 [============================&gt;.] - ETA: 19s - loss: nan - acc: 0.225892400/94696 [============================&gt;.] - ETA: 17s - loss: nan - acc: 0.225892700/94696 [============================&gt;.] - ETA: 15s - loss: nan - acc: 0.225893000/94696 [============================&gt;.] - ETA: 12s - loss: nan - acc: 0.225893300/94696 [============================&gt;.] - ETA: 10s - loss: nan - acc: 0.226093600/94696 [============================&gt;.] - ETA: 8s - loss: nan - acc: 0.2260 93900/94696 [============================&gt;.] - ETA: 6s - loss: nan - acc: 0.225994200/94696 [============================&gt;.] - ETA: 3s - loss: nan - acc: 0.225894500/94696 [============================&gt;.] - ETA: 1s - loss: nan - acc: 0.225994696/94696 [==============================] - 751s 8ms/step - loss: nan - acc: 0.2260 - val_loss: nan - val_acc: 0.2186
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[&nbsp;]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x167dd008c50&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Task-2---Recurrent-Neural-Network">Task 2 - Recurrent Neural Network<a class="anchor-link" href="#Task-2---Recurrent-Neural-Network">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Load the bible.txt file, store its first 10,000 characters (to get quicker answers) and check its length. </li>
<li>Preprocess the text with keras Tokenizer. This time we want to train a model that generates text character-by-character instead of word-by-word as we did before. <ul>
<li>notice the char_level parameter and set it properly</li>
<li>set the dictionary size to contain 100 most frequent characters </li>
<li>convert characters to lower to free entries in your dictionary</li>
<li>train tokenizer on the text</li>
</ul>
</li>
<li>Convert the tokenized data (a sequence of characters) into a binary matrix form. </li>
<li>Set the input and output matrices</li>
<li>Create a model with:<ul>
<li>an Embedding input layer with 42 entries</li>
<li>a SimpleRNN layer with 186 hidden nodes and a relu activation function and identity initialization</li>
<li>a Dense output layer with a softmax activation function</li>
</ul>
</li>
<li>Compile the model with the rmsprop optimizer and fit it to the data for three epochs.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Back-to-nietzsche's-data">Back to nietzsche's data<a class="anchor-link" href="#Back-to-nietzsche's-data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's go back to nietzsche's data, but this time we will train models to understand the sequence of characters, instead the sequence of characters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.utils.data_utils</span> <span class="k">import</span> <span class="n">get_file</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span><span class="s1">&#39;nietzsche.txt&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;https://s3.amazonaws.com/text-datasets/nietzsche.txt&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;corpus length:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>corpus length: 600901
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we check to see the number of unique characters in the text. These characters will be our vocabulay.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">chars</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total chars:&#39;</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>total chars: 86
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is our vocabulary:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span> <span class="c1">#the last six are unreadable</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39; !&#34;\&#39;(),-.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZ[]_abcdefghijklmnopqrstuvwxyz&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Map from chars to indices and back again</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">char_indices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">))</span>
<span class="n">indices_char</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>idx</em> will be the data we use from now own - it simply converts all the characters to their index (based on the mapping above)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_indices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
<span class="n">idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[39, 41, 28, 29, 24, 26, 28, 0, 0, 0]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get text instead of the stored indices in idx, we use the indices_char conversion array that we calculated earlier:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">indices_char</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">[:</span><span class="mi">70</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;PREFACE\n\n\nSUPPOSING that Truth is a woman--what then? Is there not gro&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3-char-model">3 char model<a class="anchor-link" href="#3-char-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-inputs">Create inputs<a class="anchor-link" href="#Create-inputs">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a list of every 4th character, starting at the 0th, 1st, 2nd, then 3rd characters.
Let's use range to generate values in the range given by three parameters: start, stop, and step</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[191]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cs</span><span class="o">=</span><span class="mi">3</span>
<span class="n">c1_dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span>
<span class="n">c2_dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span>
<span class="n">c3_dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span>
<span class="n">c4_dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs: (let's just convert these list into arrays)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c1_dat</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c2_dat</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c3_dat</span><span class="p">)</span>
<span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">x3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[192]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((200299,), (200299,), (200299,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Putting it all in one matrix:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[193]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(200299, 3)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our output</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c4_dat</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[194]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(200299,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first 4 inputs and outputs</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[195]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([[39, 41, 28],
       [29, 24, 26],
       [28,  0,  0],
       [ 0, 42, 44]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[196]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([29, 28,  0, 39])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-and-train-model">Create and train model<a class="anchor-link" href="#Create-and-train-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create inputs and embedding outputs for each of our 3 character inputs.
We will use:</p>
<ol>
<li>an Embedding layer, which turn positive integers (indexes) into dense vectors of fixed size</li>
<li>SimpleRNN layer, which is a fully-connected RNN where the output is to be fed back to input.</li>
<li>a dense output layer. Note that its size is set to the vocabulary size since it returns the probabilities for each possible target index.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The number of latent factors to create in the Enbedding Layer (i.e. the size of the embedding matrix)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_fac</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the number of inputs:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cs</span><span class="o">=</span><span class="mi">3</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is the number of hidden nodes in the RNN layer:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_hidden</span><span class="o">=</span> <span class="mi">256</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and this is the vocabulary size that we calculated before:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[200]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_size</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[200]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>86</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">cs</span><span class="p">),</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">inner_init</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
embedding_1 (Embedding)          (None, 3, 42)         3612        embedding_input_1[0][0]          
____________________________________________________________________________________________________
simplernn_1 (SimpleRNN)          (None, 256)           76544       embedding_1[0][0]                
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 86)            22102       simplernn_1[0][0]                
====================================================================================================
Total params: 102,258
Trainable params: 102,258
Non-trainable params: 0
____________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compile the model. This time we use the sparse_categorical_crossentropy loss that accepts sparse labels (index instead of hot-one representation).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's fit the model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
153600/200299 [======================&gt;.......] - ETA: 2s - loss: 2.5177 - acc: 0.3035    400/200299 [..............................] - ETA: 25s - loss: 4.4164 - acc: 0.0825 - ETA: 12s - loss: 3.2148 - acc: 0.1603 26800/200299 [===&gt;..........................] - ETA: 10s - loss: 3.0228 - acc: 0.2024 - ETA: 10s - loss: 2.9627 - acc: 0.2154 - ETA: 10s - loss: 2.9166 - acc: 0.2251 - ETA: 8s - loss: 2.7596 - acc: 0.2562 87800/200299 [============&gt;.................] - ETA: 7s - loss: 2.6758 - acc: 0.2722 - ETA: 6s - loss: 2.6287 - acc: 0.2809 - ETA: 4s - loss: 2.5600 - acc: 0.2941 - ETA: 3s - loss: 2.5435 - acc: 0.2977143600/200299 [====================&gt;.........] - ETA: 3s - loss: 2.5362 - acc: 0.2992 - ETA: 3s - loss: 2.5225 - acc: 0.3023</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's define a prediction function and use it to predict some characters and check the model:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_next_keras</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_indices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span> <span class="c1">#convert characters to indices</span>
    <span class="n">arrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idxs</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span> <span class="c1">#converting to the required input format</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">arrs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#using the model to predict the next index</span>
    <span class="k">return</span> <span class="n">chars</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span> <span class="c1">#converting the index with max probability to a character</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that our get_next_keras is very basic, it always predicts the character with the highest probability. That means that for the same input we will always get the same prediction. It may be a good idea to change the prediction so that instead of choosing the character with maximum probability it will sample a character acording to the various distributions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_next_keras</span><span class="p">(</span><span class="s1">&#39;thi&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;n&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_next_keras</span><span class="p">(</span><span class="s1">&#39;par&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;t&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Returning-sequences">Returning sequences<a class="anchor-link" href="#Returning-sequences">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now train a model that gets three characters and generates the next character for each of them.</p>
<p>First we need to change our output to contain three characters.</p>
<p>Here, c_out_dat is identical to c_in_dat, but moved across 1 character.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span>
<span class="n">xs</span> <span class="o">=</span>  <span class="n">xs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="c1"># ignore the last character that has no known prediction</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To convert our previous keras model into a sequence model, simply add the 'return_sequences=True' parameter, and add TimeDistributed() around our dense layer.</p>
<p>The TimeDistributed wrapper allows to apply a layer to every temporal slice of an input.</p>
<p>The dimension of index one will be considered to be the temporal dimension.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.layers.wrappers</span> <span class="k">import</span> <span class="n">TimeDistributed</span> 
<span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">cs</span><span class="p">),</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">inner_init</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">),</span>
        <span class="n">TimeDistributed</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\ipykernel\__main__.py:4: UserWarning: Update your `SimpleRNN` call to the Keras 2 API: `SimpleRNN(256, return_sequences=True, recurrent_initializer=&#34;identity&#34;, activation=&#34;relu&#34;)`
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[205]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[216]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 3, 42)             3612      
_________________________________________________________________
simple_rnn_12 (SimpleRNN)    (None, 3, 256)            76544     
_________________________________________________________________
time_distributed_9 (TimeDist (None, 3, 86)             22102     
=================================================================
Total params: 102,258
Trainable params: 102,258
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some reshaping must be made in order to get the input and the output to the right format (adding a dimension to the output).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_rnn</span><span class="o">=</span><span class="n">xs</span>
<span class="n">y_rnn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_rnn</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_rnn</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[206]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((200298, 3), (200298, 3, 1))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_rnn</span><span class="p">,</span> <span class="n">y_rnn</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\models.py:939: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn(&#39;The `nb_epoch` argument in `fit` &#39;
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/8
    64/200298 [..............................] - ETA: 1:38 - loss: 4.4564 - acc: 0.0104   576/200298 [..............................] - ETA: 31s - loss: 4.3943 - acc: 0.0747    960/200298 [..............................] - ETA: 29s - loss: 4.3114 - acc: 0.0934  1600/200298 [..............................] - ETA: 26s - loss: 4.1168 - acc: 0.1121  2240/200298 [..............................] - ETA: 24s - loss: 3.9837 - acc: 0.1223  2816/200298 [..............................] - ETA: 23s - loss: 3.8969 - acc: 0.1250  3328/200298 [..............................] - ETA: 23s - loss: 3.8396 - acc: 0.1247  3904/200298 [..............................] - ETA: 22s - loss: 3.7763 - acc: 0.1273  4544/200298 [..............................] - ETA: 22s - loss: 3.7123 - acc: 0.1304  5120/200298 [..............................] - ETA: 21s - loss: 3.6611 - acc: 0.1331  5632/200298 [..............................] - ETA: 22s - loss: 3.6217 - acc: 0.1335  6144/200298 [..............................] - ETA: 21s - loss: 3.5885 - acc: 0.1344  6720/200298 [&gt;.............................] - ETA: 21s - loss: 3.5502 - acc: 0.1357  7232/200298 [&gt;.............................] - ETA: 21s - loss: 3.5197 - acc: 0.1373  7680/200298 [&gt;.............................] - ETA: 21s - loss: 3.4966 - acc: 0.1381  8320/200298 [&gt;.............................] - ETA: 21s - loss: 3.4683 - acc: 0.1402  8768/200298 [&gt;.............................] - ETA: 21s - loss: 3.4473 - acc: 0.1414  9280/200298 [&gt;.............................] - ETA: 21s - loss: 3.4287 - acc: 0.1417  9792/200298 [&gt;.............................] - ETA: 21s - loss: 3.4113 - acc: 0.1425 10240/200298 [&gt;.............................] - ETA: 21s - loss: 3.3987 - acc: 0.1432 10752/200298 [&gt;.............................] - ETA: 21s - loss: 3.3838 - acc: 0.1434 11328/200298 [&gt;.............................] - ETA: 20s - loss: 3.3702 - acc: 0.1436 11840/200298 [&gt;.............................] - ETA: 20s - loss: 3.3575 - acc: 0.1443 12352/200298 [&gt;.............................] - ETA: 20s - loss: 3.3477 - acc: 0.1447 12864/200298 [&gt;.............................] - ETA: 20s - loss: 3.3368 - acc: 0.1449 13312/200298 [&gt;.............................] - ETA: 20s - loss: 3.3285 - acc: 0.1452 13824/200298 [=&gt;............................] - ETA: 20s - loss: 3.3188 - acc: 0.1454 14336/200298 [=&gt;............................] - ETA: 20s - loss: 3.3108 - acc: 0.1453 14848/200298 [=&gt;............................] - ETA: 20s - loss: 3.3027 - acc: 0.1456 15360/200298 [=&gt;............................] - ETA: 20s - loss: 3.2967 - acc: 0.1460 15808/200298 [=&gt;............................] - ETA: 20s - loss: 3.2906 - acc: 0.1460 16320/200298 [=&gt;............................] - ETA: 20s - loss: 3.2853 - acc: 0.1464 16832/200298 [=&gt;............................] - ETA: 20s - loss: 3.2795 - acc: 0.1466 17280/200298 [=&gt;............................] - ETA: 19s - loss: 3.2745 - acc: 0.1468 17728/200298 [=&gt;............................] - ETA: 19s - loss: 3.2690 - acc: 0.1471 18176/200298 [=&gt;............................] - ETA: 19s - loss: 3.2659 - acc: 0.1470 18688/200298 [=&gt;............................] - ETA: 19s - loss: 3.2607 - acc: 0.1471 19200/200298 [=&gt;............................] - ETA: 19s - loss: 3.2559 - acc: 0.1473 19712/200298 [=&gt;............................] - ETA: 19s - loss: 3.2510 - acc: 0.1477 20224/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2477 - acc: 0.1477 20736/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2433 - acc: 0.1478 21248/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2390 - acc: 0.1480 21696/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2349 - acc: 0.1481 22144/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2309 - acc: 0.1485 22656/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2271 - acc: 0.1483 23168/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2234 - acc: 0.1486 23680/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2202 - acc: 0.1488 24192/200298 [==&gt;...........................] - ETA: 19s - loss: 3.2170 - acc: 0.1490 24704/200298 [==&gt;...........................] - ETA: 18s - loss: 3.2135 - acc: 0.1491 25216/200298 [==&gt;...........................] - ETA: 18s - loss: 3.2105 - acc: 0.1491 25728/200298 [==&gt;...........................] - ETA: 18s - loss: 3.2075 - acc: 0.1493 26240/200298 [==&gt;...........................] - ETA: 18s - loss: 3.2045 - acc: 0.1496 26752/200298 [===&gt;..........................] - ETA: 18s - loss: 3.2022 - acc: 0.1498 27200/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1997 - acc: 0.1498 27712/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1970 - acc: 0.1500 28224/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1950 - acc: 0.1502 28672/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1926 - acc: 0.1501 29184/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1901 - acc: 0.1501 29632/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1872 - acc: 0.1500 30080/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1846 - acc: 0.1503 30592/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1824 - acc: 0.1505 31040/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1816 - acc: 0.1504 31552/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1803 - acc: 0.1505 32064/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1784 - acc: 0.1507 32512/200298 [===&gt;..........................] - ETA: 18s - loss: 3.1763 - acc: 0.1508 33024/200298 [===&gt;..........................] - ETA: 17s - loss: 3.1737 - acc: 0.1510 33536/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1722 - acc: 0.1510 33984/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1703 - acc: 0.1511 34496/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1685 - acc: 0.1512 35008/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1656 - acc: 0.1516 35520/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1645 - acc: 0.1517 36032/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1626 - acc: 0.1519 36544/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1611 - acc: 0.1521 36992/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1599 - acc: 0.1523 37504/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1586 - acc: 0.1524 38016/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1571 - acc: 0.1523 38528/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1555 - acc: 0.1523 39040/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1537 - acc: 0.1524 39552/200298 [====&gt;.........................] - ETA: 17s - loss: 3.1526 - acc: 0.1526 40064/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1518 - acc: 0.1526 40576/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1507 - acc: 0.1528 41088/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1490 - acc: 0.1530 41600/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1484 - acc: 0.1529 41984/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1477 - acc: 0.1529 42368/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1466 - acc: 0.1531 42752/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1464 - acc: 0.1530 43136/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1451 - acc: 0.1530 43520/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1440 - acc: 0.1531 43904/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1430 - acc: 0.1530 44288/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1418 - acc: 0.1531 44672/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1412 - acc: 0.1532 45056/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1403 - acc: 0.1532 45440/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1391 - acc: 0.1532 45824/200298 [=====&gt;........................] - ETA: 17s - loss: 3.1383 - acc: 0.1532 46272/200298 [=====&gt;........................] - ETA: 16s - loss: 3.1373 - acc: 0.1531 46720/200298 [=====&gt;........................] - ETA: 16s - loss: 3.1360 - acc: 0.1532 47296/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1344 - acc: 0.1533 47744/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1335 - acc: 0.1534 48192/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1328 - acc: 0.1534 48640/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1315 - acc: 0.1535 49088/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1309 - acc: 0.1536 49536/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1300 - acc: 0.1536 49984/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1297 - acc: 0.1537 50432/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1289 - acc: 0.1537 50880/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1279 - acc: 0.1539 51392/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1267 - acc: 0.1541 51840/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1258 - acc: 0.1541 52352/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1245 - acc: 0.1541 52800/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1234 - acc: 0.1543 53312/200298 [======&gt;.......................] - ETA: 16s - loss: 3.1224 - acc: 0.1543 53824/200298 [=======&gt;......................] - ETA: 16s - loss: 3.1220 - acc: 0.1543 54336/200298 [=======&gt;......................] - ETA: 16s - loss: 3.1213 - acc: 0.1544 54784/200298 [=======&gt;......................] - ETA: 16s - loss: 3.1207 - acc: 0.1545 55168/200298 [=======&gt;......................] - ETA: 16s - loss: 3.1200 - acc: 0.1545 55616/200298 [=======&gt;......................] - ETA: 16s - loss: 3.1192 - acc: 0.1547 56128/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1184 - acc: 0.1548 56576/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1175 - acc: 0.1549 57024/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1166 - acc: 0.1550 57472/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1160 - acc: 0.1551 57920/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1154 - acc: 0.1551 58368/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1150 - acc: 0.1552 58816/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1141 - acc: 0.1554 59264/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1134 - acc: 0.1554 59712/200298 [=======&gt;......................] - ETA: 15s - loss: 3.1129 - acc: 0.1554 60160/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1119 - acc: 0.1555 60544/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1117 - acc: 0.1555 60992/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1109 - acc: 0.1555 61440/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1100 - acc: 0.1556 61888/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1089 - acc: 0.1558 62336/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1082 - acc: 0.1558 62784/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1074 - acc: 0.1559 63232/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1069 - acc: 0.1559 63680/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1062 - acc: 0.1560 64128/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1056 - acc: 0.1560 64576/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1053 - acc: 0.1560 65024/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1048 - acc: 0.1562 65472/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1041 - acc: 0.1563 65920/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1037 - acc: 0.1563 66368/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1030 - acc: 0.1563 66752/200298 [========&gt;.....................] - ETA: 15s - loss: 3.1023 - acc: 0.1563 67264/200298 [=========&gt;....................] - ETA: 14s - loss: 3.1015 - acc: 0.1563 67648/200298 [=========&gt;....................] - ETA: 14s - loss: 3.1008 - acc: 0.1564 68096/200298 [=========&gt;....................] - ETA: 14s - loss: 3.1002 - acc: 0.1565 68544/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0992 - acc: 0.1566 68992/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0988 - acc: 0.1567 69440/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0982 - acc: 0.1568 70016/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0980 - acc: 0.1568 70528/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0971 - acc: 0.1569 71104/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0968 - acc: 0.1569 71616/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0962 - acc: 0.1569 72192/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0959 - acc: 0.1569 72640/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0951 - acc: 0.1570 73152/200298 [=========&gt;....................] - ETA: 14s - loss: 3.0942 - acc: 0.1571 73664/200298 [==========&gt;...................] - ETA: 14s - loss: 3.0943 - acc: 0.1571 74112/200298 [==========&gt;...................] - ETA: 14s - loss: 3.0934 - acc: 0.1573 74624/200298 [==========&gt;...................] - ETA: 14s - loss: 3.0929 - acc: 0.1573 75136/200298 [==========&gt;...................] - ETA: 14s - loss: 3.0920 - acc: 0.1573 75712/200298 [==========&gt;...................] - ETA: 14s - loss: 3.0916 - acc: 0.1574 76160/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0912 - acc: 0.1574 76672/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0907 - acc: 0.1575 77184/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0902 - acc: 0.1575 77568/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0901 - acc: 0.1575 78016/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0897 - acc: 0.1575 78528/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0891 - acc: 0.1577 78976/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0883 - acc: 0.1578 79424/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0878 - acc: 0.1578 79936/200298 [==========&gt;...................] - ETA: 13s - loss: 3.0871 - acc: 0.1579 80384/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0867 - acc: 0.1578 80832/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0864 - acc: 0.1579 81280/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0859 - acc: 0.1579 81728/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0853 - acc: 0.1579 82176/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0846 - acc: 0.1581 82624/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0840 - acc: 0.1581 83072/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0834 - acc: 0.1582 83584/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0828 - acc: 0.1582 84032/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0822 - acc: 0.1583 84480/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0819 - acc: 0.1583 84928/200298 [===========&gt;..................] - ETA: 13s - loss: 3.0814 - acc: 0.1584 85504/200298 [===========&gt;..................] - ETA: 12s - loss: 3.0808 - acc: 0.1584 85952/200298 [===========&gt;..................] - ETA: 12s - loss: 3.0807 - acc: 0.1584 86528/200298 [===========&gt;..................] - ETA: 12s - loss: 3.0803 - acc: 0.1585 86976/200298 [============&gt;.................] - ETA: 12s - loss: 3.0798 - acc: 0.1585 87296/200298 [============&gt;.................] - ETA: 12s - loss: 3.0795 - acc: 0.1586 87744/200298 [============&gt;.................] - ETA: 12s - loss: 3.0788 - acc: 0.1587 88128/200298 [============&gt;.................] - ETA: 12s - loss: 3.0787 - acc: 0.1587 88576/200298 [============&gt;.................] - ETA: 12s - loss: 3.0785 - acc: 0.1588 88960/200298 [============&gt;.................] - ETA: 12s - loss: 3.0784 - acc: 0.1588 89280/200298 [============&gt;.................] - ETA: 12s - loss: 3.0779 - acc: 0.1589 89600/200298 [============&gt;.................] - ETA: 12s - loss: 3.0775 - acc: 0.1590 89984/200298 [============&gt;.................] - ETA: 12s - loss: 3.0770 - acc: 0.1591 90304/200298 [============&gt;.................] - ETA: 12s - loss: 3.0766 - acc: 0.1591 90688/200298 [============&gt;.................] - ETA: 12s - loss: 3.0761 - acc: 0.1592 91008/200298 [============&gt;.................] - ETA: 12s - loss: 3.0756 - acc: 0.1593 91392/200298 [============&gt;.................] - ETA: 12s - loss: 3.0753 - acc: 0.1593 91776/200298 [============&gt;.................] - ETA: 12s - loss: 3.0751 - acc: 0.1593 92096/200298 [============&gt;.................] - ETA: 12s - loss: 3.0747 - acc: 0.1594 92544/200298 [============&gt;.................] - ETA: 12s - loss: 3.0741 - acc: 0.1595 93056/200298 [============&gt;.................] - ETA: 12s - loss: 3.0735 - acc: 0.1596 93440/200298 [============&gt;.................] - ETA: 12s - loss: 3.0731 - acc: 0.1596 94016/200298 [=============&gt;................] - ETA: 12s - loss: 3.0723 - acc: 0.1597 94592/200298 [=============&gt;................] - ETA: 12s - loss: 3.0719 - acc: 0.1598 94976/200298 [=============&gt;................] - ETA: 12s - loss: 3.0716 - acc: 0.1598 95552/200298 [=============&gt;................] - ETA: 12s - loss: 3.0710 - acc: 0.1599 96064/200298 [=============&gt;................] - ETA: 11s - loss: 3.0706 - acc: 0.1599 96640/200298 [=============&gt;................] - ETA: 11s - loss: 3.0703 - acc: 0.1600 97088/200298 [=============&gt;................] - ETA: 11s - loss: 3.0698 - acc: 0.1600 97600/200298 [=============&gt;................] - ETA: 11s - loss: 3.0696 - acc: 0.1600 98176/200298 [=============&gt;................] - ETA: 11s - loss: 3.0690 - acc: 0.1601 98688/200298 [=============&gt;................] - ETA: 11s - loss: 3.0686 - acc: 0.1601 99264/200298 [=============&gt;................] - ETA: 11s - loss: 3.0680 - acc: 0.1601 99712/200298 [=============&gt;................] - ETA: 11s - loss: 3.0677 - acc: 0.1602100288/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0675 - acc: 0.1602100736/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0671 - acc: 0.1602101184/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0665 - acc: 0.1603101632/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0661 - acc: 0.1603102144/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0659 - acc: 0.1603102720/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0656 - acc: 0.1603103168/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0653 - acc: 0.1603103744/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0650 - acc: 0.1604104192/200298 [==============&gt;...............] - ETA: 11s - loss: 3.0650 - acc: 0.1604104640/200298 [==============&gt;...............] - ETA: 10s - loss: 3.0646 - acc: 0.1605105088/200298 [==============&gt;...............] - ETA: 10s - loss: 3.0643 - acc: 0.1605105536/200298 [==============&gt;...............] - ETA: 10s - loss: 3.0641 - acc: 0.1605105984/200298 [==============&gt;...............] - ETA: 10s - loss: 3.0637 - acc: 0.1606106432/200298 [==============&gt;...............] - ETA: 10s - loss: 3.0632 - acc: 0.1607106944/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0627 - acc: 0.1607107392/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0624 - acc: 0.1608107840/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0620 - acc: 0.1608108288/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0617 - acc: 0.1609108736/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0615 - acc: 0.1609109184/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0610 - acc: 0.1610109632/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0606 - acc: 0.1610110080/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0604 - acc: 0.1611110592/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0603 - acc: 0.1611111040/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0598 - acc: 0.1611111488/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0595 - acc: 0.1611111936/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0591 - acc: 0.1612112384/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0590 - acc: 0.1612112832/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0587 - acc: 0.1612113344/200298 [===============&gt;..............] - ETA: 10s - loss: 3.0582 - acc: 0.1612113792/200298 [================&gt;.............] - ETA: 9s - loss: 3.0578 - acc: 0.1613 114240/200298 [================&gt;.............] - ETA: 9s - loss: 3.0574 - acc: 0.1614114688/200298 [================&gt;.............] - ETA: 9s - loss: 3.0569 - acc: 0.1615115136/200298 [================&gt;.............] - ETA: 9s - loss: 3.0567 - acc: 0.1616115584/200298 [================&gt;.............] - ETA: 9s - loss: 3.0564 - acc: 0.1616116032/200298 [================&gt;.............] - ETA: 9s - loss: 3.0561 - acc: 0.1617116544/200298 [================&gt;.............] - ETA: 9s - loss: 3.0556 - acc: 0.1617116992/200298 [================&gt;.............] - ETA: 9s - loss: 3.0549 - acc: 0.1618117440/200298 [================&gt;.............] - ETA: 9s - loss: 3.0547 - acc: 0.1618117952/200298 [================&gt;.............] - ETA: 9s - loss: 3.0543 - acc: 0.1619118400/200298 [================&gt;.............] - ETA: 9s - loss: 3.0540 - acc: 0.1619118848/200298 [================&gt;.............] - ETA: 9s - loss: 3.0535 - acc: 0.1619119360/200298 [================&gt;.............] - ETA: 9s - loss: 3.0530 - acc: 0.1620119808/200298 [================&gt;.............] - ETA: 9s - loss: 3.0526 - acc: 0.1620120320/200298 [=================&gt;............] - ETA: 9s - loss: 3.0523 - acc: 0.1621120768/200298 [=================&gt;............] - ETA: 9s - loss: 3.0521 - acc: 0.1621121216/200298 [=================&gt;............] - ETA: 9s - loss: 3.0519 - acc: 0.1620121664/200298 [=================&gt;............] - ETA: 9s - loss: 3.0515 - acc: 0.1621122112/200298 [=================&gt;............] - ETA: 8s - loss: 3.0513 - acc: 0.1621122560/200298 [=================&gt;............] - ETA: 8s - loss: 3.0510 - acc: 0.1622123008/200298 [=================&gt;............] - ETA: 8s - loss: 3.0507 - acc: 0.1622123456/200298 [=================&gt;............] - ETA: 8s - loss: 3.0504 - acc: 0.1622123904/200298 [=================&gt;............] - ETA: 8s - loss: 3.0502 - acc: 0.1622124352/200298 [=================&gt;............] - ETA: 8s - loss: 3.0501 - acc: 0.1622124864/200298 [=================&gt;............] - ETA: 8s - loss: 3.0497 - acc: 0.1623125376/200298 [=================&gt;............] - ETA: 8s - loss: 3.0496 - acc: 0.1624125888/200298 [=================&gt;............] - ETA: 8s - loss: 3.0495 - acc: 0.1624126336/200298 [=================&gt;............] - ETA: 8s - loss: 3.0491 - acc: 0.1624126784/200298 [=================&gt;............] - ETA: 8s - loss: 3.0488 - acc: 0.1625127232/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0484 - acc: 0.1625127680/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0481 - acc: 0.1626128128/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0477 - acc: 0.1627128576/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0477 - acc: 0.1627129024/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0475 - acc: 0.1627129472/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0471 - acc: 0.1628129984/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0467 - acc: 0.1628130496/200298 [==================&gt;...........] - ETA: 8s - loss: 3.0464 - acc: 0.1628130944/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0461 - acc: 0.1628131392/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0459 - acc: 0.1628131840/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0458 - acc: 0.1628132288/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0457 - acc: 0.1628132800/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0454 - acc: 0.1628133312/200298 [==================&gt;...........] - ETA: 7s - loss: 3.0452 - acc: 0.1629133760/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0450 - acc: 0.1629134208/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0448 - acc: 0.1629134656/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0443 - acc: 0.1630135104/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0439 - acc: 0.1630135552/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0437 - acc: 0.1631135936/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0436 - acc: 0.1631136384/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0434 - acc: 0.1631136768/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0433 - acc: 0.1631137152/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0431 - acc: 0.1631137600/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0429 - acc: 0.1631137984/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0428 - acc: 0.1631138432/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0424 - acc: 0.1632138816/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0422 - acc: 0.1632139200/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0421 - acc: 0.1632139648/200298 [===================&gt;..........] - ETA: 7s - loss: 3.0419 - acc: 0.1632140160/200298 [===================&gt;..........] - ETA: 6s - loss: 3.0416 - acc: 0.1633140608/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0413 - acc: 0.1633141056/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0412 - acc: 0.1633141568/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0407 - acc: 0.1633142080/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0405 - acc: 0.1634142528/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0401 - acc: 0.1634142976/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0399 - acc: 0.1635143488/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0397 - acc: 0.1635143936/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0394 - acc: 0.1635144384/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0390 - acc: 0.1636144832/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0387 - acc: 0.1636145280/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0384 - acc: 0.1636145792/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0380 - acc: 0.1636146240/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0378 - acc: 0.1637146688/200298 [====================&gt;.........] - ETA: 6s - loss: 3.0375 - acc: 0.1637147200/200298 [=====================&gt;........] - ETA: 6s - loss: 3.0374 - acc: 0.1637147648/200298 [=====================&gt;........] - ETA: 6s - loss: 3.0372 - acc: 0.1637148096/200298 [=====================&gt;........] - ETA: 6s - loss: 3.0370 - acc: 0.1637148544/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0366 - acc: 0.1638148992/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0365 - acc: 0.1638149440/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0362 - acc: 0.1639149888/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0360 - acc: 0.1639150336/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0360 - acc: 0.1639150784/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0358 - acc: 0.1639151232/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0357 - acc: 0.1639151680/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0354 - acc: 0.1640152128/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0351 - acc: 0.1640152576/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0351 - acc: 0.1641153024/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0347 - acc: 0.1641153472/200298 [=====================&gt;........] - ETA: 5s - loss: 3.0346 - acc: 0.1641153856/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0344 - acc: 0.1642154304/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0343 - acc: 0.1642154752/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0342 - acc: 0.1642155200/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0339 - acc: 0.1643155584/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0338 - acc: 0.1643155968/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0335 - acc: 0.1644156416/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0333 - acc: 0.1644156864/200298 [======================&gt;.......] - ETA: 5s - loss: 3.0331 - acc: 0.1644157312/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0328 - acc: 0.1645157696/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0326 - acc: 0.1645158144/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0325 - acc: 0.1645158592/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0323 - acc: 0.1646159040/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0321 - acc: 0.1646159488/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0321 - acc: 0.1646159936/200298 [======================&gt;.......] - ETA: 4s - loss: 3.0319 - acc: 0.1647160384/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0320 - acc: 0.1646160832/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0320 - acc: 0.1646161280/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0319 - acc: 0.1646161728/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0316 - acc: 0.1647162176/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0313 - acc: 0.1647162624/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0314 - acc: 0.1647163072/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0312 - acc: 0.1647163520/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0310 - acc: 0.1647163904/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0309 - acc: 0.1647164288/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0307 - acc: 0.1648164672/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0306 - acc: 0.1648165120/200298 [=======================&gt;......] - ETA: 4s - loss: 3.0304 - acc: 0.1648</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Checking the model is very similar to what we did before:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[209]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_nexts_keras</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_indices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idxs</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span> <span class="c1">#print the original input</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">chars</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">o</span><span class="p">)]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_nexts_keras</span><span class="p">(</span><span class="s1">&#39;don&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;d&#39;, &#39;o&#39;, &#39;n&#39;]
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[210]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[&#39;e&#39;, &#39; &#39;, &#39;t&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's try again with cs=8:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[256]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cs</span><span class="o">=</span><span class="mi">8</span>
<span class="n">c_in_dat</span> <span class="o">=</span> <span class="p">[[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cs</span><span class="p">)]</span>
<span class="c1"># c_out_dat is identical to c_in_dat, but moved across 1 character. </span>
<span class="n">c_out_dat</span> <span class="o">=</span> <span class="p">[[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">)]</span> 
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cs</span><span class="p">)]</span>
<span class="n">xs_8</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c_in_dat</span><span class="p">]</span>
<span class="n">ys_8</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c_out_dat</span><span class="p">]</span>
<span class="n">xs_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xs_8</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ys_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ys_8</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[257]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ys_8</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[257]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(75110, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[258]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs_8</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[258]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(75110, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[259]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs_8</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[259]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([[39, 41, 28, ..., 26, 28,  0],
       [ 0,  0, 42, ..., 39, 38, 42],
       [32, 37, 30, ..., 60, 53, 72],
       ...,
       [71, 72, 61, ...,  1, 75, 67],
       [70, 64, 56, ..., 71,  1, 72],
       [60, 57,  1, ..., 56, 61, 55]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[260]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">vocab_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">86</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[261]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">cs</span><span class="p">),</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">inner_init</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">),</span>
        <span class="n">TimeDistributed</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\ipykernel\__main__.py:4: UserWarning: Update your `SimpleRNN` call to the Keras 2 API: `SimpleRNN(256, return_sequences=True, recurrent_initializer=&#34;identity&#34;, activation=&#34;relu&#34;)`
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[262]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 8, 42)             3612      
_________________________________________________________________
simple_rnn_16 (SimpleRNN)    (None, 8, 256)            76544     
_________________________________________________________________
time_distributed_10 (TimeDis (None, 8, 86)             22102     
=================================================================
Total params: 102,258
Trainable params: 102,258
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[263]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[274]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_rnn</span><span class="o">=</span><span class="n">xs_8</span>
<span class="n">y_rnn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">ys_8</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_rnn</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_rnn</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[274]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((75110, 8), (75110, 8, 1))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_rnn</span><span class="p">,</span> <span class="n">y_rnn</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\models.py:939: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn(&#39;The `nb_epoch` argument in `fit` &#39;
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/8
   64/75110 [..............................] - ETA: 20s - loss: 1.7412  320/75110 [..............................] - ETA: 16s - loss: 1.6732  576/75110 [..............................] - ETA: 16s - loss: 1.6829  768/75110 [..............................] - ETA: 17s - loss: 1.6873 1024/75110 [..............................] - ETA: 17s - loss: 1.7144 1280/75110 [..............................] - ETA: 16s - loss: 1.7103 1536/75110 [..............................] - ETA: 16s - loss: 1.7063 1728/75110 [..............................] - ETA: 16s - loss: 1.6962 1984/75110 [..............................] - ETA: 16s - loss: 1.6989 2240/75110 [..............................] - ETA: 16s - loss: 1.6952 2496/75110 [..............................] - ETA: 16s - loss: 1.6939 2752/75110 [&gt;.............................] - ETA: 16s - loss: 1.6992 3008/75110 [&gt;.............................] - ETA: 16s - loss: 1.6972 3264/75110 [&gt;.............................] - ETA: 16s - loss: 1.7029 3456/75110 [&gt;.............................] - ETA: 16s - loss: 1.7000 3712/75110 [&gt;.............................] - ETA: 16s - loss: 1.6975 3968/75110 [&gt;.............................] - ETA: 16s - loss: 1.6932 4224/75110 [&gt;.............................] - ETA: 16s - loss: 1.6934 4480/75110 [&gt;.............................] - ETA: 16s - loss: 1.6944 4736/75110 [&gt;.............................] - ETA: 16s - loss: 1.6945 4992/75110 [&gt;.............................] - ETA: 16s - loss: 1.6976 5248/75110 [=&gt;............................] - ETA: 16s - loss: 1.6989 5504/75110 [=&gt;............................] - ETA: 16s - loss: 1.6966 5760/75110 [=&gt;............................] - ETA: 16s - loss: 1.6984 6016/75110 [=&gt;............................] - ETA: 15s - loss: 1.6990 6272/75110 [=&gt;............................] - ETA: 15s - loss: 1.7002 6528/75110 [=&gt;............................] - ETA: 15s - loss: 1.6984 6784/75110 [=&gt;............................] - ETA: 15s - loss: 1.6978 7040/75110 [=&gt;............................] - ETA: 15s - loss: 1.6980 7296/75110 [=&gt;............................] - ETA: 15s - loss: 1.6999 7552/75110 [==&gt;...........................] - ETA: 15s - loss: 1.7000 7744/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6998 8000/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6975 8192/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6962 8384/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6951 8576/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6955 8768/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6948 8960/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6948 9216/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6948 9472/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6943 9728/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6942 9984/75110 [==&gt;...........................] - ETA: 15s - loss: 1.694510240/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694710496/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694910752/75110 [===&gt;..........................] - ETA: 15s - loss: 1.693911008/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694011264/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694911520/75110 [===&gt;..........................] - ETA: 15s - loss: 1.695111776/75110 [===&gt;..........................] - ETA: 14s - loss: 1.694912032/75110 [===&gt;..........................] - ETA: 14s - loss: 1.695412288/75110 [===&gt;..........................] - ETA: 14s - loss: 1.696512544/75110 [====&gt;.........................] - ETA: 14s - loss: 1.696312800/75110 [====&gt;.........................] - ETA: 14s - loss: 1.696513056/75110 [====&gt;.........................] - ETA: 14s - loss: 1.697013312/75110 [====&gt;.........................] - ETA: 14s - loss: 1.698113568/75110 [====&gt;.........................] - ETA: 14s - loss: 1.699113824/75110 [====&gt;.........................] - ETA: 14s - loss: 1.700014080/75110 [====&gt;.........................] - ETA: 14s - loss: 1.700314336/75110 [====&gt;.........................] - ETA: 14s - loss: 1.700214592/75110 [====&gt;.........................] - ETA: 14s - loss: 1.699714848/75110 [====&gt;.........................] - ETA: 14s - loss: 1.698615104/75110 [=====&gt;........................] - ETA: 14s - loss: 1.698015360/75110 [=====&gt;........................] - ETA: 14s - loss: 1.698815616/75110 [=====&gt;........................] - ETA: 13s - loss: 1.698715872/75110 [=====&gt;........................] - ETA: 13s - loss: 1.700116128/75110 [=====&gt;........................] - ETA: 13s - loss: 1.700316384/75110 [=====&gt;........................] - ETA: 13s - loss: 1.700216640/75110 [=====&gt;........................] - ETA: 13s - loss: 1.699016896/75110 [=====&gt;........................] - ETA: 13s - loss: 1.699817152/75110 [=====&gt;........................] - ETA: 13s - loss: 1.699517408/75110 [=====&gt;........................] - ETA: 13s - loss: 1.699417664/75110 [======&gt;.......................] - ETA: 13s - loss: 1.698817920/75110 [======&gt;.......................] - ETA: 13s - loss: 1.699118176/75110 [======&gt;.......................] - ETA: 13s - loss: 1.699518432/75110 [======&gt;.......................] - ETA: 13s - loss: 1.700418688/75110 [======&gt;.......................] - ETA: 13s - loss: 1.700018944/75110 [======&gt;.......................] - ETA: 13s - loss: 1.700319200/75110 [======&gt;.......................] - ETA: 13s - loss: 1.700419456/75110 [======&gt;.......................] - ETA: 13s - loss: 1.700719712/75110 [======&gt;.......................] - ETA: 12s - loss: 1.700519968/75110 [======&gt;.......................] - ETA: 12s - loss: 1.700420224/75110 [=======&gt;......................] - ETA: 12s - loss: 1.700420480/75110 [=======&gt;......................] - ETA: 12s - loss: 1.700620736/75110 [=======&gt;......................] - ETA: 12s - loss: 1.700620992/75110 [=======&gt;......................] - ETA: 12s - loss: 1.700921248/75110 [=======&gt;......................] - ETA: 12s - loss: 1.701721504/75110 [=======&gt;......................] - ETA: 12s - loss: 1.702221760/75110 [=======&gt;......................] - ETA: 12s - loss: 1.702322016/75110 [=======&gt;......................] - ETA: 12s - loss: 1.702122272/75110 [=======&gt;......................] - ETA: 12s - loss: 1.701922528/75110 [=======&gt;......................] - ETA: 12s - loss: 1.701522784/75110 [========&gt;.....................] - ETA: 12s - loss: 1.701023040/75110 [========&gt;.....................] - ETA: 12s - loss: 1.701423296/75110 [========&gt;.....................] - ETA: 12s - loss: 1.701523552/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701523808/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701824064/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701124320/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701524576/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701524832/75110 [========&gt;.....................] - ETA: 11s - loss: 1.701525088/75110 [=========&gt;....................] - ETA: 11s - loss: 1.701725344/75110 [=========&gt;....................] - ETA: 11s - loss: 1.701425600/75110 [=========&gt;....................] - ETA: 11s - loss: 1.701725856/75110 [=========&gt;....................] - ETA: 11s - loss: 1.702026112/75110 [=========&gt;....................] - ETA: 11s - loss: 1.701926368/75110 [=========&gt;....................] - ETA: 11s - loss: 1.702026624/75110 [=========&gt;....................] - ETA: 11s - loss: 1.702426880/75110 [=========&gt;....................] - ETA: 11s - loss: 1.702927136/75110 [=========&gt;....................] - ETA: 11s - loss: 1.703427392/75110 [=========&gt;....................] - ETA: 11s - loss: 1.703127648/75110 [==========&gt;...................] - ETA: 10s - loss: 1.702827904/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703028160/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703628416/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703728608/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703828864/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703629120/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703729376/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703229632/75110 [==========&gt;...................] - ETA: 10s - loss: 1.703429888/75110 [==========&gt;...................] - ETA: 10s - loss: 1.704130144/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704230400/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704130656/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704430912/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704431168/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704231424/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704331616/75110 [===========&gt;..................] - ETA: 10s - loss: 1.704831872/75110 [===========&gt;..................] - ETA: 9s - loss: 1.7046 32064/75110 [===========&gt;..................] - ETA: 9s - loss: 1.704532320/75110 [===========&gt;..................] - ETA: 9s - loss: 1.704632512/75110 [===========&gt;..................] - ETA: 9s - loss: 1.704432704/75110 [============&gt;.................] - ETA: 9s - loss: 1.703932960/75110 [============&gt;.................] - ETA: 9s - loss: 1.703933152/75110 [============&gt;.................] - ETA: 9s - loss: 1.703933408/75110 [============&gt;.................] - ETA: 9s - loss: 1.703933664/75110 [============&gt;.................] - ETA: 9s - loss: 1.703933920/75110 [============&gt;.................] - ETA: 9s - loss: 1.703934176/75110 [============&gt;.................] - ETA: 9s - loss: 1.704334432/75110 [============&gt;.................] - ETA: 9s - loss: 1.704634688/75110 [============&gt;.................] - ETA: 9s - loss: 1.704734944/75110 [============&gt;.................] - ETA: 9s - loss: 1.704435200/75110 [=============&gt;................] - ETA: 9s - loss: 1.704335456/75110 [=============&gt;................] - ETA: 9s - loss: 1.704335712/75110 [=============&gt;................] - ETA: 9s - loss: 1.704235968/75110 [=============&gt;................] - ETA: 9s - loss: 1.704336224/75110 [=============&gt;................] - ETA: 9s - loss: 1.704636480/75110 [=============&gt;................] - ETA: 8s - loss: 1.704836736/75110 [=============&gt;................] - ETA: 8s - loss: 1.705236992/75110 [=============&gt;................] - ETA: 8s - loss: 1.705237248/75110 [=============&gt;................] - ETA: 8s - loss: 1.705537504/75110 [=============&gt;................] - ETA: 8s - loss: 1.705637760/75110 [==============&gt;...............] - ETA: 8s - loss: 1.705838016/75110 [==============&gt;...............] - ETA: 8s - loss: 1.705838272/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706138528/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706338784/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706339040/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706339296/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706139552/75110 [==============&gt;...............] - ETA: 8s - loss: 1.705939808/75110 [==============&gt;...............] - ETA: 8s - loss: 1.706040064/75110 [===============&gt;..............] - ETA: 8s - loss: 1.706040320/75110 [===============&gt;..............] - ETA: 8s - loss: 1.706040576/75110 [===============&gt;..............] - ETA: 8s - loss: 1.706140832/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706041088/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706141344/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706141600/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706341856/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706242112/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706342368/75110 [===============&gt;..............] - ETA: 7s - loss: 1.706442624/75110 [================&gt;.............] - ETA: 7s - loss: 1.706742880/75110 [================&gt;.............] - ETA: 7s - loss: 1.706743136/75110 [================&gt;.............] - ETA: 7s - loss: 1.706743392/75110 [================&gt;.............] - ETA: 7s - loss: 1.706643648/75110 [================&gt;.............] - ETA: 7s - loss: 1.706943904/75110 [================&gt;.............] - ETA: 7s - loss: 1.706944160/75110 [================&gt;.............] - ETA: 7s - loss: 1.706944416/75110 [================&gt;.............] - ETA: 7s - loss: 1.706944672/75110 [================&gt;.............] - ETA: 7s - loss: 1.707244928/75110 [================&gt;.............] - ETA: 7s - loss: 1.707345120/75110 [=================&gt;............] - ETA: 6s - loss: 1.707545376/75110 [=================&gt;............] - ETA: 6s - loss: 1.707645632/75110 [=================&gt;............] - ETA: 6s - loss: 1.707845888/75110 [=================&gt;............] - ETA: 6s - loss: 1.708046144/75110 [=================&gt;............] - ETA: 6s - loss: 1.708246400/75110 [=================&gt;............] - ETA: 6s - loss: 1.708146656/75110 [=================&gt;............] - ETA: 6s - loss: 1.708046912/75110 [=================&gt;............] - ETA: 6s - loss: 1.707747168/75110 [=================&gt;............] - ETA: 6s - loss: 1.707947424/75110 [=================&gt;............] - ETA: 6s - loss: 1.707647680/75110 [==================&gt;...........] - ETA: 6s - loss: 1.707747936/75110 [==================&gt;...........] - ETA: 6s - loss: 1.707848192/75110 [==================&gt;...........] - ETA: 6s - loss: 1.708048448/75110 [==================&gt;...........] - ETA: 6s - loss: 1.708248704/75110 [==================&gt;...........] - ETA: 6s - loss: 1.708148960/75110 [==================&gt;...........] - ETA: 6s - loss: 1.708649216/75110 [==================&gt;...........] - ETA: 6s - loss: 1.708849472/75110 [==================&gt;...........] - ETA: 5s - loss: 1.708949728/75110 [==================&gt;...........] - ETA: 5s - loss: 1.709049984/75110 [==================&gt;...........] - ETA: 5s - loss: 1.708850240/75110 [===================&gt;..........] - ETA: 5s - loss: 1.708750496/75110 [===================&gt;..........] - ETA: 5s - loss: 1.708950752/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709051008/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709051264/75110 [===================&gt;..........] - ETA: 5s - loss: 1.708751520/75110 [===================&gt;..........] - ETA: 5s - loss: 1.708951776/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709052032/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709152288/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709252544/75110 [===================&gt;..........] - ETA: 5s - loss: 1.709652800/75110 [====================&gt;.........] - ETA: 5s - loss: 1.709553056/75110 [====================&gt;.........] - ETA: 5s - loss: 1.709553312/75110 [====================&gt;.........] - ETA: 5s - loss: 1.709653568/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709653824/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709454080/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709254336/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709254592/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709254848/75110 [====================&gt;.........] - ETA: 4s - loss: 1.709055104/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709055360/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709055552/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709055744/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709156000/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709256192/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709356384/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709356576/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709156832/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709157088/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709257344/75110 [=====================&gt;........] - ETA: 4s - loss: 1.709557600/75110 [======================&gt;.......] - ETA: 4s - loss: 1.709657856/75110 [======================&gt;.......] - ETA: 4s - loss: 1.709458112/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709558368/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709758624/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709758880/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709759136/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709759392/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709859648/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709859904/75110 [======================&gt;.......] - ETA: 3s - loss: 1.709760160/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709860416/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709760672/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709660928/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709561184/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709561440/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709361696/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709361952/75110 [=======================&gt;......] - ETA: 3s - loss: 1.709462208/75110 [=======================&gt;......] - ETA: 2s - loss: 1.709362464/75110 [=======================&gt;......] - ETA: 2s - loss: 1.709462720/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709562976/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709563232/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709363488/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709363744/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709264000/75110 [========================&gt;.....] - ETA: 2s - loss: 1.709064256/75110 [========================&gt;.....] - ETA: 2s - loss: 1.708864512/75110 [========================&gt;.....] - ETA: 2s - loss: 1.708864768/75110 [========================&gt;.....] - ETA: 2s - loss: 1.708965024/75110 [========================&gt;.....] - ETA: 2s - loss: 1.708965280/75110 [=========================&gt;....] - ETA: 2s - loss: 1.708865536/75110 [=========================&gt;....] - ETA: 2s - loss: 1.709165792/75110 [=========================&gt;....] - ETA: 2s - loss: 1.709066048/75110 [=========================&gt;....] - ETA: 2s - loss: 1.709266304/75110 [=========================&gt;....] - ETA: 2s - loss: 1.709366560/75110 [=========================&gt;....] - ETA: 1s - loss: 1.709366816/75110 [=========================&gt;....] - ETA: 1s - loss: 1.709267072/75110 [=========================&gt;....] - ETA: 1s - loss: 1.709167328/75110 [=========================&gt;....] - ETA: 1s - loss: 1.709067584/75110 [=========================&gt;....] - ETA: 1s - loss: 1.708867840/75110 [==========================&gt;...] - ETA: 1s - loss: 1.708968096/75110 [==========================&gt;...] - ETA: 1s - loss: 1.709168352/75110 [==========================&gt;...] - ETA: 1s - loss: 1.708968608/75110 [==========================&gt;...] - ETA: 1s - loss: 1.708968864/75110 [==========================&gt;...] - ETA: 1s - loss: 1.708969120/75110 [==========================&gt;...] - ETA: 1s - loss: 1.708969376/75110 [==========================&gt;...] - ETA: 1s - loss: 1.709069632/75110 [==========================&gt;...] - ETA: 1s - loss: 1.709069888/75110 [==========================&gt;...] - ETA: 1s - loss: 1.709070144/75110 [===========================&gt;..] - ETA: 1s - loss: 1.708870400/75110 [===========================&gt;..] - ETA: 1s - loss: 1.708870656/75110 [===========================&gt;..] - ETA: 1s - loss: 1.708870912/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708871168/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708671424/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708671680/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708671936/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708672192/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708672448/75110 [===========================&gt;..] - ETA: 0s - loss: 1.708672704/75110 [============================&gt;.] - ETA: 0s - loss: 1.708672960/75110 [============================&gt;.] - ETA: 0s - loss: 1.708773216/75110 [============================&gt;.] - ETA: 0s - loss: 1.708973472/75110 [============================&gt;.] - ETA: 0s - loss: 1.708973728/75110 [============================&gt;.] - ETA: 0s - loss: 1.709073984/75110 [============================&gt;.] - ETA: 0s - loss: 1.709274240/75110 [============================&gt;.] - ETA: 0s - loss: 1.709274496/75110 [============================&gt;.] - ETA: 0s - loss: 1.709074752/75110 [============================&gt;.] - ETA: 0s - loss: 1.709075008/75110 [============================&gt;.] - ETA: 0s - loss: 1.709175110/75110 [==============================] - 17s 232us/step - loss: 1.7091
Epoch 2/8
   64/75110 [..............................] - ETA: 19s - loss: 1.7369  320/75110 [..............................] - ETA: 17s - loss: 1.6723  576/75110 [..............................] - ETA: 17s - loss: 1.6838  832/75110 [..............................] - ETA: 17s - loss: 1.6965 1088/75110 [..............................] - ETA: 17s - loss: 1.7124 1344/75110 [..............................] - ETA: 17s - loss: 1.7015 1600/75110 [..............................] - ETA: 16s - loss: 1.6942 1856/75110 [..............................] - ETA: 16s - loss: 1.6965 2112/75110 [..............................] - ETA: 16s - loss: 1.6983 2368/75110 [..............................] - ETA: 16s - loss: 1.7051 2624/75110 [&gt;.............................] - ETA: 16s - loss: 1.7017 2816/75110 [&gt;.............................] - ETA: 16s - loss: 1.7003 3072/75110 [&gt;.............................] - ETA: 16s - loss: 1.6988 3328/75110 [&gt;.............................] - ETA: 16s - loss: 1.6947 3520/75110 [&gt;.............................] - ETA: 16s - loss: 1.6942 3712/75110 [&gt;.............................] - ETA: 16s - loss: 1.6956 3968/75110 [&gt;.............................] - ETA: 16s - loss: 1.6966 4224/75110 [&gt;.............................] - ETA: 16s - loss: 1.6955 4480/75110 [&gt;.............................] - ETA: 16s - loss: 1.6951 4736/75110 [&gt;.............................] - ETA: 16s - loss: 1.6960 4928/75110 [&gt;.............................] - ETA: 16s - loss: 1.6932 5120/75110 [=&gt;............................] - ETA: 16s - loss: 1.6931 5376/75110 [=&gt;............................] - ETA: 16s - loss: 1.6916 5632/75110 [=&gt;............................] - ETA: 16s - loss: 1.6934 5888/75110 [=&gt;............................] - ETA: 16s - loss: 1.6931 6144/75110 [=&gt;............................] - ETA: 16s - loss: 1.6923 6400/75110 [=&gt;............................] - ETA: 16s - loss: 1.6918 6656/75110 [=&gt;............................] - ETA: 16s - loss: 1.6916 6912/75110 [=&gt;............................] - ETA: 16s - loss: 1.6913 7168/75110 [=&gt;............................] - ETA: 16s - loss: 1.6941 7424/75110 [=&gt;............................] - ETA: 16s - loss: 1.6936 7680/75110 [==&gt;...........................] - ETA: 16s - loss: 1.6942 7936/75110 [==&gt;...........................] - ETA: 16s - loss: 1.6929 8192/75110 [==&gt;...........................] - ETA: 16s - loss: 1.6942 8448/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6925 8704/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6925 8960/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6917 9216/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6920 9472/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6921 9728/75110 [==&gt;...........................] - ETA: 15s - loss: 1.6920 9984/75110 [==&gt;...........................] - ETA: 15s - loss: 1.692610240/75110 [===&gt;..........................] - ETA: 15s - loss: 1.693510496/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694210752/75110 [===&gt;..........................] - ETA: 15s - loss: 1.694511008/75110 [===&gt;..........................] - ETA: 15s - loss: 1.692411264/75110 [===&gt;..........................] - ETA: 15s - loss: 1.692511520/75110 [===&gt;..........................] - ETA: 15s - loss: 1.692311776/75110 [===&gt;..........................] - ETA: 14s - loss: 1.693412032/75110 [===&gt;..........................] - ETA: 14s - loss: 1.693912288/75110 [===&gt;..........................] - ETA: 14s - loss: 1.693812544/75110 [====&gt;.........................] - ETA: 14s - loss: 1.692712800/75110 [====&gt;.........................] - ETA: 14s - loss: 1.694713056/75110 [====&gt;.........................] - ETA: 14s - loss: 1.694713312/75110 [====&gt;.........................] - ETA: 14s - loss: 1.694413504/75110 [====&gt;.........................] - ETA: 14s - loss: 1.695213760/75110 [====&gt;.........................] - ETA: 14s - loss: 1.695214016/75110 [====&gt;.........................] - ETA: 14s - loss: 1.695514272/75110 [====&gt;.........................] - ETA: 14s - loss: 1.696114528/75110 [====&gt;.........................] - ETA: 14s - loss: 1.695814784/75110 [====&gt;.........................] - ETA: 14s - loss: 1.695515040/75110 [=====&gt;........................] - ETA: 14s - loss: 1.695515296/75110 [=====&gt;........................] - ETA: 14s - loss: 1.694515552/75110 [=====&gt;........................] - ETA: 14s - loss: 1.694415808/75110 [=====&gt;........................] - ETA: 13s - loss: 1.694916064/75110 [=====&gt;........................] - ETA: 13s - loss: 1.695416320/75110 [=====&gt;........................]</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[279]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_nexts_keras</span><span class="p">(</span><span class="s1">&#39; this is&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39; &#39;, &#39;t&#39;, &#39;h&#39;, &#39;i&#39;, &#39;s&#39;, &#39; &#39;, &#39;i&#39;, &#39;s&#39;]
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[279]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[&#39;t&#39;, &#39;h&#39;, &#39;e&#39;, &#39;s&#39;, &#39; &#39;, &#39;m&#39;, &#39;s&#39;, &#39; &#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stateful-RNN">Stateful RNN<a class="anchor-link" href="#Stateful-RNN">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ideally, we want to expose the network to the entire sequence and let it learn the inter-dependencies, rather than us define those dependencies explicitly in the framing of the problem.
You can set RNN layers to be 'stateful', which means that the states computed for the samples in one batch will be reused as initial states for the samples in the next batch. This assumes a one-to-one mapping between samples in different successive batches.</p>
<p>A stateful model is easy to create (just add "stateful=True") but harder to train.</p>
<p>When using stateful in keras, you have to also add 'batch_input_shape' to the first layer, and fix the batch size there.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span><span class="o">=</span><span class="mi">200</span> <span class="c1"># the batch size</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.layers.embeddings</span> <span class="k">import</span> <span class="n">Embedding</span>
<span class="c1">#from keras.layers.recurrent import LSTM</span>
<span class="c1">#from keras.layers.normalization import BatchNormalization</span>
<span class="kn">from</span> <span class="nn">keras.layers.recurrent</span> <span class="k">import</span> <span class="n">SimpleRNN</span>
<span class="n">n_hidden</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_fac</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span> <span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_dim</span><span class="o">=</span> <span class="n">n_fac</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">batch_input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span><span class="n">input_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">stateful</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="n">output_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we're using a fixed batch shape, we have to ensure our inputs and outputs are an even multiple of the batch size.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span><span class="o">//</span><span class="n">bs</span><span class="o">*</span><span class="n">bs</span>
<span class="n">mx</span> <span class="c1"># the number of records that actually divides with bs^2</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[74]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>118200</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now fit the model, without shuffling the records, so that it can learn from the original sequence of samples.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">input_</span><span class="p">[:</span><span class="n">mx</span><span class="p">],</span> <span class="n">output_</span><span class="p">[:</span><span class="n">mx</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
118200/118200 [==============================] - 1109s - loss: nan - acc: 0.2235            
Epoch 2/5
118200/118200 [==============================] - 1141s - loss: nan - acc: 0.2245     
Epoch 3/5
118200/118200 [==============================] - 1131s - loss: nan - acc: 0.2245     
Epoch 4/5
118200/118200 [==============================] - 1133s - loss: nan - acc: 0.2245     
Epoch 5/5
100000/118200 [========================&gt;.....] - ETA: 174s - loss: nan - acc: 0.2259 </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Update to newer version and restart kernel in order for the following examples to work</span>
<span class="c1">#!pip install --upgrade keraspip install mkdocs</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generative-Adversarial-Networks--(GANs)">Generative Adversarial Networks  (GANs)<a class="anchor-link" href="#Generative-Adversarial-Networks--(GANs)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are models that can learn to create data that is similar to data that we give them.</p>
<p>The main idea behind a GAN is to have two competing neural network models. One takes noise as input and generates samples (and so is called the generator). The other model (called the discriminator) receives samples from both the generator and the training data, and has to be able to distinguish between the two sources. These two networks play a continuous game, where the generator is learning to produce more and more realistic samples, and the discriminator is learning to get better and better at distinguishing generated data from real data. These two networks are trained simultaneously, and the hope is that the competition will drive the generated samples to be indistinguishable from real data. ( <a href="http://blog.aylien.com/introduction-generative-adversarial-networks-code-tensorflow/">An introduction to Generative Adversarial Networks</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[428]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="k">import</span> <span class="n">HTML</span> 
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span> <span class="s2">&quot;http://blog.aylien.com/wp-content/uploads/2016/08/gan-768x432.png&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[428]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<img src="http://blog.aylien.com/wp-content/uploads/2016/08/gan-768x432.png"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See this <a href="https://www.youtube.com/watch?v=x0uWw8WLCVs">link</a> for a demonstration of a nice tool that is based on a GAN implementation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's train a GAN to generate Nietzsche's text, aided by some code examples: <a href="https://github.com/osh/KerasGAN/blob/master/MNIST_CNN_GAN.ipynb">KerasGAN</a> and <a href="https://github.com/maxhodak/keras-molecules/blob/gan/SMILES_GAN.ipynb">keras-molecules</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We first import all relevant modules:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">random</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;KERAS_BACKEND&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;theano&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;THEANO_FLAGS&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="s2">&quot;device=gpu</span><span class="si">%d</span><span class="s2">,lib.cnmem=0&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">theano</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="nn">T</span>
<span class="kn">from</span> <span class="nn">keras.utils</span> <span class="k">import</span> <span class="n">np_utils</span>
<span class="kn">import</span> <span class="nn">keras.models</span> <span class="k">as</span> <span class="nn">models</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Input</span><span class="p">,</span><span class="n">merge</span>
<span class="c1">#from keras.layers.core import Reshape,Dense,Dropout,Activation,Flatten#,MaxoutDense</span>
<span class="kn">from</span> <span class="nn">keras.activations</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.layers.wrappers</span> <span class="k">import</span> <span class="n">TimeDistributed</span>
<span class="kn">from</span> <span class="nn">keras.layers.noise</span> <span class="k">import</span> <span class="n">GaussianNoise</span>
<span class="kn">from</span> <span class="nn">keras.regularizers</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.layers.normalization</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.optimizers</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="k">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">keras</span> 

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../common&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">keras.utils</span> <span class="k">import</span> <span class="n">np_utils</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="n">tqdm</span>

<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="k">import</span> <span class="n">ReduceLROnPlateau</span>
<span class="c1">#from keras.utils import to_categorical</span>
<span class="kn">from</span> <span class="nn">keras.utils.np_utils</span> <span class="k">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span><span class="n">Concatenate</span>
<span class="kn">from</span> <span class="nn">keras.layers.recurrent</span> <span class="k">import</span> <span class="n">SimpleRNN</span><span class="p">,</span><span class="n">LSTM</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>ERROR (theano.sandbox.cuda): nvcc compiler not found on $PATH. Check your nvcc installation and try again.
Using Theano backend.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also define two help functions, the first will be used for describing the models improvement along the train process, the second will be used for freezing the discriminator's weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_loss</span><span class="p">(</span><span class="n">losses</span><span class="p">):</span>
    <span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Discriminative loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generative loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_trainable</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="n">net</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="n">val</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's set a many-to-many generator that accepts 3 charachters and predicts the following character for each.</p>
<p>idx is the representation of our text data with indices:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[39, 41, 28, 29, 24]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we prepare the required input, this time in matrix (1-hot) representation:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cs</span><span class="o">=</span><span class="mi">3</span>
<span class="n">c1_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">c2_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">c3_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">c4_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">cs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">c1_dat</span><span class="p">,</span><span class="n">c2_dat</span><span class="p">,</span><span class="n">c3_dat</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">c2_dat</span><span class="p">,</span><span class="n">c3_dat</span><span class="p">,</span><span class="n">c4_dat</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">oh_ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">]</span>
<span class="n">output__</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">oh_ys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">oh_xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">input__</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">oh_xs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The new input/output structure is:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input__</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">output__</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[20]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((600897, 3, 86), (600897, 3, 86))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here we convert it from 1-hot representation back to indices:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input__</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([[39, 41, 28],
       [41, 28, 29],
       [28, 29, 24],
       ...,
       [73, 64, 66],
       [64, 66, 57],
       [66, 57, 71]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output__</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([[41, 28, 29],
       [28, 29, 24],
       [29, 24, 26],
       ...,
       [64, 66, 57],
       [66, 57, 71],
       [57, 71, 71]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are ready to define the network.</p>
<p>First we define a generator. Here we use a very similar model to the one we used before, this time the input is 1-hot instead of inices representation, so we ommited the embedding layer, and updfated the input_shape to be cs characters, each represented by a vector of size vocab_size.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hidden_size = 64</span>
<span class="n">batchSize</span><span class="o">=</span><span class="mi">256</span>
<span class="n">n_hidden</span><span class="o">=</span><span class="mi">256</span>
<span class="n">cs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_fac</span><span class="o">=</span><span class="mi">42</span>
<span class="n">vocab_size</span><span class="o">=</span><span class="mi">86</span>
<span class="c1">#generator=Sequential([</span>
<span class="c1">#        SimpleRNN(n_hidden, return_sequences=True, input_shape=(cs, vocab_size),</span>
<span class="c1">#                  activation=&#39;relu&#39;),</span>
<span class="c1">#        TimeDistributed(Dense(vocab_size, activation=&#39;softmax&#39;)),</span>
<span class="c1">#    ])</span>

<span class="n">generator</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span>
                  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">inner_init</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">),</span>
        <span class="n">TimeDistributed</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)),</span>
    <span class="p">])</span>
<span class="n">generator</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(),</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\ipykernel\__main__.py:15: UserWarning: Update your `SimpleRNN` call to the Keras 2 API: `SimpleRNN(256, return_sequences=True, activation=&#34;relu&#34;, recurrent_initializer=&#34;identity&#34;, input_shape=(3, 86))`
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">generator</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
simple_rnn_13 (SimpleRNN)    (None, 3, 256)            87808     
_________________________________________________________________
time_distributed_11 (TimeDis (None, 3, 86)             22102     
=================================================================
Total params: 109,910
Trainable params: 109,910
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After successfully compiling the generator, we define a discriminator that usees a similar RNN layer, but then outputs two possible outcomes (2 hidden nodes in the last layer): real or fake.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#discriminator=Sequential([</span>
<span class="c1">#        SimpleRNN(n_hidden,activation=&#39;relu&#39;,input_shape=(cs, vocab_size)),</span>
<span class="c1">#        Dense(2, activation=&#39;softmax&#39;)</span>
<span class="c1">#    ])</span>
<span class="n">discriminator</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">SimpleRNN</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span>
                  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">),</span>
    <span class="p">])</span>
<span class="n">discriminator</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">())</span>
<span class="n">discriminator</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
simple_rnn_14 (SimpleRNN)    (None, 256)               87808     
_________________________________________________________________
dense_14 (Dense)             (None, 2)                 514       
=================================================================
Total params: 88,322
Trainable params: 88,322
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we build the entire GAN model: The generator accepts the input (named gan_input) and its output is used as the input of the discriminator. 
We name the discriminator's output gan_V, and define a model that transfers gan_input to gan_V.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Freeze weights in the discriminator for stacked training</span>
<span class="n">make_trainable</span><span class="p">(</span><span class="n">discriminator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Build stacked GAN model</span>
<span class="n">gan_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="n">cs</span><span class="p">,</span><span class="n">vocab_size</span><span class="p">])</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="n">gan_input</span><span class="p">)</span>
<span class="n">gan_V</span> <span class="o">=</span> <span class="n">discriminator</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">GAN</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gan_input</span><span class="p">,</span> <span class="n">gan_V</span><span class="p">)</span>
<span class="n">GAN</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">())</span>
<span class="n">GAN</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 3, 86)             0         
_________________________________________________________________
sequential_13 (Sequential)   (None, 3, 86)             109910    
_________________________________________________________________
sequential_14 (Sequential)   (None, 2)                 88322     
=================================================================
Total params: 198,232
Trainable params: 109,910
Non-trainable params: 88,322
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have about 600,000 input records, to make it faster for this class, let's use only a sample of size ntrain = 100000</p>
<p>We define two input sets, and eventually concatenate it into a single input:</p>
<ol>
<li>(XT,YT) are the real input\output texts samples (each input or output sample is a 3-gram)</li>
<li>(noise_gen,generated) are the randomly generated input samples and its generated output.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ntrain</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">trainidx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">input__</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ntrain</span><span class="p">)</span>
<span class="n">XT</span> <span class="o">=</span> <span class="n">input__</span><span class="p">[</span><span class="n">trainidx</span><span class="p">]</span>
<span class="n">YT</span> <span class="o">=</span> <span class="n">output__</span><span class="p">[</span><span class="n">trainidx</span><span class="p">]</span>

<span class="c1">#noise_gen = np.random.choice(np.arange(vocab_size),size=[ntrain,cs])</span>
<span class="n">noise_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">XT</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">XT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
     <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">XT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">XT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">noise_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">generated</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">noise_gen</span><span class="p">)</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">generated</span><span class="p">,</span><span class="n">XT</span><span class="p">))</span>
<span class="c1"># set target: first half as fake and second half as real samples</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">XT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">y</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[49]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>((200000, 3, 86), (200000, 2))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pretraining the generator...
We get lower accuracies, probably since we removed the embedding layer in this 1-hot input version.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pretrain</span><span class="p">(</span><span class="n">n_pretrain</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">nb_epoch</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">input__</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">n_pretrain</span><span class="p">)</span>
    <span class="n">text_batch</span> <span class="o">=</span> <span class="n">input__</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
    <span class="n">text__output_batch</span> <span class="o">=</span> <span class="n">output__</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
    <span class="n">noise_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_pretrain</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="n">vocab_size</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
    <span class="n">noise_output_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_pretrain</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="n">vocab_size</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_pretrain</span><span class="p">):</span>
         <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>
            <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">))</span>
            <span class="n">noise_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">noise_output_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">noise_output_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">cs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">))]</span><span class="o">=</span><span class="mf">1.</span>
    <span class="c1">#noise_gen = np.random.choice(np.arange(vocab_size),size=[n_pretrain,cs])</span>
    <span class="c1">#noise_gen = np.random.choice([0,1],size=(n_pretrain,input__.shape[1],input__.shape[2]))</span>
    <span class="c1">#noise_output_gen = np.random.choice([0,1],size=(n_pretrain,cs))#input__.shape[1],input__.shape[2]))</span>
    <span class="c1">#generated_texts = generator.predict([noise_gen,noise_gen])</span>
    <span class="n">make_trainable</span><span class="p">(</span><span class="n">discriminator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="c1">#smiles_batch = data_train[np.random.choice(data_train.shape[0], size = n_pretrain)]</span>
    <span class="c1">#noise_gen = np.random.normal(0, 1, size=[n_pretrain, 100])</span>
    <span class="n">generator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">noise_gen</span><span class="p">,</span>
        <span class="n">noise_output_gen</span><span class="p">,</span>
        <span class="n">nb_epoch</span> <span class="o">=</span> <span class="n">nb_epoch</span><span class="p">,</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span>
                              <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
                              <span class="n">patience</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                              <span class="n">min_lr</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrain</span><span class="p">(</span><span class="n">n_pretrain</span><span class="o">=</span><span class="mi">600000</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\models.py:939: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn(&#39;The `nb_epoch` argument in `fit` &#39;
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/8
    64/600000 [..............................] - ETA: 4:51 - loss: 4.4638 - acc: 0.0208   512/600000 [..............................] - ETA: 1:35 - loss: 4.4592 - acc: 0.0150   896/600000 [..............................] - ETA: 1:27 - loss: 4.4592 - acc: 0.0123  1280/600000 [..............................] - ETA: 1:25 - loss: 4.4591 - acc: 0.0117  1728/600000 [..............................] - ETA: 1:21 - loss: 4.4592 - acc: 0.0118  2112/600000 [..............................] - ETA: 1:21 - loss: 4.4603 - acc: 0.0117  2560/600000 [..............................] - ETA: 1:20 - loss: 4.4591 - acc: 0.0126  2944/600000 [..............................] - ETA: 1:20 - loss: 4.4596 - acc: 0.0119  3392/600000 [..............................] - ETA: 1:19 - loss: 4.4597 - acc: 0.0111  3840/600000 [..............................] - ETA: 1:18 - loss: 4.4594 - acc: 0.0108  4352/600000 [..............................] - ETA: 1:16 - loss: 4.4593 - acc: 0.0106  4864/600000 [..............................] - ETA: 1:15 - loss: 4.4594 - acc: 0.0113  5376/600000 [..............................] - ETA: 1:14 - loss: 4.4592 - acc: 0.0115  5824/600000 [..............................] - ETA: 1:13 - loss: 4.4592 - acc: 0.0119  6336/600000 [..............................] - ETA: 1:12 - loss: 4.4591 - acc: 0.0127  6784/600000 [..............................] - ETA: 1:12 - loss: 4.4591 - acc: 0.0125  7296/600000 [..............................] - ETA: 1:11 - loss: 4.4591 - acc: 0.0125  7744/600000 [..............................] - ETA: 1:11 - loss: 4.4590 - acc: 0.0125  8192/600000 [..............................] - ETA: 1:10 - loss: 4.4587 - acc: 0.0126  8704/600000 [..............................] - ETA: 1:10 - loss: 4.4587 - acc: 0.0124  9216/600000 [..............................] - ETA: 1:09 - loss: 4.4589 - acc: 0.0121  9728/600000 [..............................] - ETA: 1:08 - loss: 4.4586 - acc: 0.0123 10240/600000 [..............................] - ETA: 1:08 - loss: 4.4585 - acc: 0.0121 10752/600000 [..............................] - ETA: 1:08 - loss: 4.4584 - acc: 0.0118 11264/600000 [..............................] - ETA: 1:07 - loss: 4.4583 - acc: 0.0118 11712/600000 [..............................] - ETA: 1:08 - loss: 4.4583 - acc: 0.0120 12160/600000 [..............................] - ETA: 1:07 - loss: 4.4583 - acc: 0.0120 12672/600000 [..............................] - ETA: 1:07 - loss: 4.4584 - acc: 0.0119 13184/600000 [..............................] - ETA: 1:07 - loss: 4.4583 - acc: 0.0121 13696/600000 [..............................] - ETA: 1:07 - loss: 4.4582 - acc: 0.0121 14144/600000 [..............................] - ETA: 1:06 - loss: 4.4581 - acc: 0.0121 14656/600000 [..............................] - ETA: 1:06 - loss: 4.4582 - acc: 0.0120 15168/600000 [..............................] - ETA: 1:06 - loss: 4.4582 - acc: 0.0120 15680/600000 [..............................] - ETA: 1:06 - loss: 4.4581 - acc: 0.0119 16128/600000 [..............................] - ETA: 1:06 - loss: 4.4582 - acc: 0.0119 16640/600000 [..............................] - ETA: 1:06 - loss: 4.4581 - acc: 0.0118 17152/600000 [..............................] - ETA: 1:05 - loss: 4.4580 - acc: 0.0118 17664/600000 [..............................] - ETA: 1:05 - loss: 4.4579 - acc: 0.0118 18176/600000 [..............................] - ETA: 1:05 - loss: 4.4580 - acc: 0.0116 18688/600000 [..............................] - ETA: 1:05 - loss: 4.4580 - acc: 0.0115 19200/600000 [..............................] - ETA: 1:05 - loss: 4.4580 - acc: 0.0116 19712/600000 [..............................] - ETA: 1:04 - loss: 4.4579 - acc: 0.0116 20224/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4579 - acc: 0.0116 20736/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4579 - acc: 0.0115 21184/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0115 21696/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0116 22208/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0116 22720/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0116 23168/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0116 23680/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4578 - acc: 0.0116 24192/600000 [&gt;.............................] - ETA: 1:04 - loss: 4.4577 - acc: 0.0115 24704/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4577 - acc: 0.0114 25216/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4577 - acc: 0.0114 25728/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4577 - acc: 0.0113 26240/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4577 - acc: 0.0114 26752/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4576 - acc: 0.0114 27264/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4576 - acc: 0.0113 27776/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4576 - acc: 0.0114 28288/600000 [&gt;.............................] - ETA: 1:03 - loss: 4.4576 - acc: 0.0113 28800/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4576 - acc: 0.0114 29312/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4576 - acc: 0.0115 29760/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4575 - acc: 0.0114 30208/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4575 - acc: 0.0114 30720/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4575 - acc: 0.0114 31232/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4575 - acc: 0.0114 31744/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4574 - acc: 0.0114 32192/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4574 - acc: 0.0114 32704/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4574 - acc: 0.0114 33216/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4574 - acc: 0.0114 33664/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4573 - acc: 0.0114 34112/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4573 - acc: 0.0114 34624/600000 [&gt;.............................] - ETA: 1:02 - loss: 4.4573 - acc: 0.0115 35136/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4572 - acc: 0.0115 35584/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4572 - acc: 0.0115 36096/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4572 - acc: 0.0115 36608/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0114 37120/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0114 37632/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0114 38144/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 38592/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 39104/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4572 - acc: 0.0115 39552/600000 [&gt;.............................] - ETA: 1:01 - loss: 4.4572 - acc: 0.0115 40064/600000 [=&gt;............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 40512/600000 [=&gt;............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 41024/600000 [=&gt;............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 41536/600000 [=&gt;............................] - ETA: 1:01 - loss: 4.4571 - acc: 0.0115 42048/600000 [=&gt;............................] - ETA: 1:01 - loss: 4.4570 - acc: 0.0115 42560/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4570 - acc: 0.0115 43072/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4570 - acc: 0.0116 43584/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4570 - acc: 0.0116 44096/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4570 - acc: 0.0116 44544/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4570 - acc: 0.0116 45056/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 45504/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0116 46016/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0116 46464/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0116 46976/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 47424/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 47936/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 48448/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 48960/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 49472/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4569 - acc: 0.0117 49984/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0117 50432/600000 [=&gt;............................] - ETA: 59s - loss: 4.4568 - acc: 0.0118  50880/600000 [=&gt;............................] - ETA: 59s - loss: 4.4568 - acc: 0.0118 51264/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0118 51712/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0118 52096/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0118 52480/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0118 52864/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4568 - acc: 0.0118 53312/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4567 - acc: 0.0118 53760/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4567 - acc: 0.0118 54208/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4567 - acc: 0.0118 54720/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4567 - acc: 0.0118 55232/600000 [=&gt;............................] - ETA: 1:00 - loss: 4.4567 - acc: 0.0118 55744/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0118  56256/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0118 56704/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0118 57152/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0118 57600/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0117 58048/600000 [=&gt;............................] - ETA: 59s - loss: 4.4567 - acc: 0.0117 58560/600000 [=&gt;............................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 59072/600000 [=&gt;............................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 59584/600000 [=&gt;............................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 60032/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 60544/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 61056/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 61504/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 61952/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 62400/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 62848/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0117 63360/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0116 63872/600000 [==&gt;...........................] - ETA: 59s - loss: 4.4566 - acc: 0.0116 64384/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4566 - acc: 0.0116 64832/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4566 - acc: 0.0116 65280/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4566 - acc: 0.0116 65728/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4566 - acc: 0.0116 66240/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 66752/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 67200/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 67712/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 68224/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 68736/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 69184/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 69632/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 70080/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 70528/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 70976/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4565 - acc: 0.0116 71488/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4564 - acc: 0.0116 72000/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4564 - acc: 0.0116 72512/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4564 - acc: 0.0116 72960/600000 [==&gt;...........................] - ETA: 58s - loss: 4.4564 - acc: 0.0115 73408/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4565 - acc: 0.0115 73856/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 74368/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 74880/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 75392/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 75840/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 76352/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0115 76864/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 77312/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 77824/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 78336/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 78784/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 79232/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4564 - acc: 0.0116 79680/600000 [==&gt;...........................] - ETA: 57s - loss: 4.4563 - acc: 0.0117 80128/600000 [===&gt;..........................] - ETA: 57s - loss: 4.4563 - acc: 0.0116 80640/600000 [===&gt;..........................] - ETA: 57s - loss: 4.4563 - acc: 0.0116 81152/600000 [===&gt;..........................] - ETA: 57s - loss: 4.4563 - acc: 0.0116 81600/600000 [===&gt;..........................] - ETA: 57s - loss: 4.4563 - acc: 0.0116 82112/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0116 82560/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 83072/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 83584/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 84096/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 84608/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 85056/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 85568/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 86080/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 86592/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0116 87040/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0116 87552/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 88064/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4563 - acc: 0.0117 88512/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4562 - acc: 0.0117 88960/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4562 - acc: 0.0117 89408/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4562 - acc: 0.0117 89920/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4562 - acc: 0.0117 90368/600000 [===&gt;..........................] - ETA: 56s - loss: 4.4562 - acc: 0.0117 90880/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 91328/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 91776/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 92224/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 92736/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 93248/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 93696/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 94144/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 94656/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 95168/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 95680/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 96128/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 96576/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 97088/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 97600/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 98048/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4562 - acc: 0.0117 98560/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4561 - acc: 0.0116 99072/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117 99520/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117 99968/600000 [===&gt;..........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117100352/600000 [====&gt;.........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117100736/600000 [====&gt;.........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117101184/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0117101568/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0117101952/600000 [====&gt;.........................] - ETA: 55s - loss: 4.4561 - acc: 0.0117102400/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0117102848/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0116103296/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0116103808/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0116104256/600000 [====&gt;.........................] - ETA: 54s - loss: 4.4561 - acc: 0.0117356352/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132356672/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132357056/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132357376/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132357696/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132358016/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132358336/600000 [================&gt;.............] - ETA: 37s - loss: 4.4531 - acc: 0.0132358720/600000 [================&gt;.............] - ETA: 36s - loss: 4.4531 - acc: 0.0132359104/600000 [================&gt;.............] - ETA: 36s - loss: 4.4531 - acc: 0.0132359424/600000 [================&gt;.............] - ETA: 36s - loss: 4.4531 - acc: 0.0132359808/600000 [================&gt;.............] - ETA: 36s - loss: 4.4531 - acc: 0.0132360192/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132360512/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132360896/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132361280/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132361600/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132361984/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132362368/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132362752/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132363136/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132363456/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132363840/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132364224/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132364608/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132364928/600000 [=================&gt;............] - ETA: 36s - loss: 4.4531 - acc: 0.0132365312/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132365696/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132366080/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132366464/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132366848/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132367232/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132367552/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132367936/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132368256/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132368640/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132369024/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132369344/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132369664/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132369984/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132370304/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132370624/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132371008/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132371392/600000 [=================&gt;............] - ETA: 35s - loss: 4.4531 - acc: 0.0132371712/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132372032/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132372352/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132372736/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132373056/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132373376/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132373760/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132374144/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132374528/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132374912/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132375296/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132375680/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132376000/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132376384/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132376704/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132377088/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132377408/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132377728/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132378048/600000 [=================&gt;............] - ETA: 34s - loss: 4.4531 - acc: 0.0132378368/600000 [=================&gt;............] - ETA: 33s - loss: 4.4531 - acc: 0.0132378688/600000 [=================&gt;............] - ETA: 33s - loss: 4.4531 - acc: 0.0132379008/600000 [=================&gt;............] - ETA: 33s - loss: 4.4531 - acc: 0.0132379328/600000 [=================&gt;............] - ETA: 33s - loss: 4.4531 - acc: 0.0132379712/600000 [=================&gt;............] - ETA: 33s - loss: 4.4531 - acc: 0.0132380096/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132380416/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132380736/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132381056/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132381376/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132381696/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132382016/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132382336/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132382656/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132383040/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132383424/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4532 - acc: 0.0132383808/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4531 - acc: 0.0132384192/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4532 - acc: 0.0132384576/600000 [==================&gt;...........] - ETA: 33s - loss: 4.4532 - acc: 0.0132384960/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132385344/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132385664/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132385984/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132386304/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132386624/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132387008/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132387392/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132387712/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132388032/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132388416/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132388736/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132389120/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132389440/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132389824/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132390208/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132390592/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132390912/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132391232/600000 [==================&gt;...........] - ETA: 32s - loss: 4.4532 - acc: 0.0132391616/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132391936/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132392320/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132392704/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132393088/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132393472/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132393856/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132394176/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132394560/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132394880/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132395200/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132395520/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132395904/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132396288/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132396608/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132396992/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132397312/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132397632/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132398016/600000 [==================&gt;...........] - ETA: 31s - loss: 4.4532 - acc: 0.0132398400/600000 [==================&gt;...........] - ETA: 30s - loss: 4.4532 - acc: 0.0132398720/600000 [==================&gt;...........] - ETA: 30s - loss: 4.4532 - acc: 0.0132399104/600000 [==================&gt;...........] - ETA: 30s - loss: 4.4532 - acc: 0.0132399488/600000 [==================&gt;...........] - ETA: 30s - loss: 4.4532 - acc: 0.0132399872/600000 [==================&gt;...........] - ETA: 30s - loss: 4.4532 - acc: 0.0132400256/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132400640/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132400960/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132401280/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132401600/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132401984/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132402304/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132402624/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132402944/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132403264/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132403584/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132403904/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132404224/600000 [===================&gt;..........] - ETA: 30s - loss: 4.4532 - acc: 0.0132404608/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132404928/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132405312/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132405696/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132406080/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132406464/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132406848/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132407168/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132407488/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132407808/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132408192/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132408512/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132408896/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132409280/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132409664/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132410048/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132410432/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132410752/600000 [===================&gt;..........] - ETA: 29s - loss: 4.4532 - acc: 0.0132411136/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132411456/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132411840/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132412160/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132412544/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132412928/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132413312/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132413696/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132414016/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132414336/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132414656/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132414976/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132415296/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132415616/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132415872/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132416192/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132416512/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132416832/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132417088/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132417408/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132417792/600000 [===================&gt;..........] - ETA: 28s - loss: 4.4532 - acc: 0.0132418112/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132418496/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132418880/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132419200/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132419584/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132419904/600000 [===================&gt;..........] - ETA: 27s - loss: 4.4532 - acc: 0.0132420288/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132420608/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132420992/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132421376/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132421760/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132422080/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132422400/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132422720/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132423040/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132423360/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132423680/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132424000/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132424320/600000 [====================&gt;.........] - ETA: 27s - loss: 4.4532 - acc: 0.0132424704/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132425088/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132425472/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132425792/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132426112/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132426432/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132426816/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132427136/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132427456/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132427776/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132428160/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132428480/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132428864/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132429248/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132429568/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132429952/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132430336/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132430656/600000 [====================&gt;.........] - ETA: 26s - loss: 4.4532 - acc: 0.0132430976/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132431360/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132431744/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132432064/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132432448/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132432832/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132433216/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132433536/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132433920/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132434240/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132434560/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132434944/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132435264/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132435648/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132436032/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132436352/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132436736/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132437120/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132437440/600000 [====================&gt;.........] - ETA: 25s - loss: 4.4532 - acc: 0.0132437760/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132438080/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132438464/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132438784/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132439168/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132439552/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132439936/600000 [====================&gt;.........] - ETA: 24s - loss: 4.4532 - acc: 0.0132440256/600000 [=====================&gt;........] - ETA: 24s - loss: 4.4532 - acc: 0.0132440640/600000 [=====================&gt;........] - ETA: 24s - loss: 4.4532 - acc: 0.0132440960/600000 [=====================&gt;........] - ETA: 24s - loss: 4.4532 - acc: 0.0132441344/600000 [=====================&gt;........] - ETA: 24s - loss: 4.4532 - acc: 0.0132</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pre-train the discriminator network ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">make_trainable</span><span class="p">(</span><span class="n">discriminator</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="n">discriminator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/2
   300/200000 [..............................] - ETA: 15s - loss: 0.6538  1200/200000 [..............................] - ETA: 12s - loss: 0.5901  2100/200000 [..............................] - ETA: 12s - loss: 0.5339  3000/200000 [..............................] - ETA: 11s - loss: 0.4871  3900/200000 [..............................] - ETA: 11s - loss: 0.4506  4800/200000 [..............................] - ETA: 11s - loss: 0.4218  5700/200000 [..............................] - ETA: 11s - loss: 0.3984  6600/200000 [..............................] - ETA: 11s - loss: 0.3755  7800/200000 [&gt;.............................] - ETA: 11s - loss: 0.3465  8700/200000 [&gt;.............................] - ETA: 11s - loss: 0.3254  9900/200000 [&gt;.............................] - ETA: 10s - loss: 0.2965 10800/200000 [&gt;.............................] - ETA: 10s - loss: 0.2755 11700/200000 [&gt;.............................] - ETA: 10s - loss: 0.2559 12600/200000 [&gt;.............................] - ETA: 10s - loss: 0.2383 13500/200000 [=&gt;............................] - ETA: 10s - loss: 0.2226 14700/200000 [=&gt;............................] - ETA: 10s - loss: 0.2047 15900/200000 [=&gt;............................] - ETA: 10s - loss: 0.1896 16800/200000 [=&gt;............................] - ETA: 10s - loss: 0.1795 18000/200000 [=&gt;............................] - ETA: 10s - loss: 0.1676 18900/200000 [=&gt;............................] - ETA: 10s - loss: 0.1596 20100/200000 [==&gt;...........................] - ETA: 10s - loss: 0.1502 21000/200000 [==&gt;...........................] - ETA: 10s - loss: 0.1437 21900/200000 [==&gt;...........................] - ETA: 10s - loss: 0.1379 23100/200000 [==&gt;...........................] - ETA: 9s - loss: 0.1307  24300/200000 [==&gt;...........................] - ETA: 9s - loss: 0.1243 25500/200000 [==&gt;...........................] - ETA: 9s - loss: 0.1184 26700/200000 [===&gt;..........................] - ETA: 9s - loss: 0.1131 27900/200000 [===&gt;..........................] - ETA: 9s - loss: 0.1083 29100/200000 [===&gt;..........................] - ETA: 9s - loss: 0.1038 30300/200000 [===&gt;..........................] - ETA: 9s - loss: 0.0997 31200/200000 [===&gt;..........................] - ETA: 9s - loss: 0.0968 32400/200000 [===&gt;..........................] - ETA: 9s - loss: 0.0932 33600/200000 [====&gt;.........................] - ETA: 9s - loss: 0.0899 34800/200000 [====&gt;.........................] - ETA: 9s - loss: 0.0868 36000/200000 [====&gt;.........................] - ETA: 9s - loss: 0.0839 37200/200000 [====&gt;.........................] - ETA: 8s - loss: 0.0812 38100/200000 [====&gt;.........................] - ETA: 8s - loss: 0.0793 39000/200000 [====&gt;.........................] - ETA: 8s - loss: 0.0775 39900/200000 [====&gt;.........................] - ETA: 8s - loss: 0.0758 40800/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0741 41700/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0725 42600/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0710 43500/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0695 44400/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0681 45300/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0667 46200/200000 [=====&gt;........................] - ETA: 8s - loss: 0.0654 47100/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0642 48300/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0626 49500/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0611 50700/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0596 51900/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0583 52800/200000 [======&gt;.......................] - ETA: 8s - loss: 0.0573 53700/200000 [=======&gt;......................] - ETA: 8s - loss: 0.0563 54900/200000 [=======&gt;......................] - ETA: 8s - loss: 0.0551 55800/200000 [=======&gt;......................] - ETA: 8s - loss: 0.0542 56700/200000 [=======&gt;......................] - ETA: 7s - loss: 0.0533 57900/200000 [=======&gt;......................] - ETA: 7s - loss: 0.0522 59100/200000 [=======&gt;......................] - ETA: 7s - loss: 0.0512 60300/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0501 61200/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0494 62400/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0485 63600/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0475 64800/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0467 66000/200000 [========&gt;.....................] - ETA: 7s - loss: 0.0458 66900/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0452 67800/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0446 69000/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0438 70200/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0431 71400/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0424 72600/200000 [=========&gt;....................] - ETA: 7s - loss: 0.0417 73800/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0410 74700/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0405 75600/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0400 76500/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0395 77700/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0389 78900/200000 [==========&gt;...................] - ETA: 6s - loss: 0.0383 80100/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0378 81300/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0372 82500/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0367 83400/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0363 84600/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0358 85500/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0354 86400/200000 [===========&gt;..................] - ETA: 6s - loss: 0.0350 87600/200000 [============&gt;.................] - ETA: 6s - loss: 0.0345 88800/200000 [============&gt;.................] - ETA: 6s - loss: 0.0341 90000/200000 [============&gt;.................] - ETA: 6s - loss: 0.0336 91200/200000 [============&gt;.................] - ETA: 5s - loss: 0.0332 92400/200000 [============&gt;.................] - ETA: 5s - loss: 0.0327 93600/200000 [=============&gt;................] - ETA: 5s - loss: 0.0323 94800/200000 [=============&gt;................] - ETA: 5s - loss: 0.0319 95700/200000 [=============&gt;................] - ETA: 5s - loss: 0.0316 96900/200000 [=============&gt;................] - ETA: 5s - loss: 0.0312 98100/200000 [=============&gt;................] - ETA: 5s - loss: 0.0308 99300/200000 [=============&gt;................] - ETA: 5s - loss: 0.0305100500/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0301101700/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0298102600/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0295103800/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0292105000/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0288106200/200000 [==============&gt;...............] - ETA: 5s - loss: 0.0285107100/200000 [===============&gt;..............] - ETA: 5s - loss: 0.0283108300/200000 [===============&gt;..............] - ETA: 4s - loss: 0.0279109500/200000 [===============&gt;..............] - ETA: 4s - loss: 0.0276110700/200000 [===============&gt;..............] - ETA: 4s - loss: 0.0273111900/200000 [===============&gt;..............] - ETA: 4s - loss: 0.0270112800/200000 [===============&gt;..............] - ETA: 4s - loss: 0.0268114000/200000 [================&gt;.............] - ETA: 4s - loss: 0.0265115200/200000 [================&gt;.............] - ETA: 4s - loss: 0.0263116100/200000 [================&gt;.............] - ETA: 4s - loss: 0.0261117300/200000 [================&gt;.............] - ETA: 4s - loss: 0.0258118200/200000 [================&gt;.............] - ETA: 4s - loss: 0.0256119400/200000 [================&gt;.............] - ETA: 4s - loss: 0.0253120600/200000 [=================&gt;............] - ETA: 4s - loss: 0.0251121800/200000 [=================&gt;............] - ETA: 4s - loss: 0.0248122700/200000 [=================&gt;............] - ETA: 4s - loss: 0.0247123600/200000 [=================&gt;............] - ETA: 4s - loss: 0.0245124500/200000 [=================&gt;............] - ETA: 4s - loss: 0.0243125400/200000 [=================&gt;............] - ETA: 4s - loss: 0.0241126600/200000 [=================&gt;............] - ETA: 3s - loss: 0.0239127800/200000 [==================&gt;...........] - ETA: 3s - loss: 0.0237129000/200000 [==================&gt;...........] - ETA: 3s - loss: 0.0235130200/200000 [==================&gt;...........] - ETA: 3s - loss: 0.0232131400/200000 [==================&gt;...........] - ETA: 3s - loss: 0.0230132600/200000 [==================&gt;...........] - ETA: 3s - loss: 0.0228133800/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0226135000/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0224135900/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0223137100/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0221138300/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0219139500/200000 [===================&gt;..........] - ETA: 3s - loss: 0.0217140700/200000 [====================&gt;.........] - ETA: 3s - loss: 0.0215141900/200000 [====================&gt;.........] - ETA: 3s - loss: 0.0213142800/200000 [====================&gt;.........] - ETA: 3s - loss: 0.0212143700/200000 [====================&gt;.........] - ETA: 3s - loss: 0.0211144600/200000 [====================&gt;.........] - ETA: 3s - loss: 0.0209145500/200000 [====================&gt;.........] - ETA: 2s - loss: 0.0208146400/200000 [====================&gt;.........] - ETA: 2s - loss: 0.0207147300/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0205148200/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0204149100/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0203150000/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0202150900/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0201152100/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0199153300/200000 [=====================&gt;........] - ETA: 2s - loss: 0.0197154200/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0196155100/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0195156300/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0194157500/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0192158700/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0191159900/200000 [======================&gt;.......] - ETA: 2s - loss: 0.0189161100/200000 [=======================&gt;......] - ETA: 2s - loss: 0.0188162300/200000 [=======================&gt;......] - ETA: 2s - loss: 0.0187163500/200000 [=======================&gt;......] - ETA: 1s - loss: 0.0185164700/200000 [=======================&gt;......] - ETA: 1s - loss: 0.0184165900/200000 [=======================&gt;......] - ETA: 1s - loss: 0.0182167100/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0181168000/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0180168900/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0179170100/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0178171300/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0177172200/200000 [========================&gt;.....] - ETA: 1s - loss: 0.0176173400/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0175174300/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0174175500/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0172176700/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0171177600/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0170178800/200000 [=========================&gt;....] - ETA: 1s - loss: 0.0169180000/200000 [==========================&gt;...] - ETA: 1s - loss: 0.0168181200/200000 [==========================&gt;...] - ETA: 1s - loss: 0.0167182400/200000 [==========================&gt;...] - ETA: 0s - loss: 0.0166183300/200000 [==========================&gt;...] - ETA: 0s - loss: 0.0165184200/200000 [==========================&gt;...] - ETA: 0s - loss: 0.0164185400/200000 [==========================&gt;...] - ETA: 0s - loss: 0.0163186300/200000 [==========================&gt;...] - ETA: 0s - loss: 0.0162187500/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0161188400/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0161189600/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0160190800/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0159192000/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0158192900/200000 [===========================&gt;..] - ETA: 0s - loss: 0.0157193800/200000 [============================&gt;.] - ETA: 0s - loss: 0.0156194700/200000 [============================&gt;.] - ETA: 0s - loss: 0.0155195600/200000 [============================&gt;.] - ETA: 0s - loss: 0.0155196500/200000 [============================&gt;.] - ETA: 0s - loss: 0.0154197400/200000 [============================&gt;.] - ETA: 0s - loss: 0.0153198600/200000 [============================&gt;.] - ETA: 0s - loss: 0.0152199800/200000 [============================&gt;.] - ETA: 0s - loss: 0.0152200000/200000 [==============================] - 11s 54us/step - loss: 0.0151
Epoch 2/2
   300/200000 [..............................] - ETA: 14s - loss: 8.7951e-06  1500/200000 [..............................] - ETA: 10s - loss: 8.7379e-06  2400/200000 [..............................] - ETA: 10s - loss: 8.8106e-06  3600/200000 [..............................] - ETA: 10s - loss: 8.9464e-06  4800/200000 [..............................] - ETA: 10s - loss: 8.9983e-06  6000/200000 [..............................] - ETA: 10s - loss: 9.2561e-06  7200/200000 [&gt;.............................] - ETA: 10s - loss: 9.2097e-06  8400/200000 [&gt;.............................] - ETA: 10s - loss: 9.1984e-06  9300/200000 [&gt;.............................] - ETA: 10s - loss: 9.1282e-06 10200/200000 [&gt;.............................] - ETA: 10s - loss: 9.1427e-06 11400/200000 [&gt;.............................] - ETA: 10s - loss: 9.1010e-06 12300/200000 [&gt;.............................] - ETA: 10s - loss: 9.0673e-06 13200/200000 [&gt;.............................] - ETA: 10s - loss: 9.0487e-06 14400/200000 [=&gt;............................] - ETA: 10s - loss: 9.0012e-06 15600/200000 [=&gt;............................] - ETA: 10s - loss: 9.0241e-06 16500/200000 [=&gt;............................] - ETA: 10s - loss: 8.9835e-06 17700/200000 [=&gt;............................] - ETA: 9s - loss: 8.9305e-06  18900/200000 [=&gt;............................] - ETA: 9s - loss: 8.9021e-06 19800/200000 [=&gt;............................] - ETA: 9s - loss: 8.8559e-06 21000/200000 [==&gt;...........................] - ETA: 9s - loss: 8.7777e-06 21900/200000 [==&gt;...........................] - ETA: 9s - loss: 8.7319e-06 22800/200000 [==&gt;...........................] - ETA: 9s - loss: 8.6780e-06 23700/200000 [==&gt;...........................] - ETA: 9s - loss: 8.6439e-06 24900/200000 [==&gt;...........................] - ETA: 9s - loss: 8.6189e-06 26100/200000 [==&gt;...........................] - ETA: 9s - loss: 8.5824e-06 27000/200000 [===&gt;..........................] - ETA: 9s - loss: 8.5613e-06 27900/200000 [===&gt;..........................] - ETA: 9s - loss: 8.5134e-06 28800/200000 [===&gt;..........................] - ETA: 9s - loss: 8.4721e-06 29700/200000 [===&gt;..........................] - ETA: 9s - loss: 8.4312e-06 30900/200000 [===&gt;..........................] - ETA: 9s - loss: 8.4039e-06 32100/200000 [===&gt;..........................] - ETA: 9s - loss: 8.3750e-06 33000/200000 [===&gt;..........................] - ETA: 9s - loss: 8.4311e-06 33900/200000 [====&gt;.........................] - ETA: 9s - loss: 8.3951e-06 35100/200000 [====&gt;.........................] - ETA: 9s - loss: 8.3644e-06 36300/200000 [====&gt;.........................] - ETA: 8s - loss: 8.3587e-06 37200/200000 [====&gt;.........................] - ETA: 8s - loss: 8.3500e-06 38100/200000 [====&gt;.........................] - ETA: 8s - loss: 8.3554e-06 39000/200000 [====&gt;.........................] - ETA: 8s - loss: 8.3846e-06 40200/200000 [=====&gt;........................] - ETA: 8s - loss: 8.3308e-06 41100/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2902e-06 42000/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2845e-06 42900/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2669e-06 43800/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2799e-06 44700/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2407e-06 45600/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2338e-06 46500/200000 [=====&gt;........................] - ETA: 8s - loss: 8.2126e-06</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we check the discriminator's prediction for our samples, for train precision evaluation:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[376]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">discriminator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[454]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">y_idx</span><span class="o">-</span><span class="n">y_hat_idx</span>
<span class="n">n_tot</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_rig</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">n_rig</span><span class="o">*</span><span class="mf">100.0</span><span class="o">/</span><span class="n">n_tot</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">%0.02f</span><span class="s2"> pct (</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2">) right&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">n_rig</span><span class="p">,</span> <span class="n">n_tot</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy: 100.00 pct (200000 of 200000) right
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we are going to train our GAN model in batches using the following function (train_for_n). We will log our losses and use the earlier defined function (plot_loss) to describe them along the training process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[455]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># set up loss storage vector</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;d&quot;</span><span class="p">:[],</span> <span class="s2">&quot;g&quot;</span><span class="p">:[]}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[456]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_for_n</span><span class="p">(</span><span class="n">nb_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">plt_frq</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span><span class="c1">#nb_epoch=5000</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nb_epoch</span><span class="p">)):</span>  
        <span class="c1"># Train discriminator on generated images</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="n">input__</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
        <span class="n">text_batch</span> <span class="o">=</span> <span class="n">input__</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
        <span class="n">noise_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
             <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">noise_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="c1">#noise_gen = np.random.choice([0,1],size=(BATCH_SIZE,input__.shape[1],input__.shape[2]))</span>
        <span class="n">generated_texts</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">noise_gen</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">generated_texts</span><span class="p">,</span><span class="n">text_batch</span> <span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">BATCH_SIZE</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">BATCH_SIZE</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">y</span><span class="p">[</span><span class="n">BATCH_SIZE</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="n">make_trainable</span><span class="p">(</span><span class="n">discriminator</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">d_loss</span>  <span class="o">=</span> <span class="n">discriminator</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">losses</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_loss</span><span class="p">)</span>
    
        <span class="c1"># train Generator-Discriminator stack on input noise to non-generated output class</span>
        <span class="n">noise_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
             <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">text_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">noise_gen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="c1">#noise_tr = np.random.choice([0,1],size=[BATCH_SIZE,input__.shape[1],input__.shape[2]])</span>
        <span class="n">generated_noise</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">noise_tr</span><span class="p">)</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">BATCH_SIZE</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">y2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="n">make_trainable</span><span class="p">(</span><span class="n">discriminator</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">g_loss</span> <span class="o">=</span> <span class="n">GAN</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">generated_noise</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span>
        <span class="n">losses</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_loss</span><span class="p">)</span>
        
        <span class="c1"># Updates plot</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">%</span><span class="k">plt_frq</span>==plt_frq-1:
            <span class="n">plot_loss</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[457]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_for_n</span><span class="p">(</span><span class="n">nb_epoch</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">plt_frq</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_text output_subarea ">
<pre>&lt;matplotlib.figure.Figure at 0x191cfecd438&gt;</pre>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_text output_subarea ">
<pre>&lt;matplotlib.figure.Figure at 0x191cfecd438&gt;</pre>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAAKaCAYAAAAEZnlLAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAPYQAAD2EBqD+naQAAIABJREFUeJzs3Xt4VNW9//HPmplcCAkJdxQEESoXQYSArdUgiD9B8YKU
gsELl1bxIFKhttWHKhetIgpYalE4B7kUCaCi1aoFpFBtrVqDeqyCWhWwHgUiAkICJJn1+2MmQyY3
MmHPZO/4fj1PnjBr9mVlJE/59LvWdxtrrQAAAAAAkq++JwAAAAAAbkFAAgAAAIAwAhIAAAAAhBGQ
AAAAACCMgAQAAAAAYQQkAAAAAAgjIAEAAABAGAEJAAAAAMIISAAAAAAQRkACAAAAgLA6BSRjzC3G
mM+MMUXGmNeNMf1qOHapMSZojCkNfy/7eq/u0wYAAAAA58UckIwxoyTNlTRdUm9J70pab4xpUc0p
kyW1kXRK+Hs7Sfskra3LhAEAAAAgXoy1NrYTjHld0hvW2p+FXxtJn0taYK2dU4vzh0l6SlJHa+3n
sU8ZAAAAAOIjpgqSMSZJUrakTWVjNpSwXpZ0Xi0vM17Sy4QjAAAAAG4TiPH4FpL8knZXGN8tqcuJ
TjbGnCLpUknXnOC45pIGS9oh6UiMcwQAAADQcKRKOl3Semvt1/G+WawB6WSNlfSNpD+e4LjBkp6I
+2wAAAAAeMW1klbF+yaxBqQCSaWSWlcYby3pq1qcP07SCmttyQmO2yFJK1euVLdu3WKcItAwTJky
RfPnz6/vaQD1it8DgN8DYNu2bbruuuukcEaIt5gCkrW22BiTL2mQpOekSJOGQZIW1HSuMWaApE6S
ltTiVkckqVu3burTp08sUwQajMzMTP7+4zuP3wOA3wOgnIRsvanLErt5kpaFg9KbkqZISpO0TJKM
MfdLOtVaO6bCeT9RqPvdtrpPFwAAAADiJ+aAZK1dG37m0SyFlta9I2mwtXZv+JA2kk4rf44xpomk
qxV6JhIAAAAAuFKdmjRYaxdKWljNe+OqGDsoKb0u9wIAAACARInpOUgAEic3N7e+pwDUO34PAH4P
gEQjIAEuxf8gAvweABK/B0CiJfo5SAAAAJ6ya9cuFRQU1Pc0gAarRYsWat++fX1PI4KABAAAUI1d
u3apW7duKiwsrO+pAA1WWlqatm3b5pqQREACAACoRkFBgQoLC3l4PRAnZQ+BLSgoICABAAB4BQ+v
B747aNIAAAAAAGEEJAAAAAAIIyABAAAAQBgBCQAAAADCCEgAAACotRkzZsjnS+w/IXfu3Cmfz6cV
K1Y4ds2//vWv8vl8euWVVxy7Zizq43Osz/t6CZ8OAADAd9Ty5cvl8/kiX40aNVLbtm01ZMgQ/e53
v9OhQ4cqnWOMqZd/YBtjPHHN8oqKijRz5swqQ1h9fo7x/rm9joAEAADwHWaM0b333quVK1fqscce
0+TJk2WM0W233aaePXvqvffeizr+rrvuSviDczt06KCioiJdf/31jl3zwgsvVFFRkfr37+/YNSsq
LCzUzJkztWXLlkrv1cfniNpx9XOQSoIl9T0FAACABm/IkCFRz3n61a9+pS1btmjo0KG66qqrtG3b
NqWkpEiSfD6fkpOTEzKv0tJSBYNBJSUlxeWe8f45rLXVvpfIzxGxcXUFqeBwQX1PAQAA4DtpwIAB
uuuuu7Rz506tXLkyMl7VHpaNGzcqJydHTZs2VUZGhrp27app06ZFHXP06FHNmDFDXbp0UaNGjXTq
qafqRz/6kT777DNJx/cZzZs3T7/97W/VuXNnpaamatu2bVXuQRo7dqwyMjL0+eef6/LLL1dGRoba
tWunhQsXSpLee+89DRo0SOnp6Tr99NOVl5cXNZ+q9iANGDBAZ599trZt26aBAweqcePGateunR58
8MGoc4uLi3X33Xerb9++ysrKUnp6uvr37x9VKdq5c6datWolY0zkM/P5fJo1a1aVn2PPnj01aNCg
Sv8drLVq27atRo4cGTX28MMPq0ePHmrUqJHatGmjm2++Wfv376/iv+SJlZaW6p577ol85h07dtS0
adN07NixqOPeeustDR48WC1btlRaWprOOOMM/eQnP4k6ZvXq1erbt6+aNGmizMxMnX322VqwYEGd
5lVfXB2QXt31an1PAQAA4Dvr+uuvl7VWGzZsiIxV3MPywQcf6IorrlBxcbHuuecezZs3T1dddZVe
e+21yDHBYFBDhw7VPffco379+mnevHm67bbbdPDgQf3rX/+Kuufjjz+uRx55RBMmTNDcuXPVrFmz
KudmjFEwGNSll16qDh066MEHH1THjh116623avny5br00kvVr18/zZkzR02aNNGYMWO0c+fOSteo
+Hrfvn269NJL1bt3b82bN0/dunXTHXfcofXr10eOO3jwoB5//HENHDhQc+bM0cyZM1VQUKAhQ4bo
f//3fyVJLVu21GOPPSZrrYYPH66VK1dq5cqVGj58eJWf46hRo/TKK69oz549UXN69dVX9eWXXyo3
NzcydtNNN+lXv/qVcnJytGDBAo0fP15PPPGEhgwZotLS0io/r5r85Cc/0fTp09W3b189/PDDGjBg
gO6///6oe+7du1eDBw/Wrl27dOedd+qRRx7RddddpzfeeCNyzMaNGzV69Gg1b95cc+bM0QMPPKCB
AwdG/V3wBGut674k9ZFkhz401AIAANSX/Px8K8nm5+fX91TiYtmyZdbn89X482VlZdns7OzI6xkz
Zlifzxd5/fDDD1ufz2f37dtX7TUef/xxa4yxv/3tb6s9ZseOHdYYY7OysuzXX39d5XvLly+PjI0d
O9b6fD77wAMPRMb2799v09LSrN/vt08++WRk/MMPP7TGGDtz5szI2JYtW6zP57N//etfI2MDBgyw
Pp/PPvHEE5GxY8eO2VNOOcX++Mc/jowFg0FbXFwcNccDBw7YNm3a2J/+9KeRsYKCgkr3LVPxc/zo
o4+sMcb+/ve/jzpu4sSJtkmTJvbIkSPWWmtfffVVa4yxq1evjjpuw4YN1hhj8/LyKt2rpvu+++67
1hhjJ0yYEHXcL37xC+vz+eyWLVustdY+++yz1ufz2a1bt1Z77dtuu81mZWXVeP+KavM7VnaMpD42
AVnE1XuQPvvms/qeAgAAQK0VFkrbt8f3Hl27Smlp8b1Heenp6fr222+rfT8rK0uS9Mwzz2jcuHFV
dkhbt26dWrZsqUmTJp3wfiNGjKi2alSV8ku8MjMz1aVLF33yyScaMWJEZPzMM89UVlaWPv300xNe
Lz09XaNHj468TkpK0rnnnht1rjFGgUDon9HWWu3fv1+lpaXq27evtm7dWuu5l/e9731P55xzjtas
WaOJEydKClXenn76aV155ZWRPWBPPfWUsrKyNGjQIH399deR83v37q309HRt3rxZ11xzTa3v++KL
L8oYoylTpkSN//znP9dDDz2kF154QRdeeKGysrJkrdVzzz2nnj17Rn7+8rKysnT48GGtX79egwcP
rsvH4AquDki7Du6q7ykAAADU2vbtUnZ2fO+Rny+V66cQd4cOHVLr1q2rfX/UqFFasmSJbrzxRt1x
xx0aNGiQhg8frhEjRkTC0ieffKIuXbrUqq316aefXuu5paamqnnz5lFjmZmZateuXaVjMzMz9c03
35zwmlWd27Rp00rd/JYvX6558+Zp+/btKi4ujoyfccYZtZ1+JaNGjdK0adP05Zdf6pRTTtHmzZu1
Z88ejRo1KnLMxx9/rP3796tVq1aVzjfGVFqidyJl+7s6d+4cNd66dWtlZWVFliVeeOGFGjFihGbN
mqX58+drwIABGjZsmEaPHh1pNjFx4kQ9+eSTuuyyy3Tqqafqkksu0ciRIz0XllwdkA4dPaRjpceU
7KfDBwAAcL+uXUMBJt73SJQvvvhCBw4cqPSP5/JSU1P1yiuvaPPmzXrhhRf05z//WWvWrNGgQYO0
YcOGmJ+506hRo1of6/f7Yxq3NXSVi+XclStXaty4cRo+fLh++ctfqlWrVvL7/brvvvtqVaWqzqhR
o3TnnXfqySef1OTJk7V27VplZWVFBYxgMKjWrVtr1apVVf48LVu2rNO9a/Pfae3atXrzzTf1/PPP
a/369Ro/frzmzZun119/XWlpaWrZsqXeeecdrV+/Xi+99JJeeuklLV26VGPGjNHSpUvrNK/64OqA
JEkFhQU6NePU+p4GAADACaWlJba6E28rVqyQMUZDhgw54bEDBw7UwIED9dBDD+n+++/Xr3/9a23e
vFkXXXSROnXqpDfffFOlpaXVBhAvefrpp9WpUyc99dRTUeN333131OtYw+Hpp5+uc889V2vWrNEt
t9yiZ555RldffbWSkpIix3Tq1EmbNm3SD3/4w8iyu5PRoUMHBYNBffzxx+rSpUtkfM+ePdq/f786
dOgQdfy5556rc889V/fcc4/y8vJ07bXXavXq1Ro/frwkKRAIaOjQoRo6dKgk6b/+67+0ePFi3XXX
XSdVXUskV3exk6Q9h2MrEwIAAODk/eUvf9G9996rM844I2pPTkVVLVvr1auXrLU6evSoJOlHP/qR
9u7dq0ceeSRu802kqkLeG2+8oX/84x9RY2nhzWKxtN8eNWqUXn/9dT3++OMqKCiIWl4nSSNHjlRJ
SUmkXXh5paWlOnDgQK3vJUmXXXZZpG14eXPnzpUxRpdffnm1P0OvXr0kKfLfed++fZWO6dmzZ9Qx
XuD6ChIBCQAAIH6stXrxxRe1bds2lZSUaPfu3frLX/6ijRs3qmPHjnruuedqfKDprFmz9Morr2jo
0KHq0KGDdu/erUcffVTt27fXBRdcIEm64YYbtGLFCk2dOlVvvPGGcnJydOjQIW3atEm33HKLrrji
ikT9uFFqs+SuKpdffrnWrVunYcOGaejQofr000+1aNEinXXWWTp06FDkuNTUVHXv3l1r1qzR9773
PTVr1kw9evTQWWedVe21R44cqdtvv1233367mjdvXunZSP3799eECRM0e/ZsvfPOO7rkkkuUlJSk
jz76SE899ZQWLFgQaSVeG2effbbGjBmjxYsX65tvvtGFF16oN954QytWrNDw4cPVv39/SaE9VwsX
LtTVV1+tTp066dtvv9V///d/KzMzU5dddpkk6ac//an27duniy66SO3atdOOHTv0yCOPqHfv3urW
rVssH3G9cn1A2nt4b31PAQAAoMEyxmj69OmSpOTkZDVr1kw9e/bUggULNHbsWDVu3LjKc8pcddVV
2rlzp5YuXaqCggK1aNFCAwYM0IwZM5SRkSFJ8vl8eumll/Sb3/xGq1at0rp169S8eXPl5OREKgxl
161uWVpV47EeW9Vzj+pyzbFjx2r37t1atGiRNmzYoO7du+uJJ57Q2rVrox48K0lLlizRrbfeqqlT
p+rYsWOaPn16JCBVda+2bdvqhz/8oV577TXdeOONVVarHn30UfXt21eLFi3StGnTFAgEdPrpp+uG
G27Q+eefX+X8a/oZlyxZok6dOmnZsmV69tln1aZNG02bNi1qyeCFF16of/7zn1qzZo12796tzMxM
ff/739eqVasiy/Cuv/56LV68WI8++qj279+vNm3aKDc3N/L3yytMXZNzPBlj+kjKT52Yqvuuu09T
zptywnMAAACctnXrVmVnZys/P199GtLmIsAlavM7VnaMpGxrbd36qMfA1XuQmjZqqr2FVJAAAAAA
JIa7A1JqU/YgAQAAAEgYdwckKkgAAAAAEsjVAalJShPtP1L7togAAAAAcDJcHZAykjMISAAAAAAS
xtUBKT05XQeOxPawKwAAAACoK/cHpKMEJAAAAACJ4eqAlJGSoQNHDihog/U9FQAAAADfAa4OSOlJ
6bKyOnTsUH1PBQAAAMB3gLsDUkq6JLEPCQAAAEBCuDogZSRnSBKd7AAAAAAkhKsDUnpyuIJEowYA
AADEmc/n06xZs74z90XVvBGQWGIHAAAQNzt27NCkSZPUpUsXNW7cWI0bN9ZZZ52lSZMm6b333qvv
6TnqpZde0syZM6t8zxgjY0yCZwS3CdT3BGpStgeJJXYAAADx8ac//UnXXHONkpKSdO2116pXr17y
+Xzavn271q1bp8cee0yfffaZTjvttPqeqiNefPFFLVy4UNOnT6/0XlFRkQIBV//zGAng6r8Bqf5U
BXwBltgBAADEwaeffqrc3Fx17NhRmzZtUqtWraLef+CBB7Rw4UL5fO5ddFRYWKi0tLRaH2+trfa9
5ORkJ6YEj3Pv33aFypyZKZkssQMAAIiDBx54QIWFhVq6dGmlcCSF9sZMmjRJbdu2jRr/8MMPNWLE
CDVv3lyNGjVSv3799Pzzz0cds3z5cvl8Pr322muaOnWqWrVqpfT0dA0fPlxff/11pXu99NJL6t+/
v9LT09WkSRNdfvnl+uCDD6KOGTt2rDIyMvTpp5/qsssuU5MmTXTddddJkv72t79p5MiR6tChg1JT
U9W+fXtNnTpVR44ciZw/btw4LVy4MPKz+Xw++f3+qJ+3bC/Q008/LZ/Pp1dffbXSXBctWiSfzxc1
v9p8JrF4++23demllyozM1MZGRm6+OKL9cYbb0QdU1JSopkzZ+rMM89Uo0aN1KJFC+Xk5GjTpk2R
Y3bv3q1x48bptNNOU2pqqk499VQNGzZMu3btqvPcGjpXV5Ck0MNieQ4SAACA81544QV17txZffv2
rfU577//vi644AK1a9dOd955pxo3bqy1a9dq2LBhWrduna666qqo42+99VY1a9ZMM2bM0I4dOzR/
/nxNmjRJeXl5kWP+8Ic/aOzYsRoyZIjmzJmjwsJCPfroo8rJydHbb7+t9u3bSwr9n+clJSUaPHiw
cnJyNHfu3Ej16Mknn1RRUZEmTpyo5s2b680339Tvfvc7ffHFF1qzZo0k6eabb9b//d//6eWXX9YT
TzxRYzVp6NChSk9P19q1a5WTkxP13tq1a9WjRw917969Tp/JiXzwwQfq37+/MjMzdccddygQCGjR
okUaMGCAXnnlFfXr10+SNH36dM2ePVs33XST+vXrp4MHD+qtt97S1q1bNWjQIEnS8OHDtW3bNk2e
PFkdOnTQnj17tHHjRu3atSvyuaICa63rviT1kWTz8/Ntj4U97OQXJ1sAAIBEy8/Pt2X/JmloDh48
aI0xdvjw4ZXe279/vy0oKIh8FRUVRd4bNGiQPeecc2xxcXHUOeeff77t0qVL5PWyZcusMcYOHjw4
6ripU6fapKQke/DgQWuttYcOHbJNmza1N998c9Rxe/bssVlZWXbChAmRsbFjx1qfz2enTZtWac5H
jhypNDZ79mzr9/vt559/HhmbNGmS9fl8VX4mxhg7c+bMyOvRo0fbNm3a2GAwGBn76quvrN/vt7/5
zW9i/kyqU/G+w4YNs6mpqXbHjh2RsS+//NI2adLEDhgwIDJ2zjnn2CuuuKLa6+7fv98aY+zcuXNP
OIf6UpvfsbJjJPWxCcgirq8gpSenU0ECAACeUFhcqO0F2+N6j64tuiotqfZ7bqpz8OBBSVJ6enql
9wYMGKB333038vqhhx7S1KlT9c0332jz5s265557dOBA9BaISy65RDNnztSXX36pU045RVKo4nPT
TTdFHZeTk6OHH35YO3fuVI8ePbRhwwYdOHBA11xzTdTSO2OMvv/972vz5s2V5nfzzTdXGktJSYn8
ubCwUEVFRTrvvPMUDAb19ttvq127drX5WKKMGjVKq1ev1pYtWzRw4EBJoUqVtVYjR46UpJg/kxMJ
BoPauHGjrr76anXo0CEy3qZNG40ePVr/8z//o0OHDik9PV1ZWVl6//339e9//1udO3eudK1GjRop
OTlZW7Zs0fjx45WVlRXzZ/Bd5I2AVExAAgAA7re9YLuyF2fH9R75N+Wrzyl9Tvo6GRkZkqRDhyr/
O2vx4sX69ttvtXv3bl177bWR8X//+9+y1uquu+7Sr3/960rnGWO0Z8+eqDBQsftd06ZNJYWCRflr
lgWQitdr0qRJ1FggEKgy7Hz++ee666679Pzzz0euXXaNisGltoYMGaImTZpozZo1kfmtXbtW55xz
TiSQ1OUzqcnevXtVWFioM888s9J73bp1UzAY1Oeff65u3bpp1qxZGjZsmM4880z16NFDQ4YM0fXX
X6+ePXtKCjWdeOCBB3T77berdevW+sEPfqDLL79cN9xwg1q3bl2nz+S7wBsBiQoSAADwgK4tuir/
pvy438MJTZo00SmnnKJ//etfld4r2+Oyc+fOqPFgMChJuv322zV48OAqr1uxklG+CUIZe3xbhYLB
oIwxWrlyZZX/aK/Ydrt8paj8vC6++GLt379fd955Z+R5Tl988YXGjBkTmXeskpOTNWzYMD3zzDNa
uHChvvzyS/3973/X7Nmzo+4txfaZOCUnJ0effPKJ/vjHP2rDhg1asmSJ5s+fr0WLFmn8+PGSpJ/9
7Ge68sor9eyzz2r9+vW6++67df/992vz5s3q1atXXObldZ4ISLsO0GUDAAC4X1pSmiPVnUQZOnSo
lixZorfeeqtWjRrOOOMMSVJSUpIuuuiiOt+3/MNYO3XqJGutWrZsWedrvvfee/r444/1hz/8Iari
9fLLL9d479oYNWqUVqxYoU2bNun999+XpMjyOsm5z6RMy5YtlZaWpg8//LDSe9u2bZPP54uqymVl
ZWnMmDEaM2aMCgsLlZOToxkzZkQCkiR17NhRU6ZM0ZQpU/TJJ5+oV69emjt3rlasWHHS822IXN3m
W5LSk6ggAQAAxMMvf/lLNWrUSOPHj9eePXsqvV+x8tKyZUsNGDBAixYt0ldffVXp+IKCgpjnMHjw
YDVp0kT33XefSkpK6nTNsipVxfk+/PDDlQJR48aNJR3fg3UiF198sZo2barVq1dr7dq1Ovfcc6P2
Bjn9mfh8Pl1yySX64x//GNWKe/fu3crLy1NOTk5k39i+ffuizk1LS1Pnzp119OhRSaEH35b9uUzH
jh2VkZFRaRzHeaKCREACAABwXufOnbVq1SqNHj1aXbp00bXXXqtevXrJWqvPPvtMq1atkt/vj9rz
8/vf/145OTnq2bOnbrzxRp1xxhnavXu3/vGPf+iLL77Q22+/HTm2bBldReXHMzIy9Oijj+qGG25Q
nz59dM0116hly5batWuXXnjhBV1wwQVasGBBjT9H165d1alTJ/385z/Xf/7zHzVp0kRPP/209u/f
X+nY7OxsWWt16623avDgwfL7/Ro1alS11w4EAho+fLhWr16twsJCzZ07t9IxsXwmtXHvvffq5Zdf
1vnnn6+JEyfK7/dr8eLFOnbsmObMmRM5rnv37howYICys7PVrFkz/fOf/9RTTz2lyZMnS5I++ugj
DRo0SCNHjlT37t0VCAS0bt067dmzR7m5uTHN6buEgAQAAPAdduWVV+q9997T3LlztXHjRi1dulTG
GHXo0EFXXHGFJkyYENn0L4UaBbz11luaOXOmli9frq+//lqtWrVS7969dffdd0ddu7rlbBXHc3Nz
1bZtW82ePVsPPfSQjh49qrZt2yonJ0fjxo074TUDgYD+9Kc/afLkyZo9e7ZSU1M1fPhw3XLLLZX2
2QwfPlyTJ0/W6tWrI89CKgtIxpgqrz9q1CgtWbJEPp9PP/7xjyu9X9NnMn369Co/g4o/U/n7du/e
Xa+++qruvPNOzZ49W8FgUD/4wQ+0atWqqKWQP/vZz/Tcc89p48aNOnr0qDp06KD77rtPt99+u6RQ
g4zRo0dr06ZNWrlypQKBgLp27aonn3xSw4YNO+G8vqtMdcm+Phlj+kjKz8/P1+YjmzXrlVk6cEfd
uo8AAADU1datW5Wdna38/Hz16eOdvUWAV9Tmd6zsGEnZ1tqt8Z6T+/cghStIbgxyAAAAABoWVwek
YDAUkII2qCMlR+p7OgAAAAAaOE8EJEnsQwIAAAAQd64OSKWlBCQAAAAAiePqgEQFCQAAAEAiuTog
UUECAAAAkEiuDkhUkAAAAAAkkqsDEhUkAAAAAIkUqO8J1ISABAAA3GDbtm31PQWgQXLj75arA1Iw
KCX7kxXwBQhIAAAg4Vq0aKG0tDRdd9119T0VoMFKS0tTixYt6nsaEa4OSKWlkjFG6cnpBCQAAJBw
7du317Zt21RQUFDfUwEarBYtWqh9+/b1PY0IVwekYDD0nYAEAADqS/v27V31jzcA8eX6Jg0SAQkA
AABAYhCQAAAAACDM1QGpbIld46TGOlRMQAIAAAAQX94ISMmNVVhcWL+TAQAAANDguToglS2xS0tK
IyABAAAAiDsCEgAAAACEuToglS2xSwsQkAAAAADEn6sDUlkFqXFyYx0+drh+JwMAAACgwXN1QIpU
kFhiBwAAACABXB2Q2IMEAAAAIJEISAAAAAAQ5uqAVH6JXVFJkYI2WL8TAgAAANCguTogRZo0JDWW
JBUVF9XjbAAAAAA0dK4OSOUrSJJYZgcAAAAgrlwdkMrvQZIISAAAAADiq04ByRhzizHmM2NMkTHm
dWNMvxMcn2yM+Y0xZocx5ogx5lNjzNgT3adiQDpczLOQAAAAAMRPINYTjDGjJM2VdJOkNyVNkbTe
GHOmtbagmtOelNRS0jhJn0g6RbUIZyyxAwAAAJBIMQckhQLRImvtCkkyxtwsaaik8ZLmVDzYGDNE
Uo6kM6y1+8PDu2pzo0iThuRQkwYCEgAAAIB4immJnTEmSVK2pE1lY9ZaK+llSedVc9oVkt6S9Ctj
zH+MMR8aYx40xqSe6H5UkAAAAAAkUqwVpBaS/JJ2VxjfLalLNeecoVAF6YikYeFrPCqpmaSf1HQz
AhIAAACARKrLErtY+SQFJY221h6SJGPMVElPGmMmWmuPVnfiqlVTtHVrZugBsR9J926+V0cnHFVu
bm4Cpg0AAAAgkfLy8pSXlxc1duDAgYTOIdaAVCCpVFLrCuOtJX1VzTlfSvqiLByFbZNkJLVTqGlD
lUaMmK/77usja60C9wQ04bIJyu1LOAIAAAAaotzc3ErFkK1btyo7Ozthc4hpD5K1tlhSvqRBZWPG
GBN+/VqEai5IAAAgAElEQVQ1p/1d0qnGmLRyY10Uqir9p6b7lS2xM8YoLSmNJXYAAAAA4qouz0Ga
J+lGY8wNxpiukh6TlCZpmSQZY+43xiwvd/wqSV9LWmqM6WaM6a9Qt7slNS2vk453sZNEQAIAAAAQ
dzHvQbLWrjXGtJA0S6Glde9IGmyt3Rs+pI2k08odf9gY8/8k/U7SPxUKS2sk3XWie5VVkKRQQOJB
sQAAAADiqU5NGqy1CyUtrOa9cVWMfSRpcKz3KSk5/mcqSAAAAADirS5L7BKmfAWpcVJjAhIAAACA
uPJMQKKCBAAAACDeXB2QKjZpYA8SAAAAgHhydUCiggQAAAAgkVwdkGjzDQAAACCRPBWQDh9jiR0A
AACA+HF1QCq/xK5RoJGOltb4XFkAAAAAOCmuDkjlK0ipgVQdKTlSf5MBAAAA0OC5OiCVryARkAAA
AADEm6sDEhUkAAAAAIlEQAIAAACAMFcHpKqW2Flr629CAAAAABo0VwekihWkoA2qJFhSfxMCAAAA
0KC5OiBVrCBJYpkdAAAAgLghIAEAAABAmKsDUkm51XQEJAAAAADx5uqARAUJAAAAQCIRkAAAAAAg
zNUBqWIXO4mABAAAACB+XB2QqCABAAAASCRXByQqSAAAAAASiYAEAAAAAGGuDkgssQMAAACQSK4O
SFSQAAAAACSSqwNS+QpSsj9ZEgEJAAAAQPy4OiCVryAZY5QaSCUgAQAAAIgbzwQkSQQkAAAAAHHl
6oBUfomdREACAAAAEF+uDkhUkAAAAAAkkqsDEhUkAAAAAInk6oBEBQkAAABAIhGQAAAAACDM1QGp
yiV2pQQkAAAAAPHhvYBEBQkAAABAnLg6ILHEDgAAAEAiEZAAAAAAIMzVAYkldgAAAAASydUBqVIF
yU9AAgAAABA/rg5IVJAAAAAAJJKrAxJ7kAAAAAAkEgEJAAAAAMJcHZBYYgcAAAAgkVwdkKggAQAA
AEgkVwckSbL2+J9TAik6Vnqs/iYDAAAAoEFzfUAqX0VK9ierJFiioA1WfwIAAAAA1JHrA1JJyfE/
J/uTJYkqEgAAAIC4cH1AqlhBkghIAAAAAOLDUwEpxZ8iiYAEAAAAID48FZDKKkhHS47W02wAAAAA
NGSeDEhUkAAAAADEg+sDEk0aAAAAACSK6wNS1B6kAHuQAAAAAMSPpwJSZA9SKXuQAAAAADjPkwGJ
ChIAAACAeCAgAQAAAECYpwJS2XOQaPMNAAAAIB5cH5DoYgcAAAAgUVwfkFhiBwAAACBRCEgAAAAA
EOapgFT2HCTafAMAAACIB08FJL/xy8hQQQIAAAAQF64PSOWbNBhjlOxPJiABAAAAiAvXB6TyFSQp
tA+JNt8AAAAA4sFzASklkEIFCQAAAEBceC4gscQOAAAAQLwQkAAAAAAgzPUBqXyTBim8B4k23wAA
AADiwPUBqdIeJD97kAAAAADEh+cCEkvsAAAAAMSLJwMSS+wAAAAAxIMnAxIVJAAAAADx4PqAVLFJ
A89BAgAAABAvrg9IVJAAAAAAJIonA9LREvYgAQAAAHCeJwMSFSQAAAAA8eDqgGRM5YCU5EtScbC4
fiYEAAAAoEFzdUDy+ys3aUjyJam4lIAEAAAAwHl1CkjGmFuMMZ8ZY4qMMa8bY/rVcOyFxphgha9S
Y0yrE93H76+iguSnggQAAAAgPmIOSMaYUZLmSpouqbekdyWtN8a0qOE0K+l7ktqEv06x1u454eR8
1Syxo4IEAAAAIA7qUkGaImmRtXaFtXa7pJslFUoaf4Lz9lpr95R91eZGVJAAAAAAJFJMAckYkyQp
W9KmsjFrrZX0sqTzajpV0jvGmP8zxmwwxvywVpOjggQAAAAggWKtILWQ5Je0u8L4boWWzlXlS0kT
JP1I0nBJn0vaYow550Q3q7JJAxUkAAAAAHESiPcNrLUfSfqo3NDrxphOCi3VG1PTuVUusaOCBAAA
ACBOYg1IBZJKJbWuMN5a0lcxXOdNSeef6KCDB6foiScy9dZbx8ca9W6k4nQCEgAAANDQ5OXlKS8v
L2rswIEDCZ1DTAHJWltsjMmXNEjSc5JkjDHh1wtiuNQ5Ci29q1GzZvP14x/30b33Hh978O8PasPf
NsQybQAAAAAekJubq9zc3KixrVu3Kjs7O2FzqMsSu3mSloWD0psKLZVLk7RMkowx90s61Vo7Jvz6
Z5I+k/S+pFRJN0oaKOn/nehG1XaxY4kdAAAAgDiIOSBZa9eGn3k0S6Glde9IGmyt3Rs+pI2k08qd
kqzQc5NOVagd+P9KGmStfeVE96qqSUPAF6BJAwAAAIC4qFOTBmvtQkkLq3lvXIXXD0p6sC73oc03
AAAAgESqy4NiE6a6JXZWVqXB0qpPAgAAAIA6cnVAqq6CJIlldgAAAAAc5+qAVF0FSRLL7AAAAAA4
zvUBqWKTBipIAAAAAOLF1QGpyiV2VJAAAAAAxImrA1KVS+yoIAEAAACIE1cHJCpIAAAAABLJ1QGJ
ChIAAACARHJ1QKKCBAAAACCRXB2Q6GIHAAAAIJFcH5CoIAEAAABIFFcHpCqX2FFBAgAAABAn3gtI
VJAAAAAAxImrAxJd7AAAAAAkkusDUqUmDVSQAAAAAMSJqwMSe5AAAAAAJJKrA1JNXexKgiVVnAEA
AAAAdefqgFRjBYkldgAAAAAc5uqAVONzkFhiBwAAAMBhrg9IlZo0UEECAAAAECeuDkhVLbHz+/wy
MlSQAAAAADjO1QGpqiV2UmiZHRUkAAAAAE5zdUCqqoIkhZbZUUECAAAA4DRXByQqSAAAAAASyfUB
qWKTBokKEgAAAID4cHVAqnaJHRUkAAAAAHHg6oBU7RI7KkgAAAAA4sDVAam6ClLAF6CCBAAAAMBx
ngxISX4qSAAAAACc5+qAFAjU0KSBChIAAAAAh7k6IFFBAgAAAJBI3gxIVJAAAAAAxIGrA1KND4ql
ggQAAADAYa4OSDVWkAhIAAAAABzm6oBUbZMGHhQLAAAAIA5cHZB8Psna0Fd5Sb4klQSrSE4AAAAA
cBJcH5Ckysvs2IMEAAAAIB5cHZD8/tD3SgGJLnYAAAAA4sDVAYkKEgAAAIBEcnVAKqsgVWzUQAUJ
AAAAQDx4IiBVucSOChIAAAAAh7k6INW4xI4KEgAAAACHuTog1bjEjgoSAAAAAIe5OiAFAqHvVJAA
AAAAJIKrAxIVJAAAAACJ5M2ARAUJAAAAQBy4OiCVNWmgggQAAAAgEVwdkMr2IFUMSAFfQKXB0son
AAAAAMBJcHVAqm6JXcAXUEmwpPIJAAAAAHASCEgAAAAAEOaJgFSxzTcBCQAAAEA8uDog1bQHiYAE
AAAAwGmuDkgssQMAAACQSJ4NSFZWQRtM/KQAAAAANFieDUiSqCIBAAAAcBQBCQAAAADCCEgAAAAA
EEZAAgAAAIAwAhIAAAAAhBGQAAAAACDM1QGpugfF+n2h5ERAAgAAAOAkVwckKkgAAAAAEsnVAcnn
k4yRSkujxwlIAAAAAOLB1QFJCi2zo4IEAAAAIBEISAAAAAAQRkACAAAAgDACEgAAAACEuT4g+f0E
JAAAAACJ4fqARAUJAAAAQKJ4OiCVBkurOAMAAAAA6sbTAYkKEgAAAAAnEZAAAAAAIIyABAAAAABh
BCQAAAAACCMgAQAAAECYJwJSaYVmdQQkAAAAAPHgiYBEBQkAAABAIrg+IPn9BCQAAAAAiVGngGSM
ucUY85kxpsgY87oxpl8tzzvfGFNsjNla23tVVUHyGZ+MDAEJAAAAgKNiDkjGmFGS5kqaLqm3pHcl
rTfGtDjBeZmSlkt6OZb7VRWQpFAViYAEAAAAwEl1qSBNkbTIWrvCWrtd0s2SCiWNP8F5j0l6QtLr
sdyMgAQAAAAgUWIKSMaYJEnZkjaVjVlrrUJVofNqOG+cpI6SZsY6weoCkt/nJyABAAAAcFQgxuNb
SPJL2l1hfLekLlWdYIz5nqT7JF1grQ0aY2KbIBUkAAAAAAkSa0CKiTHGp9CyuunW2k/Khmt7/pQp
U/Txx5kqKZGuvDI0lpubq9zcXAISAAAA0MDk5eUpLy8vauzAgQMJnUOsAalAUqmk1hXGW0v6qorj
MyT1lXSOMeb34TGfJGOMOSbpEmvtlupuNn/+fM2Z00cFBdJzz1WYOAEJAAAAaFDKiiHlbd26VdnZ
2QmbQ0x7kKy1xZLyJQ0qGzOhNXODJL1WxSkHJfWQdI6kXuGvxyRtD//5jRPdkyV2AAAAABKlLkvs
5klaZozJl/SmQl3t0iQtkyRjzP2STrXWjgk3cPig/MnGmD2Sjlhrt9VqggQkAAAAAAkSc0Cy1q4N
P/NolkJL696RNNhauzd8SBtJpzk1Qb+fgAQAAAAgMerUpMFau1DSwmreG3eCc2cqhnbfgYBUWlrF
OAEJAAAAgMPq8qDYhGKJHQAAAIBEISABAAAAQBgBCQAAAADCPBGQiourGCcgAQAAAHCY6wNSUlIN
FSRLQAIAAADgHNcHpORk6dixyuNUkAAAAAA4jYAEAAAAAGEEJAAAAAAIIyABAAAAQJhnApK10eMB
X0ClwdL6mRQAAACABsn1ASkpKRSOSitkISpIAAAAAJzm+oCUnBz6XnGZHQEJAAAAgNM8E5AqPiyW
gAQAAADAaZ4JSBUrSH7jJyABAAAAcJRnAxIVJAAAAABOIyABAAAAQBgBCQAAAADCCEgAAAAAEEZA
AgAAAIAwAhIAAAAAhBGQAAAAACDM9QEpKSn0nQfFAgAAAIg31wckKkgAAAAAEoWABAAAAABhBCQA
AAAACCMgAQAAAECY6wNSWZMGAhIAAACAeHN9QPL7Q18EJAAAAADx5vqAJIWW2VUVkEptqay19TMp
AAAAAA2OpwOSJJXa0nqYEQAAAICGyDMBqaoHxUpimR0AAAAAx3gmIFVXQSIgAQAAAHCKJwJSUlLl
gOQ3fkkEJAAAAADO8URAqnEPUpA9SAAAAACc4fmARAUJAAAAgFM8G5D8PpbYAQAAAHCWZwMSbb4B
AAAAOM3zAYkKEgAAAACneCYgVXwOEl3sAAAAADjNMwGJLnYAAAAA4s2zAYkmDQAAAACc5tmAxB4k
AAAAAE7zREBKSqKLHQAAAID480RAqnKJHU0aAAAAADjMswGJJg0AAAAAnOb5gEQFCQAAAIBTPBuQ
6GIHAAAAwGmeCUgVHxRLkwYAAAAATvNMQGKJHQAAAIB482xAoosdAAAAAKd5NiDRxQ4AAACA0zwb
kGjSAAAAAMBpng1I7EECAAAA4DRPBKSkJKmkRAoGj4/RxQ4AAACA0zwRkFJSQt+PHj0+RpMGAAAA
AE7zREBKSwt9Lyo6Pla2B4kmDQAAAACc4qmAVFh4fMxnfPIZHxUkAAAAAI7xbECSQsvsCEgAAAAA
nOLpgBTwBWjSAAAAAMAxng9IVJAAAAAAOMXTAcnvY4kdAAAAAOd4OiAFfAG62AEAAABwjKcDEk0a
AAAAADjJEwGpUaPQd/YgAQAAAIgnTwQkv19KSZEOH44ep4sdAAAAACd5IiBJUuPGNGkAAAAAEF+e
CUhpaTRpAAAAABBfng9IVJAAAAAAOMXTAYkudgAAAACc5OmARJMGAAAAAE7yfECiggQAAADAKZ4O
SHSxAwAAAOAkTwckltgBAAAAcJKnAlLFB8XSpAEAAACAkzwTkBo3rhyQeA4SAAAAACd5JiBlZEjf
fhs9RpMGAAAAAE7yTEBKT68ckGjSAAAAAMBJdQpIxphbjDGfGWOKjDGvG2P61XDs+caYvxljCowx
hcaYbcaY22K9Z3UVJJo0AAAAAHBKzAHJGDNK0lxJ0yX1lvSupPXGmBbVnHJY0u8k5UjqKukeSfca
Y34ay30zMqTiYuno0eNjLLEDAAAA4KS6VJCmSFpkrV1hrd0u6WZJhZLGV3WwtfYda+0aa+02a+0u
a+0qSesVCky1lpER+n7o0PExutgBAAAAcFJMAckYkyQpW9KmsjFrrZX0sqTzanmN3uFjt8Ry77KA
VH6ZHV3sAAAAADgpEOPxLST5Je2uML5bUpeaTjTGfC6pZfj8GdbapbHcOD099L18QKJJAwAAAAAn
xRqQTsYFktIl/UDSA8aYf1tr19T25OoqSAQkAAAAAE6JNSAVSCqV1LrCeGtJX9V0orV2Z/iP7xtj
2kiaIanGgDRlyhRlZmZKkoqKQmPPP5+rH/4wV5IUMHSxAwAAABqKvLw85eXlRY0dOHAgoXOIKSBZ
a4uNMfmSBkl6TpKMMSb8ekEMl/JLSjnRQfPnz1efPn0kSfv2Sc2bS337lrsIS+wAAACABiM3N1e5
ublRY1u3blV2dnbC5lCXJXbzJC0LB6U3FepqlyZpmSQZY+6XdKq1dkz49URJuyRtD59/oaSfS3o4
lpvSpAEAAABAvMUckKy1a8PPPJql0NK6dyQNttbuDR/SRtJp5U7xSbpf0umSSiR9IukX1trFsdw3
KUlKSWEPEgAAAID4qVOTBmvtQkkLq3lvXIXXj0h6pC73qSg9vUIXO56DBAAAAMBBdXlQbL3JyIh+
UGzAR5MGAAAAAM7xXEBiiR0AAACAePF0QKKLHQAAAAAneTog0cUOAAAAgJM8FZDS06P3INGkAQAA
AICTPBWQ2IMEAAAAIJ48H5DoYgcAAADAKZ4OSDRpAAAAAOAkTwckmjQAAAAAcJKnAlLFJg3sQQIA
AADgJE8FpIwM6dix0JcU6mJXaktlra3fiQEAAABoEDwXkKTjy+wCvoAkKWiD9TQjAAAAAA1JgwhI
LLMDAAAA4ARPBqSyfUh+n18SAQkAAACAMzwZkCpWkHgWEgAAAAAneCogpaeHvpcFJL+hggQAAADA
OZ4KSOxBAgAAABBPngpIZRWksj1IkSV2PCwWAAAAgAM8FZCSk6WkJOnw4dBrmjQAAAAAcJKnApIk
NW58PCDRpAEAAACAkzwZkCousaOCBAAAAMAJngtI6enlltjRxQ4AAACAgzwXkKpcYkeTBgAAAAAO
8GRAYokdAAAAgHjwXECKWmJHFzsAAAAADvJcQKKLHQAAAIB48WRAKltiR5MGAAAAAE7yXEAqv8SO
Jg0AAAAAnOS5gFTVEjsqSAAAAACc4MmAFFliR5MGAAAAAA7yXECqcokdTRoAAAAAOMBzAalsiZ21
LLEDAAAA4CxPBqRgUDpyhC52AAAAAJzluYCUnh76fvgwXewAAAAAOMtzAalx49D3w4dp0gAAAADA
WZ4NSIcOsQcJAAAAgLM8F5CqXGJHFzsAAAAADvBcQIpaYkeTBgAAAAAO8nRA8pnQ9GnSAAAAAMAJ
ngtIZUvsDh2SjDEK+AJUkAAAAAA4wnMBKS0t9P3w4dB3v/ETkAAAAAA4wnMByeeTGjU6HpACvgBN
GgAAAAA4wnMBSQrtQzp0KPRnltgBAAAAcIpnA1JkiZ2PJXYAAAAAnOHJgNSokVRUFPpzwBegix0A
AAAAR3g+INGkAQAAAIBTPB+Q2IMEAAAAwCkNIiDRxQ4AAACAEzwfkGjSAAAAAMApng9INGkAAAAA
4JQGEZCoIAEAAABwgucDEl3sAAAAADjF8wGJJg0AAAAAnNIgAhIVJAAAAABO8HxAoosdAAAAAKd4
PiCxxA4AAACAUzwfkGjSAAAAAMApng1IxcVSaSl7kAAAAAA4x7MBSQpVkXhQLAAAAACneD4g0aQB
AAAAgFM8H5Bo0gAAAADAKQ0iIFFBAgAAAOAEzwckutgBAAAAcIrnAxJNGgAAAAA4xfMBiSYNAAAA
AJzi+YAUMOxBAgAAAOAM7wckutgBAAAAcIjnAxJL7AAAAAA4xZMBKSVFMoYmDQAAAACc5cmAZIyU
mspzkAAAAAA4y5MBSQots+M5SAAAAACc5PmARJMGAAAAAE5pEAGJChIAAAAAJ3g6IBUW0sUOAAAA
gHM8HZDoYgcAAADASZ4PSDRpAAAAAOAUzwck9iABAAAAcIpnA1JqqnT0KF3sAAAAADinTgHJGHOL
MeYzY0yRMeZ1Y0y/Go692hizwRizxxhzwBjzmjHmkrpPOSQlJRSQaNIAAAAAwCkxByRjzChJcyVN
l9Rb0ruS1htjWlRzSn9JGyRdKqmPpM2SnjfG9KrTjMNSU6UjR2jSAAAAAMA5dakgTZG0yFq7wlq7
XdLNkgolja/qYGvtFGvtQ9bafGvtJ9baaZI+lnRFnWet4xUk9iABAAAAcEpMAckYkyQpW9KmsjFr
rZX0sqTzankNIylD0r5Y7l1R2R4kv/HLyipogydzOQAAAACIuYLUQpJf0u4K47sltanlNX4hqbGk
tTHeO0pKyvEldpJYZgcAAADgpAUSeTNjzGhJd0m60lpbcKLjp0yZoszMzKix3Nxc5ebmRnWxk6SS
YImS/EnxmDYAAACABMjLy1NeXl7U2IEDBxI6h1gDUoGkUkmtK4y3lvRVTScaY66RtFjSCGvt5trc
bP78+erTp0+V75VVkPw+vySxDwkAAADwuLJiSHlbt25VdnZ2wuYQ0xI7a22xpHxJg8rGwnuKBkl6
rbrzjDG5kpZIusZa++e6TTVaxQoSz0ICAAAAcLLqssRunqRlxph8SW8q1NUuTdIySTLG3C/pVGvt
mPDr0eH3Jkv6pzGmrPpUZK09WNeJRypIhgoSAAAAAGfEHJCstWvDzzyapdDSunckDbbW7g0f0kbS
aeVOuVGhxg6/D3+VWa5qWoPXRmqqdOyY5DfH9yABAAAAwMmoU5MGa+1CSQureW9chdcD63KPE0lJ
CV+/lC52AAAAAJxRlwfFukJqauh7sJQldgAAAACc4dmAVFZBCpbQpAEAAACAMzwbkCIVpBL2IAEA
AABwhmcDUlkFqaSYJXYAAAAAnOHZgFSxgkSTBgAAAAAny7MBqayCVFrMEjsAAAAAzvBsQCqrIJWy
xA4AAACAQzwbkCJ7kI7RxQ4AAACAMzwbkKggAQAAAHCaZwNSpQoSTRoAAAAAnCTPBqSyClIJTRoA
AAAAOMSzAel4BYkldgAAAACc4dmA5PdLgYBUfJQmDQAAAACc4dmAJIWqSGV7kKggAQAAADhZng5I
qanSsaMssQMAAADgDE8HpPIVJLrYAQAAADhZng5IqanSsSNUkAAAAAA4w9MBKSXleJMGAhIAAACA
k+XpgBSqINHFDgAAAIAzPB2QUlJo0gAAAADAOZ4OSKmp0tEjRj7jo0kDAAAAgJPm6YCUkiIdPSoF
fAEqSAAAAABOmqcDUmqqdOSI5Dd+AhIAAACAk+bpgFS+gkSTBgAAAAAny9MBqayCxBI7AAAAAE7w
dEAqqyD5fSyxAwAAAHDyPB2QyleQ6GIHAAAA4GR5OiBFKkg0aQAAAADggAYRkNiDhP/f3r3HyHWW
dxz/PrOXGa93A46vSUgVh0AoFUoTc4uANG1oEQ2i6kVEDlJoQa0AV5WsCtpKldIGCZSWXLilIG4m
BVzRFAqtAJdEqLSFEORACMQJgjgJYOwkJNhee68zb/84xzDZ7DqeObM7Oy/fj3TknTPvmXnP6pw5
/u37nHckSZKkXsgmIDmLnSRJkqSqsghITtIgSZIkqReyCEhO0iBJkiSpFwY+IPk9SJIkSZJ6ZeAD
UqsFNSyxkyRJklTdQAekRqP4dyicpEGSJElSdQMdkOr14t8althJkiRJqi6LgBSW2EmSJEnqgSwC
Ug1L7CRJkiRVl0VAiuQIkiRJkqTqMglI3oMkSZIkqbpsApJfFCtJkiSpqkwCkiV2kiRJkqrLIiCR
nKRBkiRJUnVZBKRoeQ+SJEmSpOqyCEipZYmdJEmSpOqyCEi0nKRBkiRJUnUDHZAajfIHS+wkSZIk
9cBAB6ThYajVLLGTJEmS1BsDHZCgLLNrOoudJEmSpOqyCEiOIEmSJEnqhTwCUtNJGiRJkiRVl01A
cgRJkiRJUlVZBKTmvCV2kiRJkqrLIiCleSdpkCRJklRdFgGpZYmdJEmSpB7IIyBZYidJkiSpB7II
SM15Z7GTJEmSVF0WAak15wiSJEmSpOoGPiA1GsUIkgFJkiRJUlUDH5DqdWjOOYudJEmSpOoyCUiW
2EmSJEmqLpOA5CQNkiRJkqrLIiDNlyV2KaV+d0eSJEnSAMsjIM0OAXgfkiRJkqRKMglIwwCW2UmS
JEmqJKuA5EQNkiRJkqrIJCAVJXYGJEmSJElVZBGQ5mbKEjvvQZIkSZJUQRYByREkSZIkSb2QRUBq
zXsPkiRJkqTqBj4gNRpAy1nsJEmSJFU38AGpXgeSJXaSJEmSqssjILWcpEGSJElSdVkFpLnmXH87
I0mSJGmgZRWQLLGTJEmSVEUeAak5AsBcyxEkSZIkSd3LJCCNApbYSZIkSaqmq4AUETsiYn9ETEXE
7RHxgpO03RIRn4iI+yKiGRHXd9/dJytK7IoRpNnmbC9fWpIkSdIvmY4DUkRcAVwHXA1cCNwF7ImI
DUtsUgceBt4GfKvLfi7JEjtJkiRJvdLNCNJO4AMppZtTSvcCbwSOA69frHFK6cGU0s6U0seBI913
dXGW2EmSJEnqlY4CUkSMANuA206sSykl4Fbg4t527dRYYidJkiSpVzodQdoADAGHFqw/BGzpSY86
ZImdJEmSpF4Z+FnsGg0ssZMkSZLUE8Mdtn8UaAKbF6zfDBzsSY/a7Ny5k6c97WlPWLd9+3a2b9/+
88fDw1hiJ0mSJGVg9+7d7N69+wnrDh8+vKJ96CggpZTmImIvcBnwOYCIiPLxu3vduRtuuIGLLrro
pG0ioD4ywgyW2EmSJEmDbOFgCMCdd97Jtm3bVqwPnY4gAVwP7CqD0h0Us9qNAbsAIuIdwJkppded
2CAiLgACGAc2lo9nU0r7qnW/0BgdYpaaJXaSJEmSKuk4IKWUPlV+59E1FKV13wJekVJ6pGyyBTh7
wWbfBFL580XAlcCDwLnddHqheh2GGHEESZIkSVIl3YwgkVK6Cbhpief+ZJF1yzoZRL0OtTTiPUiS
JC+SCTEAAA4GSURBVEmSKhn4WeygDEiMWmInSZIkqZJ8AlKyxE6SJElSNdkEpLDETpIkSVJF2QSk
WssSO0mSJEnVZBOQaFliJ0mSJKmabAJStCyxkyRJklRNFgGp0QAssZMkSZJUURYBqV4HmpbYSZIk
Saomq4BkiZ0kSZKkKrIJSKk56giSJEmSpEoyCkgj3oMkSZIkqZJ8AtK89yBJkiRJqiafgDQ36j1I
kiRJkirJJiC15i2xkyRJklRNXgHJEjtJkiRJFeQTkGYtsZMkSZJUTTYBqTlniZ0kSZKkarIJSMl7
kCRJkiRVlEVAajSA5igz85bYSZIkSepeFgGpXgdaI8w6giRJkiSpgnwCUtOAJEmSJKmajALSqPcg
SZIkSaokn4DUGnGab0mSJEmVZBGQTkzSMNcyIEmSJEnqXhYBac0aYL7BbHOm312RJEmSNMAyCkh1
5tIsrdTqd3ckSZIkDagsAtLYGDDfAGBm3lEkSZIkSd3JIiCdKLEDmLHMTpIkSVKXsgtI0/PT/e2M
JEmSpIGVRUAqZrGrAwYkSZIkSd3LIiBFwGjNESRJkiRJ1WQRkAAaw07SIEmSJKmajAKSJXaSJEmS
qsknII1YYidJkiSpmmwC0hoDkiRJkqSKsglIY6N+D5IkSZKkarIJSGvr3oMkSZIkqZqMApIldpIk
SZKqySYgjTVGIIUBSZIkSVLX8glIa4Jaq+H3IEmSJEnqWj4BaQyiVXcESZIkSVLXsglIa9ZAzDcM
SJIkSZK6llVAomlAkiRJktS9rAJSmmv4PUiSJEmSupZNQBobgzTvPUiSJEmSupdNQBofh9ZMgykD
kiRJkqQuZRWQmG8wNWuJnSRJkqTuZBOQJiaA+QaT044gSZIkSepOZgGpzuT0VL+7IkmSJGlA5RWQ
5tYyOXO8312RJEmSNKCyCUjj48DsOEdnj/a7K5IkSZIGVDYBaWICmJlg0oAkSZIkqUt5BaTZCY7P
T/a7K5IkSZIGVDYBaXwcmJlgqukIkiRJkqTuZBOQhodhJI0znSZJKfW7O5IkSZIGUDYBCaBRmyDR
Ymreqb4lSZIkdS6rgDQ2PAHA0RnL7CRJkiR1LquAND4yDuBU35IkSZK6kldAGi1GkCZnnclOkiRJ
UueyCkgTdUvsJEmSJHUvq4B0+toyIFliJ0mSJKkLWQWkzeuKe5AssZMkSZLUjawC0pbTy0kaLLGT
JEmS1IWsAtKG9TWYXcsRA5IkSZKkLmQVkNavB2Ym+OnkkX53RZIkSdIAyiogbdgAHNvEDx97uN9d
kSRJkjSAsgpI69cDxzbxkyMGJEmSJEmdyzAgbebg5KF+d0WSJEnSAMoqIG3YAExu5qfTBiRJkiRJ
ncsqII2PQ216E4/PGZAkSZIkdS6rgBQBp9U2M5V+xmxztt/dkSRJkjRgsgpIAGecthmAh485UYMk
SZKkzmQXkM7ZuAmAQ07UIEmSJKlD2QWk55x5FgAPHX6ozz2RJEmSNGiyC0jP27oZptZx10/u6XdX
JEmSJA2Y7ALSuecGPPJc9j6Yd0A6dqzfPZAkSZLyk11AevazgYd/jbsPfbffXVk2d99dTGn+la/0
uyeSJElSXrILSGecARt4Lj+avpcv//ccL3853H8/HD3a7571zj3l4Ng3vtHffmh57d69u99dkPrO
80DyPJBWWlcBKSJ2RMT+iJiKiNsj4gVP0f7SiNgbEdMR8b2IeF133T01l5zzEpoxw1ve+z/cdhs8
85mwY8dyvuPKiuh3D7QSvCBKngcSeB5IK63jgBQRVwDXAVcDFwJ3AXsiYsMS7c8B/hO4DbgAeBfw
oYj47e66/NSuvHQbHD6bB8c+/fN1+/cv17utvFar3z2QJEmS8tTNCNJO4AMppZtTSvcCbwSOA69f
ov2bgPtTSm9NKd2XUnofcEv5OsviVa8KxvZfwaNn/jOMHwRgZGS53m3lTU4W/xqUJEmSpN4a7qRx
RIwA24C3n1iXUkoRcStw8RKbvRi4dcG6PcANnbx3J+p12PWGv+bKr+5i/srL4a6ruHPtJH/woQPM
jB5gtDbGr5/xPF6y9flsO2Mb69asW66uLIsjR4p/c7qvSpKkQbRvH9x8M7z97ZbAS7noKCABG4Ah
4NCC9YeA85fYZssS7U+LiHpKaWaRbRoA+/bt67B7v/DMM+HDl1zHNV96J/sveAuHp9fymS9ugOMb
YeQ4/376Z2G0mCt7vPUMNtSexZpYx8GHJti0rsHG9UNMT9UIhlh/+hC1qFGjxpGjwdEjkFqw7unB
mrUQBLUaQFCLIAJqAQRMHg0OHAi2boV6vfjkDKLtQzQIgIhifflzcx7m56HRSCSaNGmRUpMWTe7Z
14LnNfnYt6f54l8+ws/mDnGs+TOG01pG0zhrahM0hsYZGx5nbHiC0aFhhoeC4aFiP4IatRii1vZJ
nlrF+9UbT/50rxEkimA2MVHuG4tdBZ64brELRSyyXW3RK8oT17VacNe3g7OfARs3LtqkI4v141Rf
brFtT23Dzra7+/v72XHte5Z8z7k5OHQIzjqru4vyU23T9X5W3LaqRFryuU5+Tyd7nU6k3rxMpf60
73ev9qtXO/ZU/bn7+/ez4x9u7Ml7nYpB+/2s/Ov0SK9OjFXw+7nlFnj8MXhoCNaOJ+bTPPOtWSKC
oRhhOIYZihGGaiMMxfApfz62t/vuDx5g5zvf33Uf+/mZLPXCwz/+4YkfGyvxfpE6+JCKiDOAHwMX
p5S+3rb+WuCSlNKTRpEi4j7gIymla9vWvZLivqSxxQJSRFwJfKKTHZEkSZKUtdemlD653G/S6QjS
o0AT2Lxg/Wbg4BLbHFyi/ZElRo+gKMF7LfAAMN1hHyVJkiTlowGcQ5ERll1HASmlNBcRe4HLgM8B
RESUj9+9xGZfA165YN3vlOuXep+fAsueDiVJkiQNhK+u1Bt1M4vd9cCfRsRVEfEc4P3AGLALICLe
EREfa2v/fuDciLg2Is6PiDcDf1S+jiRJkiStGp2W2JFS+lT5nUfXUJTKfQt4RUrpkbLJFuDstvYP
RMTlFLPW/QXwI+ANKaWFM9tJkiRJUl91NEmDJEmSJOWsmxI7SZIkScqSAUmSJEmSSqsuIEXEjojY
HxFTEXF7RLyg332SeiEiro6I1oLlngVtromIAxFxPCK+FBHnLXi+HhHvi4hHI+JoRNwSEZtWdk+k
UxcRL4uIz0XEj8tj/tWLtKl83EfEuoj4REQcjojHI+JDEbF2ufdPOhVPdR5ExEcXuT58fkEbzwMN
rIj4m4i4IyKORMShiPhMRDx7kXar4nqwqgJSRFwBXAdcDVwI3AXsKSeFkHLwHYrJTbaUy0tPPBER
fwX8OfBnwAuBYxTH/2jb9jcClwN/CFwCnAn824r0XOrOWorJfN4MPOmm1x4e958EfpXiaycuL9t9
oJc7IlVw0vOg9AWeeH3YvuB5zwMNspcB7wFeBLwcGAH+KyLWnGiwqq4HKaVVswC3A+9qexwUs969
td99c3GpulAE/ztP8vwBYGfb49OAKeA1bY9ngN9va3M+0AJe2O/9c3F5qqU8Vl+9YF3l4768ELaA
C9vavAKYB7b0e79dXNqXJc6DjwKfPsk2ngcuWS3AhvJ4fWnbulVzPVg1I0gRMQJsA247sS4Ve3Ur
cHG/+iX12LPKEosfRMTHI+JsgIjYSvEXw/bj/wjwdX5x/D+fYmr+9jb3AQ/hOaIB1MPj/sXA4yml
b7a9/K0Uf6l/0XL1X+qxS8vSo3sj4qaIOL3tuW14HigvT6c4Nh+D1Xc9WDUBiSJJDgGHFqw/RPEL
kwbd7cAfU/wl443AVuArZV3sFoqT92TH/2ZgtvzAWKqNNEh6ddxvAR5ufzKl1KS48HpuaBB8AbgK
+C3grcBvAJ+PiCif34LngTJRHtc3Av+bUjpxL/aquh50/EWxkrqTUtrT9vA7EXEH8CDwGuDe/vRK
ktRvKaVPtT38bkTcDfwAuBT4cl86JS2fm4DnAi/pd0eWsppGkB4FmhTpsN1m4ODKd0daXimlw8D3
gPMojvHg5Mf/QWA0Ik47SRtpkPTquD8ILJzFaAg4Hc8NDaCU0n6K/xedmMHL80BZiIj3Ar8LXJpS
+knbU6vqerBqAlJKaQ7YSzHjBPDzIbjLgK/2q1/ScomIcYqL34HyYniQJx7/p1HUy544/vdS3GTY
3uZ84FeAr61Qt6We6eFx/zXg6RFxYdvLX0Zxsf36cvVfWi4R8QxgPXDiP5CeBxp4ZTj6PeA3U0oP
tT+32q4Hq63E7npgV0TsBe4AdgJjwK5+dkrqhYj4R+A/KMrqzgL+HpgD/qVsciPwtxHxfeAB4G0U
szh+FoqbFSPiw8D1EfE4cBR4N/B/KaU7VnBXpFNW3mN3HsXFCeDciLgAeCyl9EN6cNynlO6NiD3A
ByPiTcAoxXSyu1NK/uVcfXey86BcrqaYqvhg2e5aigqDPeB5oMEXETdRTF3/auBYRJwYKTqcUpou
f14914N+T/O3yLR/by5/KVMUKfD5/e6Ti0svFmB3eaJPUcy48klg64I2f0cxzeVxigvjeQuer5cn
+qPlB8O/Apv6vW8uLkstFDebtyhKqNuXj7S1qXzcU8yI9HHgMPA48EFgrN/77+KS0snPA6ABfJEi
HE0D9wP/BGxc8BqeBy4Duyxx/DeBqxa0WxXXgyhfSJIkSZJ+6a2ae5AkSZIkqd8MSJIkSZJUMiBJ
kiRJUsmAJEmSJEklA5IkSZIklQxIkiRJklQyIEmSJElSyYAkSZIkSSUDkiRJkiSVDEiSJEmSVDIg
SZIkSVLp/wEMTuG3mNS+jAAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|| 2000/2000 [01:46&lt;00:00, 18.70it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check the precision of our generator for predicting the third character:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[458]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XT</span><span class="p">)</span>
<span class="n">pred</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[458]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([23,  9,  5, ..., 59,  4, 22], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[459]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">act_y</span> <span class="o">=</span> <span class="n">YT</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">act_y</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[459]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([ 1, 66, 64, ..., 53, 43, 68], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[460]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">act_y</span><span class="o">==</span><span class="n">pred</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[460]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.00358</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Machine-Translation">Machine Translation<a class="anchor-link" href="#Machine-Translation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on this greate post: <a href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html</a> and its attached code: <a href="https://github.com/keras-team/keras/blob/master/examples/lstm_seq2seq.py">https://github.com/keras-team/keras/blob/master/examples/lstm_seq2seq.py</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-is-sequence-to-sequence-learning?">What is sequence-to-sequence learning?<a class="anchor-link" href="#What-is-sequence-to-sequence-learning?">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sequence-to-sequence learning (Seq2Seq) is about training models to convert sequences from one domain (e.g. sentences in English) to sequences in another domain (e.g. the same sentences translated to Hebrew).</p>
<p>This can be used for machine translation or for free-form question answering (generating a natural language answer given a natural language question) -- in general, it is applicable any time you need to generate text.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the general case, input sequences and output sequences have different lengths (e.g. machine translation) and the entire input sequence is required in order to start predicting the target. This requires a more advanced setup, which is what people commonly refer to when mentioning "sequence to sequence models" with no further context. Here's how it works:</p>
<p>A RNN layer (or stack thereof) acts as "encoder": it processes the input sequence and returns its own internal state. Note that we discard the outputs of the encoder RNN, only recovering the state. This state will serve as the "context", or "conditioning", of the decoder in the next step.
Another RNN layer (or stack thereof) acts as "decoder": it is trained to predict the next characters of the target sequence, given previous characters of the target sequence. Specifically, it is trained to turn the target sequences into the same sequences but offset by one timestep in the future, a training process called "teacher forcing" in this context. Importantly, the encoder uses as initial state the state vectors from the encoder, which is how the decoder obtains information about what it is supposed to generate. Effectively, the decoder learns to generate targets[t+1...] given targets[...t], conditioned on the input sequence.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="k">import</span> <span class="n">HTML</span> 
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span> <span class="s2">&quot;https://blog.keras.io/img/seq2seq/seq2seq-teacher-forcing.png&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[34]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<img src="https://blog.keras.io/img/seq2seq/seq2seq-teacher-forcing.png"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take some english-hebrew pairs from <a href="http://www.manythings.org/anki/">http://www.manythings.org/anki/</a>, and train a model to translate english to hebrew.
Unicode adds some issues to confront, so it is better to convert the file to utf-8.</p>
<p>Let's read the file with a utf-8 encoding:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;heb.txt&#39;</span>
<span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;corpus length:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>corpus length: 6885029
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[3]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&#39;\ufeffHi.\t.\nHi.\t.\nRun!\t!\nRun!\t!\nRun!\t!\nWho?\t?\nWow!\t!\nWow!\t!\nFire!\t!\nFire!\t!\nHelp!\t!\nJump.\t.\nStop!\t!\nGo on.\t.\nGo on.\t.\nGo on.\t.\nHello!\t.\nHello!\t.\nI ran.\t.\nI see.\t .\nI see.\t .\nI see.\t .\nI see.\t \nI try.\t&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We first read this file, go over each line and split it to english input text and hebrew target text.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Vectorize the data.</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Number of samples to train on.</span>
<span class="n">input_texts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">target_texts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">input_characters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">target_characters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[:</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]:</span>
    <span class="n">input_text</span><span class="p">,</span> <span class="n">target_text</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># We use &quot;tab&quot; as the &quot;start sequence&quot; character</span>
    <span class="c1"># for the targets, and &quot;\n&quot; as &quot;end sequence&quot; character.</span>
    <span class="n">target_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">target_text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">input_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>
    <span class="n">target_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_text</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">input_text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">input_characters</span><span class="p">:</span>
            <span class="n">input_characters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">target_text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_characters</span><span class="p">:</span>
            <span class="n">target_characters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

<span class="n">input_characters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">input_characters</span><span class="p">))</span>
<span class="n">target_characters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">target_characters</span><span class="p">))</span>
<span class="n">num_encoder_tokens</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_characters</span><span class="p">)</span>
<span class="n">num_decoder_tokens</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_characters</span><span class="p">)</span>
<span class="n">max_encoder_seq_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">input_texts</span><span class="p">])</span>
<span class="n">max_decoder_seq_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">target_texts</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of samples:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_texts</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of unique input tokens:&#39;</span><span class="p">,</span> <span class="n">num_encoder_tokens</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of unique output tokens:&#39;</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max sequence length for inputs:&#39;</span><span class="p">,</span> <span class="n">max_encoder_seq_length</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max sequence length for outputs:&#39;</span><span class="p">,</span> <span class="n">max_decoder_seq_length</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of samples: 10000
Number of unique input tokens: 69
Number of unique output tokens: 60
Max sequence length for inputs: 15
Max sequence length for outputs: 37
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create dictionaries from char to index, for both the english input and the hebrew output.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_token_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">char</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_characters</span><span class="p">)])</span>
<span class="n">target_token_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">char</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">target_characters</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The seq2seq model requires two inputs and one output. Let's initialize zero arrays for these three, and then add the required contents</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">encoder_input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_texts</span><span class="p">),</span> <span class="n">max_encoder_seq_length</span><span class="p">,</span> <span class="n">num_encoder_tokens</span><span class="p">),</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">decoder_input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_texts</span><span class="p">),</span> <span class="n">max_decoder_seq_length</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">),</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">decoder_target_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_texts</span><span class="p">),</span> <span class="n">max_decoder_seq_length</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">),</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">target_text</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_texts</span><span class="p">,</span> <span class="n">target_texts</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_text</span><span class="p">):</span>
        <span class="n">encoder_input_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">input_token_index</span><span class="p">[</span><span class="n">char</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">target_text</span><span class="p">):</span>
        <span class="c1"># decoder_target_data is ahead of decoder_input_data by one timestep</span>
        <span class="n">decoder_input_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">target_token_index</span><span class="p">[</span><span class="n">char</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># decoder_target_data will be ahead by one timestep</span>
            <span class="c1"># and will not include the start character.</span>
            <span class="n">decoder_target_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">target_token_index</span><span class="p">[</span><span class="n">char</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define an input sequence and process it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># Batch size for training.</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Number of epochs to train for.</span>
<span class="n">latent_dim</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c1"># Latent dimensionality of the encoding space.</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder_inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_encoder_tokens</span><span class="p">))</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">LSTM</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">return_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">encoder_outputs</span><span class="p">,</span> <span class="n">state_h</span><span class="p">,</span> <span class="n">state_c</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">encoder_inputs</span><span class="p">)</span>
<span class="c1"># We discard `encoder_outputs` and only keep the states.</span>
<span class="n">encoder_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">state_h</span><span class="p">,</span> <span class="n">state_c</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set up the decoder, using <code>encoder_states</code> as initial state.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder_inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">))</span>
<span class="c1"># We set up our decoder to return full output sequences,</span>
<span class="c1"># and to return internal states as well. We don&#39;t use the</span>
<span class="c1"># return states in the training model, but we will use them in inference.</span>
<span class="n">decoder_lstm</span> <span class="o">=</span> <span class="n">LSTM</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">decoder_outputs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decoder_lstm</span><span class="p">(</span><span class="n">decoder_inputs</span><span class="p">,</span>
                                     <span class="n">initial_state</span><span class="o">=</span><span class="n">encoder_states</span><span class="p">)</span>
<span class="n">decoder_dense</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">num_decoder_tokens</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
<span class="n">decoder_outputs</span> <span class="o">=</span> <span class="n">decoder_dense</span><span class="p">(</span><span class="n">decoder_outputs</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define the model that will turn <code>encoder_input_data</code> &amp; <code>decoder_input_data</code> into <code>decoder_target_data</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="n">encoder_inputs</span><span class="p">,</span> <span class="n">decoder_inputs</span><span class="p">],</span> <span class="n">decoder_outputs</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run training</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">encoder_input_data</span><span class="p">,</span> <span class="n">decoder_input_data</span><span class="p">],</span> <span class="n">decoder_target_data</span><span class="p">,</span>
          <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
          <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
          <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 8000 samples, validate on 2000 samples
Epoch 1/100
8000/8000 [==============================] - 36s 5ms/step - loss: 0.9449 - acc: 0.0840 - val_loss: 1.0113 - val_acc: 0.1105
Epoch 2/100
8000/8000 [==============================] - 38s 5ms/step - loss: 0.7937 - acc: 0.1242 - val_loss: 0.8882 - val_acc: 0.1405
Epoch 3/100
8000/8000 [==============================] - 38s 5ms/step - loss: 0.7144 - acc: 0.1414 - val_loss: 0.8308 - val_acc: 0.1561
Epoch 4/100
8000/8000 [==============================] - 38s 5ms/step - loss: 0.6674 - acc: 0.1542 - val_loss: 0.7856 - val_acc: 0.1638
Epoch 5/100
8000/8000 [==============================] - 38s 5ms/step - loss: 0.6312 - acc: 0.1633 - val_loss: 0.7456 - val_acc: 0.1779
Epoch 6/100
8000/8000 [==============================] - 38s 5ms/step - loss: 0.5999 - acc: 0.1709 - val_loss: 0.7224 - val_acc: 0.1838
Epoch 7/100
8000/8000 [==============================] - 39s 5ms/step - loss: 0.4428 - acc: 0.2126 - val_loss: 0.6261 - val_acc: 0.2118
Epoch 16/100
8000/8000 [==============================] - 39s 5ms/step - loss: 0.4302 - acc: 0.2160 - val_loss: 0.6243 - val_acc: 0.2124
Epoch 17/100
8000/8000 [==============================] - 40s 5ms/step - loss: 0.3241 - acc: 0.2458 - val_loss: 0.6239 - val_acc: 0.2204
Epoch 27/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.3145 - acc: 0.2483 - val_loss: 0.6330 - val_acc: 0.2199
Epoch 28/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.3060 - acc: 0.2509 - val_loss: 0.6400 - val_acc: 0.2199
Epoch 29/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.2125 - acc: 0.2772 - val_loss: 0.7177 - val_acc: 0.2182
Epoch 42/100
8000/8000 [==============================] - 40s 5ms/step - loss: 0.2067 - acc: 0.2794 - val_loss: 0.7313 - val_acc: 0.2167
Epoch 43/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.1371 - acc: 0.2985 - val_loss: 0.8508 - val_acc: 0.2148
Epoch 58/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.1130 - acc: 0.3057 - val_loss: 0.9045 - val_acc: 0.2131
Epoch 65/100
8000/8000 [==============================] - 40s 5ms/step - loss: 0.0914 - acc: 0.3117 - val_loss: 0.9753 - val_acc: 0.2104
Epoch 73/100
8000/8000 [==============================] - 41s 5ms/step - loss: 0.0720 - acc: 0.3172 - val_loss: 1.0502 - val_acc: 0.2102
Epoch 82/100
8000/8000 [==============================] - 42s 5ms/step - loss: 0.0592 - acc: 0.3210 - val_loss: 1.1068 - val_acc: 0.2089
Epoch 91/100
8000/8000 [==============================] - 40s 5ms/step - loss: 0.0493 - acc: 0.3238 - val_loss: 1.1625 - val_acc: 0.2073
Epoch 100/100
4288/8000 [===============&gt;..............] - ETA: 17s - loss: 0.0461 - acc: 0.3255</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save model</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;s2s.h5&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\keras\engine\topology.py:2344: UserWarning: Layer lstm_4 was passed non-serializable keyword arguments: {&#39;initial_state&#39;: [DimShuffle{0,1}.0, DimShuffle{0,1}.0]}. They will not be included in the serialized model (and thus will be missing at deserialization time).
  str(node.arguments) + &#39;. They will not be included &#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next: inference mode (sampling).
Here's the drill:</p>
<ol>
<li>encode input and retrieve initial decoder state</li>
<li>run one step of decoder with this initial state
and a "start of sequence" token as target.
Output will be the next target token</li>
<li>repeat with the current target token and current states</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define sampling models</span>
<span class="n">encoder_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">encoder_inputs</span><span class="p">,</span> <span class="n">encoder_states</span><span class="p">)</span>

<span class="n">decoder_state_input_h</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,))</span>
<span class="n">decoder_state_input_c</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,))</span>
<span class="n">decoder_states_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">decoder_state_input_h</span><span class="p">,</span> <span class="n">decoder_state_input_c</span><span class="p">]</span>
<span class="n">decoder_outputs</span><span class="p">,</span> <span class="n">state_h</span><span class="p">,</span> <span class="n">state_c</span> <span class="o">=</span> <span class="n">decoder_lstm</span><span class="p">(</span>
    <span class="n">decoder_inputs</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">decoder_states_inputs</span><span class="p">)</span>
<span class="n">decoder_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">state_h</span><span class="p">,</span> <span class="n">state_c</span><span class="p">]</span>
<span class="n">decoder_outputs</span> <span class="o">=</span> <span class="n">decoder_dense</span><span class="p">(</span><span class="n">decoder_outputs</span><span class="p">)</span>
<span class="n">decoder_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="p">[</span><span class="n">decoder_inputs</span><span class="p">]</span> <span class="o">+</span> <span class="n">decoder_states_inputs</span><span class="p">,</span>
    <span class="p">[</span><span class="n">decoder_outputs</span><span class="p">]</span> <span class="o">+</span> <span class="n">decoder_states</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Reverse-lookup token index to decode sequences back to something readable.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reverse_input_char_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_token_index</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">reverse_target_char_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">target_token_index</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">decode_sequence</span><span class="p">(</span><span class="n">input_seq</span><span class="p">):</span>
    <span class="c1"># Encode the input as state vectors.</span>
    <span class="n">states_value</span> <span class="o">=</span> <span class="n">encoder_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_seq</span><span class="p">)</span>

    <span class="c1"># Generate empty target sequence of length 1.</span>
    <span class="n">target_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">))</span>
    <span class="c1"># Populate the first character of target sequence with the start character.</span>
    <span class="n">target_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">target_token_index</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>

    <span class="c1"># Sampling loop for a batch of sequences</span>
    <span class="c1"># (to simplify, here we assume a batch of size 1).</span>
    <span class="n">stop_condition</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">decoded_sentence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">stop_condition</span><span class="p">:</span>
        <span class="n">output_tokens</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">decoder_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
            <span class="p">[</span><span class="n">target_seq</span><span class="p">]</span> <span class="o">+</span> <span class="n">states_value</span><span class="p">)</span>

        <span class="c1"># Sample a token</span>
        <span class="n">sampled_token_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output_tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">sampled_char</span> <span class="o">=</span> <span class="n">reverse_target_char_index</span><span class="p">[</span><span class="n">sampled_token_index</span><span class="p">]</span>
        <span class="n">decoded_sentence</span> <span class="o">+=</span> <span class="n">sampled_char</span>

        <span class="c1"># Exit condition: either hit max length</span>
        <span class="c1"># or find stop character.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sampled_char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">or</span>
           <span class="nb">len</span><span class="p">(</span><span class="n">decoded_sentence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_decoder_seq_length</span><span class="p">):</span>
            <span class="n">stop_condition</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Update the target sequence (of length 1).</span>
        <span class="n">target_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_decoder_tokens</span><span class="p">))</span>
        <span class="n">target_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sampled_token_index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

        <span class="c1"># Update states</span>
        <span class="n">states_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">decoded_sentence</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now watch the magic..</p>
<p>Here we translate the first 100 english sentences using the trained model:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">seq_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Take one sequence (part of the training test)</span>
    <span class="c1"># for trying out decoding.</span>
    <span class="n">input_seq</span> <span class="o">=</span> <span class="n">encoder_input_data</span><span class="p">[</span><span class="n">seq_index</span><span class="p">:</span> <span class="n">seq_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">decoded_sentence</span> <span class="o">=</span> <span class="n">decode_sequence</span><span class="p">(</span><span class="n">input_seq</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input sentence:&#39;</span><span class="p">,</span> <span class="n">input_texts</span><span class="p">[</span><span class="n">seq_index</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decoded sentence:&#39;</span><span class="p">,</span> <span class="n">decoded_sentence</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>-
Input sentence: Hi.
Decoded sentence: .

-
Input sentence: Hi.
Decoded sentence: .

-
Input sentence: Run!
Decoded sentence: !

-
Input sentence: Run!
Decoded sentence: !

-
Input sentence: Run!
Decoded sentence: !

-
Input sentence: Who?
Decoded sentence:  ?

-
Input sentence: Wow!
Decoded sentence: !

-
Input sentence: Wow!
Decoded sentence: !

-
Input sentence: Fire!
Decoded sentence: !

-
Input sentence: Fire!
Decoded sentence: !

-
Input sentence: Help!
Decoded sentence: !

-
Input sentence: Jump.
Decoded sentence: .

-
Input sentence: Stop!
Decoded sentence: !

-
Input sentence: Go on.
Decoded sentence: .

-
Input sentence: Go on.
Decoded sentence: .

-
Input sentence: Go on.
Decoded sentence: .

-
Input sentence: Hello!
Decoded sentence: .

-
Input sentence: Hello!
Decoded sentence: .

-
Input sentence: I ran.
Decoded sentence: .

-
Input sentence: I see.
Decoded sentence:  .

-
Input sentence: I see.
Decoded sentence:  .

-
Input sentence: I see.
Decoded sentence:  .

-
Input sentence: I see.
Decoded sentence:  .

-
Input sentence: I try.
Decoded sentence:  .

-
Input sentence: I try.
Decoded sentence:  .

-
Input sentence: I try.
Decoded sentence:  .

-
Input sentence: I won!
Decoded sentence: !

-
Input sentence: I won!
Decoded sentence: !

-
Input sentence: I won.
Decoded sentence: .

-
Input sentence: Oh no!
Decoded sentence:  !

-
Input sentence: Relax.
Decoded sentence: .

-
Input sentence: Smile.
Decoded sentence: .

-
Input sentence: Smile.
Decoded sentence: .

-
Input sentence: Attack!
Decoded sentence: !

-
Input sentence: Cheers!
Decoded sentence: !

-
Input sentence: Get up.
Decoded sentence: .

-
Input sentence: Go now.
Decoded sentence:  .

-
Input sentence: Go now.
Decoded sentence:  .

-
Input sentence: Go now.
Decoded sentence:  .

-
Input sentence: He ran.
Decoded sentence:  .

-
Input sentence: He ran.
Decoded sentence:  .

-
Input sentence: Hop in.
Decoded sentence:  !

-
Input sentence: Hop in.
Decoded sentence:  !

-
Input sentence: Hop in.
Decoded sentence:  !

-
Input sentence: Hop in.
Decoded sentence:  !

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: Hug me.
Decoded sentence:  .

-
Input sentence: I fell.
Decoded sentence: .

-
Input sentence: I knit.
Decoded sentence:  .

-
Input sentence: I know.
Decoded sentence:  .

-
Input sentence: I know.
Decoded sentence:  .

-
Input sentence: I lied.
Decoded sentence: .

-
Input sentence: I lost.
Decoded sentence: .

-
Input sentence: I paid.
Decoded sentence: .

-
Input sentence: I swim.
Decoded sentence:  .

-
Input sentence: I work.
Decoded sentence:  .

-
Input sentence: I work.
Decoded sentence:  .

-
Input sentence: I&#39;m OK.
Decoded sentence:  .

-
Input sentence: Listen.
Decoded sentence: .

-
Input sentence: Listen.
Decoded sentence: .

-
Input sentence: Listen.
Decoded sentence: .

-
Input sentence: Listen.
Decoded sentence: .

-
Input sentence: Listen.
Decoded sentence: .

-
Input sentence: No way!
Decoded sentence:  !

-
Input sentence: Really?
Decoded sentence: ?

-
Input sentence: Really?
Decoded sentence: ?

-
Input sentence: Thanks.
Decoded sentence: !

-
Input sentence: Thanks.
Decoded sentence: !

-
Input sentence: We try.
Decoded sentence:  .

-
Input sentence: We try.
Decoded sentence:  .

-
Input sentence: We won.
Decoded sentence: .

-
Input sentence: Why me?
Decoded sentence:  ?

-
Input sentence: Why me?
Decoded sentence:  ?

-
Input sentence: Awesome!
Decoded sentence: !

-
Input sentence: Awesome!
Decoded sentence: !

-
Input sentence: Awesome!
Decoded sentence: !

-
Input sentence: Be cool.
Decoded sentence:  .

-
Input sentence: Be cool.
Decoded sentence:  .

-
Input sentence: Be fair.
Decoded sentence:  .

-
Input sentence: Be kind.
Decoded sentence:  .

-
Input sentence: Be nice.
Decoded sentence:  .

-
Input sentence: Be nice.
Decoded sentence:  .

-
Input sentence: Be nice.
Decoded sentence:  .

-
Input sentence: Beat it.
Decoded sentence: !

-
Input sentence: Beat it.
Decoded sentence: !

-
Input sentence: Beat it.
Decoded sentence: !

-
Input sentence: Beat it.
Decoded sentence: !

-
Input sentence: Beat it.
Decoded sentence: !

-
Input sentence: Call me.
Decoded sentence:  .

-
Input sentence: Call us.
Decoded sentence:  .

-
Input sentence: Call us.
Decoded sentence:  .

-
Input sentence: Call us.
Decoded sentence:  .

-
Input sentence: Come in.
Decoded sentence: !

-
Input sentence: Come on!
Decoded sentence: !

-
Input sentence: Come on!
Decoded sentence: !

-
Input sentence: Come on!
Decoded sentence: !

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
</body>
</html>
